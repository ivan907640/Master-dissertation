Namespace(base_lr=0.03, batch_size=64, beta=0.5, confidence_threshold=0.9, consistency=1, consistency_rampup=30, datadir='./data/', dataset='SVHN', deterministic=1, dist_scale=10000.0, drop_rate=0.2, ema_consistency=1, ema_decay=0.999, from_labeled=True, gpu='0', input_sz=32, label_uncertainty='U-Ones', lambda_u=0.02, local_ep=1, log_file_name='SVHN_20_old', logdir='logs/', lr_step_size=5, max_grad_norm=5.0, meta_client_num=5, meta_round=6, model='simple-cnn', num_labeled=1, num_users=10, num_warmup_epochs=0, opt='sgd', out_dim=256, partition='noniid', pre_sz=40, resume=False, root_path='med_classify_dataset/skin', rounds=100, seed=1337, start_epoch=0, sup_scale=100.0, test=False, unsup_lr=0.021, unsup_num=19, w_mul_times=6)
attempt0
Data statistics: {0: {0: 31, 1: 1213, 2: 50, 3: 507, 4: 12, 5: 20, 6: 19, 7: 735, 8: 401, 9: 97}, 1: {0: 1, 1: 636, 2: 211, 3: 697, 4: 84, 5: 221, 6: 37, 7: 249, 8: 8, 9: 477}, 2: {0: 276, 1: 252, 2: 112, 3: 646, 4: 601, 5: 151, 6: 8, 7: 498, 8: 27, 9: 94}, 3: {0: 68, 1: 12, 2: 1945, 3: 293, 4: 12, 5: 351, 6: 35, 7: 570, 8: 237, 9: 3}, 4: {0: 68, 1: 720, 2: 425, 3: 1358, 4: 1416}, 5: {0: 428, 1: 297, 2: 2732, 3: 409}, 6: {0: 63, 1: 1237, 2: 1139, 3: 969, 4: 41, 5: 86, 6: 848}, 7: {1: 496, 2: 1485, 3: 1, 4: 44, 5: 4, 6: 202, 7: 2, 8: 576, 9: 470}, 8: {0: 125, 1: 2350, 2: 107, 3: 1, 4: 379, 5: 1074}, 9: {0: 78, 1: 48, 2: 49, 3: 11, 4: 517, 5: 95, 6: 397, 7: 242, 8: 2, 9: 238}, 10: {0: 774, 1: 570, 2: 27, 3: 787, 4: 11, 5: 748, 6: 20, 7: 605, 8: 85, 9: 57}, 11: {0: 51, 1: 1849, 2: 176, 3: 325, 5: 1105, 6: 17, 7: 565}, 12: {0: 29, 1: 8, 3: 31, 4: 464, 5: 834, 6: 48, 7: 12, 8: 1651, 9: 2673}, 13: {0: 1544, 1: 2195}, 14: {0: 186, 1: 16, 2: 101, 3: 206, 4: 658, 5: 242, 6: 39, 7: 13, 8: 82, 9: 540}, 15: {0: 538, 1: 8, 2: 1086, 3: 1351, 4: 1116}, 16: {0: 42, 1: 320, 2: 262, 3: 132, 4: 257, 5: 1378, 6: 513, 7: 979}, 17: {0: 49, 1: 1070, 2: 65, 3: 234, 4: 1484, 6: 2656}, 18: {0: 170, 1: 548, 2: 319, 3: 537, 4: 78, 5: 395, 6: 109, 7: 10, 8: 122, 9: 10}, 19: {0: 427, 1: 16, 2: 294, 3: 2, 4: 284, 5: 178, 6: 779, 7: 1115, 8: 1854}}
Comm round 0 meta round 0 chosen client: [19, 17, 11, 5, 10]
EMA model initialized
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 3.420221703028148e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 284 by model during train, total 4949
EMA model initialized
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 3.4475550683577887e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1484 by model during train, total 5558
EMA model initialized
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.443345629960959e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 4088
EMA model initialized
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 3.416133968577745e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 3866
EMA model initialized
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 3.4243413006936017e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 3684
Comm round 0 meta round 1 chosen client: [12, 11, 9, 19, 6]
EMA model initialized
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.4408701645184516e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 464 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.4464125171496107e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 4088
EMA model initialized
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.3452422064362543e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 517 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 3.4295244739578034e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 284 by model during train, total 4949
EMA model initialized
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.425141377864866e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 4383
Comm round 0 meta round 2 chosen client: [11, 3, 13, 12, 2]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.456511517896388e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 4088
EMA model initialized
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 3.3902787675645285e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
EMA model initialized
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 3.423163694621461e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.4487180401912256e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 464 by model during train, total 5750
EMA model initialized
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 3.421994322360704e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 601 by model during train, total 2665
Comm round 0 meta round 3 chosen client: [16, 11, 12, 17, 9]
EMA model initialized
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 3.4291603965431904e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 257 by model during train, total 3883
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.4535868458362984e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 4088
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.4567682076966673e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 464 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 3.45938582248128e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1484 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.3405220299890196e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 517 by model during train, total 1677
Comm round 0 meta round 4 chosen client: [0, 11, 3, 14, 7]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.74322353333843 lr : 0.03
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.45669664980619e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 4088
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 3.3950044396086857e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
EMA model initialized
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 3.4069979171886877e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 658 by model during train, total 2083
EMA model initialized
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 3.400996980382423e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 44 by model during train, total 3280
Comm round 0 meta round 5 chosen client: [5, 10, 14, 8, 6]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 3.4184654936563943e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 3.432414465696011e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 3.4031701743791047e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 658 by model during train, total 2083
EMA model initialized
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 3.402958422382696e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 379 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.4346766438909033e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 4383
************ Loss Avg 0.05811076011992243, LR 0.03, Round 0 ends ************  

TEST Student: Epoch: 0

TEST AUROC: 0.492956, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 1 meta round 0 chosen client: [17, 2, 16, 1, 18]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 3.047392063350323e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 403 by model during train, total 5558
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 1.8705945040307726e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 510 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 1.8411312941575713e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 883 by model during train, total 3883
EMA model initialized
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.407273493832113e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
EMA model initialized
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 7.396681919797427e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 1 meta round 1 chosen client: [13, 1, 0, 6, 16]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 1.8445457643700415e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 15 by model during train, total 3739
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.421766917459758e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6870011285859712 lr : 0.03
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.064155779993862e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 5.537872241012471e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 372 by model during train, total 3883
Comm round 1 meta round 2 chosen client: [3, 9, 6, 14, 10]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 3.075262150835962e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 411 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.14179324387051e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 322 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 5.332033116457645e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 27 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 3.1359320721755715e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 202 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 3.0831891535854083e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 437 by model during train, total 3684
Comm round 1 meta round 3 chosen client: [0, 10, 13, 7, 1]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.703840649857813 lr : 0.03
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 5.329115083441138e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 606 by model during train, total 3684
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 5.503938035548406e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2053 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 1.8506878411436937e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 14 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.430175617450803e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 1 meta round 4 chosen client: [17, 9, 6, 5, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 5.3655086184722025e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 5.316776040402786e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 237 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.6629375363586205e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1090 by model during train, total 4383
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 3.073540455872836e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 0 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 1.4548217222909443e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 1 meta round 5 chosen client: [1, 15, 14, 0, 18]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.429787436238967e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
EMA model initialized
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 7.307165622198507e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 5.347307740411259e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6901382159213632 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 7.410366439823217e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.16939480841628282, LR 0.03, Round 1 ends ************  

TEST Student: Epoch: 1

TEST AUROC: 0.507695, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 2 meta round 0 chosen client: [17, 11, 19, 8, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00031061494811946506, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1029 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0006721413546983968, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 466 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0004385728114310694, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 585 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00025619134998988713, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1749 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0001952837483258918, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 2 meta round 1 chosen client: [2, 4, 1, 5, 10]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0002115842878646661, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 256 by model during train, total 2665
EMA model initialized
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005509582057591557, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.000103577908991677, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0003566357404228346, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 220 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003159016528586327, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 566 by model during train, total 3684
Comm round 2 meta round 2 chosen client: [2, 6, 14, 8, 1]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 1.1250539958360778e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00028901208376434323, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0003214284043871995, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 1.6929095835394037e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 1.335485981088845e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 2 meta round 3 chosen client: [17, 4, 13, 11, 1]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 9.394525983518032e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005696488111021204, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0001983272576565515, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00033131438044620154, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1436 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 5.575789362232971e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 2 meta round 4 chosen client: [13, 9, 4, 1, 14]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 2.6679594355501047e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0003207709884952271, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005773913687176352, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 2.576897955672083e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 9.597255462501903e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 2 meta round 5 chosen client: [11, 12, 2, 6, 19]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00015332414875501854, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0005446489450858078, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 67 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 2.2345391547181254e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00010656764572849025, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 5.7876493659209817e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
************ Loss Avg 0.00023978648670486535, LR 0.03, Round 2 ends ************  

TEST Student: Epoch: 2

TEST AUROC: 0.507570, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 3 meta round 0 chosen client: [19, 8, 6, 17, 4]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 5.7950719302915295e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 9.468643033017088e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 2.534916040821227e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 1.5306327072564804e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006046834667878491, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 3 meta round 1 chosen client: [15, 12, 13, 8, 5]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 3.5953856539750774e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00014624997016249433, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 5.9549702778525186e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00016502718916910908, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 7.017376223392021e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Comm round 3 meta round 2 chosen client: [7, 10, 12, 6, 13]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00019704957533296972, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 488 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 8.516652592490949e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 2.9383036053332035e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.857405660539001e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 2.9789771037092394e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 3 meta round 3 chosen client: [5, 15, 10, 1, 0]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 7.221402629362334e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 9.667123080222294e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 1.599221975970193e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.315338831017271e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6222442047936576 lr : 0.03
Comm round 3 meta round 4 chosen client: [17, 6, 13, 9, 10]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 3.1333806651443526e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 5.2311163406135375e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 6.335636159854988e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 8.626615027862028e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.9522633753756586e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 3 meta round 5 chosen client: [12, 11, 7, 9, 14]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.851854209339459e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 5.428085876246769e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 1.024532816219247e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 1.5879802447216207e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.4912310303550454e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
************ Loss Avg 0.054140059299340765, LR 0.03, Round 3 ends ************  

TEST Student: Epoch: 3

TEST AUROC: 0.509420, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 4 meta round 0 chosen client: [18, 12, 19, 4, 8]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 9.550051000436117e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 2.9043982433702493e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 8.374406671662608e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00046042363863394017, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00013750160982795023, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 4 meta round 1 chosen client: [7, 12, 2, 14, 0]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 6.1181716349577846e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 1.195936094973149e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 3.333696111526695e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 9.630307502131032e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6100463477932676 lr : 0.03
Comm round 4 meta round 2 chosen client: [10, 2, 8, 15, 12]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.190181419337023e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 7.816368166199286e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0001896954573368248, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00012182181740522188, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.233465732692922e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 4 meta round 3 chosen client: [4, 1, 16, 12, 6]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004895474770501818, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 4.158545890255127e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 8.180617173746244e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 5.690585611672658e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 2.278832300652394e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 4 meta round 4 chosen client: [14, 3, 7, 9, 1]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 2.9550600918975594e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00044845971254809617, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 179 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 3.844974137861685e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 1.0269824653303456e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.941309437956434e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 4 meta round 5 chosen client: [15, 6, 11, 10, 8]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00020051173381104422, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 1.044441761104795e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 5.025735961794453e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 1.0615890605079365e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00023248994565960857, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
************ Loss Avg 0.053766076450982164, LR 0.03, Round 4 ends ************  

TEST Student: Epoch: 4

TEST AUROC: 0.511219, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 5 meta round 0 chosen client: [18, 3, 4, 16, 1]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 8.678859618132467e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00017232866809178762, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0003688546286347056, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 4.3109972690128085e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 4.066883327429489e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 5 meta round 1 chosen client: [17, 15, 9, 0, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 1.293276085661269e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0001652542999951178, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 9.314020526626674e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.604859901934254 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00040892976389769167, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 5 meta round 2 chosen client: [4, 14, 2, 15, 18]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00044070629450115596, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 2.429019759526427e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 5.949135465059607e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0002235332488803229, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 3.872643378599605e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 5 meta round 3 chosen client: [0, 5, 6, 18, 7]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6090394404469703 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 1.9582560540942215e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.9157466464556805e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00010034933378240869, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 3.532707044611855e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 5 meta round 4 chosen client: [7, 1, 14, 17, 12]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 7.572434857977966e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.510590520054216e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.0730749650203066e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 2.5665063292073116e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.323276254781781e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 5 meta round 5 chosen client: [9, 10, 0, 13, 11]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 2.717646078020119e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 5.319613713819026e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.608122132262405 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 1.2136646900972218e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 5.173328966634472e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
************ Loss Avg 0.1608144958327625, LR 0.03, Round 5 ends ************  

TEST Student: Epoch: 5

TEST AUROC: 0.519112, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 6 meta round 0 chosen client: [3, 5, 2, 0, 9]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0001678448481275804, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 6.227404949148892e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 4.105377640717918e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5966249485405124 lr : 0.03
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 2.7944035705500197e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 6 meta round 1 chosen client: [6, 5, 19, 3, 2]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 2.788337520621059e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 1.1738335805152108e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 3.2970436545080396e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 3.6262526259227866e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 2.1855221932907754e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 6 meta round 2 chosen client: [5, 17, 12, 7, 1]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 2.3554839357843106e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 3.141781990993407e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.3754974538169337e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 7.496202919390691e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 1.7234982038178535e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 6 meta round 3 chosen client: [13, 7, 19, 10, 14]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 8.883110030726546e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 2.9213751636584326e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 3.542126421507419e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.1623224115344406e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.3639865914449205e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 6 meta round 4 chosen client: [15, 6, 2, 17, 16]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 6.853376683536156e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 8.138987590941921e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 4.827643447026189e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 6.858627410440084e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 9.414441133305415e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 6 meta round 5 chosen client: [4, 11, 8, 12, 0]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00017503281035007804, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00015021921615243627, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 2.236589385518073e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 4.820177366582357e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.59023295616617 lr : 0.03
************ Loss Avg 0.10626508146064341, LR 0.03, Round 6 ends ************  

TEST Student: Epoch: 6

TEST AUROC: 0.523583, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 7 meta round 0 chosen client: [0, 7, 1, 3, 12]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.6017162580879367 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 2.7454605217896573e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 1.4681917624640357e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 1.366696397856312e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 4.6502372116366236e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 7 meta round 1 chosen client: [8, 16, 17, 9, 4]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 2.399364980121277e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 5.0592047120487416e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 5.980814744257311e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 2.0555014943797517e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00015318048896179314, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 7 meta round 2 chosen client: [0, 13, 9, 15, 11]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5899039871838627 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 5.2539954350261e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.615055769993584e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 6.99602533761488e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.000121643338445665, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 7 meta round 3 chosen client: [1, 10, 0, 19, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.658894590589448e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 1.784371835160057e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5946355376924788 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 3.2032765197515964e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 4.1395306262919416e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 7 meta round 4 chosen client: [1, 11, 13, 17, 12]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 1.7253571258617916e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 6.147220179286705e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 2.602047606684456e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 2.524080509149711e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 1.7157050691215167e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 7 meta round 5 chosen client: [15, 5, 0, 19, 18]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00011069450303274117, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 2.9328344647287628e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.58926657997832 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 1.5049880205016309e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 6.931742379694899e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.21254433655690114, LR 0.03, Round 7 ends ************  

TEST Student: Epoch: 7

TEST AUROC: 0.533650, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 8 meta round 0 chosen client: [6, 2, 13, 19, 18]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 3.934030204275758e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 2.4554836142799885e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 1.6906258783280264e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 9.6736341412487e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 9.427103318810421e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 8 meta round 1 chosen client: [17, 16, 5, 13, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 2.2800098582362923e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 3.889433364598577e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 2.314951966134865e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 6.337890849246864e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 1.672977612088289e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 8 meta round 2 chosen client: [19, 2, 7, 16, 5]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 2.706863379222714e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 4.644592661948298e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 3.7158966436506417e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 8.119800097052784e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 8.186778728247833e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Comm round 8 meta round 3 chosen client: [13, 0, 19, 16, 9]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 1.8073483523162933e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.585211184560036 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 4.9370026504337336e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 2.3025812316652758e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 7.6009260975819485e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 8 meta round 4 chosen client: [3, 10, 9, 1, 15]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 9.157597097139306e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.4224032397890777e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 1.5511324115188337e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 5.392463424691303e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 8.069501918026408e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 8 meta round 5 chosen client: [11, 10, 0, 19, 18]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 7.108052432158729e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 6.714769652121347e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5868718599786564 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 7.475391239262163e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 3.758639341968875e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.10575832569899951, LR 0.03, Round 8 ends ************  

TEST Student: Epoch: 8

TEST AUROC: 0.540235, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 9 meta round 0 chosen client: [6, 3, 17, 0, 1]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 1.4398323582350134e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 7.511881345781798e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 1.032655461455144e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5806544897507648 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 1.7729002116184126e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 9 meta round 1 chosen client: [12, 16, 19, 1, 17]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 1.3247803786321634e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 1.317499275456448e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0001102260766623285, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 2.9733133177193474e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 2.547921990455883e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 9 meta round 2 chosen client: [0, 1, 13, 14, 2]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5823480912617274 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 4.363310370358593e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 3.8413081371908126e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 4.249020876710402e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 7.632097566827378e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 9 meta round 3 chosen client: [10, 16, 14, 18, 6]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 3.282154607561473e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 2.8603177449186943e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.4163684296143016e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 8.060710145703827e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 4.2768725849611284e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 9 meta round 4 chosen client: [2, 14, 11, 17, 1]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00010117995355228362, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 3.702906786367583e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 3.3716063171596033e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 4.761950499257715e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 5.87507620810179e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 9 meta round 5 chosen client: [4, 19, 3, 7, 13]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00011738276912688484, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00014074036833988383, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 2.147001250055577e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 6.675800474253125e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 5.6885687919961035e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
************ Loss Avg 0.10547414681311854, LR 0.03, Round 9 ends ************  

TEST Student: Epoch: 9

TEST AUROC: 0.545336, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 10 meta round 0 chosen client: [5, 4, 6, 8, 12]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 1.6290675852897188e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00012875024191406925, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 1.8249524726053241e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 1.0897724605385406e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 2.0485731399983504e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 10 meta round 1 chosen client: [15, 10, 2, 11, 6]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0001015376002144946, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.5799897175288765e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00010335737914872533, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 2.018392483904563e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 5.315452031224951e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 10 meta round 2 chosen client: [5, 15, 8, 2, 17]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 3.2492067893159756e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0001349583217793574, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 2.9468548522260107e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.000128057600314995, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 5.836321080963919e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 10 meta round 3 chosen client: [15, 8, 4, 3, 6]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00016768587965298838, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 5.237552838366355e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00016146114828029929, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 3.064457342004191e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 1.5277136378205363e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 10 meta round 4 chosen client: [4, 5, 19, 1, 0]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00019295632562947473, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 5.1699992805789986e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00014726852593109166, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 5.728206229921453e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5835964679718018 lr : 0.03
Comm round 10 meta round 5 chosen client: [1, 7, 11, 3, 9]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.283081646253378e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 7.262823811078515e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 6.810280785529699e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 5.498151406462577e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.2039531350636495e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
************ Loss Avg 0.05284927124562188, LR 0.03, Round 10 ends ************  

TEST Student: Epoch: 10

TEST AUROC: 0.547426, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 11 meta round 0 chosen client: [6, 2, 16, 13, 12]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 2.675038861828701e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0001428365659584025, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 3.0323290912583317e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 5.369482968782935e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 3.8276527306556496e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 11 meta round 1 chosen client: [12, 2, 6, 5, 11]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 6.464200398315572e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00016635389415785626, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 4.517341672592169e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 6.654295799814806e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 2.828752357686426e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 11 meta round 2 chosen client: [6, 16, 1, 7, 3]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 6.716075027277154e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 4.958066031084869e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 8.166680380804237e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 9.064472410850263e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 7.520022399733404e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 11 meta round 3 chosen client: [9, 17, 10, 19, 18]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 8.647257909952142e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 8.200502784818346e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 6.494935268290584e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0001719938671344724, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 9.072730568328148e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 11 meta round 4 chosen client: [9, 1, 8, 13, 10]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 1.9459057848844504e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 9.784931206945103e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 7.153777973911701e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 7.403365896730604e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 1.55006031930278e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 11 meta round 5 chosen client: [10, 2, 17, 8, 16]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 2.8181240034835605e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00018918753959864954, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00011468275031007976, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 9.736138459004451e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 7.035215786032257e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
************ Loss Avg 7.132298894199284e-05, LR 0.03, Round 11 ends ************  

TEST Student: Epoch: 11

TEST AUROC: 0.545906, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 12 meta round 0 chosen client: [1, 10, 19, 4, 13]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 9.637960802803452e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 3.527834673902895e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00018417067067042435, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00018758373161766766, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 8.068083726526712e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 12 meta round 1 chosen client: [15, 19, 10, 5, 12]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00016661580159332235, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00022159756106423, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 5.2473899656966936e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 7.480658958408387e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 8.263823029766273e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 12 meta round 2 chosen client: [16, 0, 14, 2, 6]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 7.858953725443543e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5736525666957 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 4.485862911513488e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00018506622083285556, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 7.789851003073399e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 12 meta round 3 chosen client: [17, 12, 9, 6, 15]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00013207296450119251, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00011697348769909391, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 2.5443040175121968e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00010475371311548625, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00019813628378660025, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 12 meta round 4 chosen client: [19, 13, 14, 4, 12]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0002595690959237683, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00010419757610040922, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 3.6223219798226967e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0002185657849911386, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00015454929994626178, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 12 meta round 5 chosen client: [12, 19, 5, 2, 8]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00019502686271961366, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0002985675372399736, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 9.832304424547102e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.000208123750954179, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00010643520982256405, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
************ Loss Avg 0.052580173069214906, LR 0.03, Round 12 ends ************  

TEST Student: Epoch: 12

TEST AUROC: 0.544779, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 13 meta round 0 chosen client: [10, 4, 8, 17, 16]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 4.022626383410734e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00017332068599653356, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 8.392960059211418e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00011477827393227718, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 6.137232991082396e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 13 meta round 1 chosen client: [3, 19, 5, 4, 11]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 5.1495586538814155e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0002498014654497055, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 7.681354369107466e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00020592699637211534, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 1.6078290052234934e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 13 meta round 2 chosen client: [13, 4, 16, 3, 18]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 7.947178127617038e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00023878975815254277, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 8.372934402747187e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 7.418435136839565e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 6.566785325250951e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 13 meta round 3 chosen client: [16, 12, 11, 13, 0]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00010827598309900123, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00016917287931492967, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 1.06553491576733e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00010351986202294938, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5777514808031978 lr : 0.03
Comm round 13 meta round 4 chosen client: [9, 2, 12, 17, 14]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 1.991890394492657e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00015532056325658536, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00021455492614121693, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00015359529504490932, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 8.444666381172173e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 13 meta round 5 chosen client: [0, 3, 1, 7, 4]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.581647734252774 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 9.804213493680436e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.70216292591493e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 5.8407285870578984e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0002728407665032021, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
************ Loss Avg 0.10541515238084506, LR 0.03, Round 13 ends ************  

TEST Student: Epoch: 13

TEST AUROC: 0.552491, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 14 meta round 0 chosen client: [7, 2, 0, 1, 16]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 6.501358666355372e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0001524051658634562, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5711738625351264 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 6.775575829811803e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00011434493806846746, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 14 meta round 1 chosen client: [18, 16, 0, 10, 4]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 8.172232264769264e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00014092542658575245, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5779022756887942 lr : 0.03
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 4.5543986116485785e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00027228435519934885, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 14 meta round 2 chosen client: [19, 10, 7, 9, 16]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00026014313092067215, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 6.274913777878252e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 8.385019625096062e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 2.3410891538299404e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0001690553606928662, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 14 meta round 3 chosen client: [10, 9, 12, 19, 5]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 8.249396768374497e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.355719369816749e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00023040486477030856, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00030057234480642737, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 8.380971002090936e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Comm round 14 meta round 4 chosen client: [1, 17, 12, 3, 13]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 8.205133497362911e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00016813388732583103, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0002763633606567358, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00010354650135013799, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00010632310745600311, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 14 meta round 5 chosen client: [13, 12, 7, 14, 2]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00013077713367114853, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0003242152615308037, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00010385298736974409, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 8.961100706294404e-06, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0001720784920118084, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
************ Loss Avg 0.10509408279095253, LR 0.03, Round 14 ends ************  

TEST Student: Epoch: 14

TEST AUROC: 0.553552, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 15 meta round 0 chosen client: [7, 0, 16, 5, 12]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 9.711035741369975e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5622689577997948 lr : 0.03
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00015714926514908152, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 8.447040031047645e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0003078077355490273, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 15 meta round 1 chosen client: [8, 18, 10, 19, 14]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 6.900554792110825e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 8.644903411752441e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 8.00884107743984e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00027811665859189816, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.8095700563042722e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 15 meta round 2 chosen client: [5, 2, 0, 8, 10]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00010433326935496747, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00015072849713587423, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.592622968615318 lr : 0.03
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 8.725907560602764e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00010047330021013201, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 15 meta round 3 chosen client: [14, 0, 9, 7, 15]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 1.9556679173106342e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.5592491748381634 lr : 0.03
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 3.692745074793628e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0001161196402720704, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00010764154779350905, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 15 meta round 4 chosen client: [12, 3, 11, 1, 0]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00035481401331101853, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00010027506048767723, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 2.3901853396068873e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 7.461037337013362e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.54458195336011 lr : 0.03
Comm round 15 meta round 5 chosen client: [7, 16, 8, 14, 9]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00013649830655664957, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0001849110942471345, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00010739442843288316, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 2.449116061942539e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 4.666219582658313e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
************ Loss Avg 0.20872259818901057, LR 0.03, Round 15 ends ************  

TEST Student: Epoch: 15

TEST AUROC: 0.592703, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 16 meta round 0 chosen client: [14, 5, 16, 0, 10]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0002598514499065156, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0004835457101628398, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006602566735055603, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.509514645654328 lr : 0.03
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004732589644343785, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 16 meta round 1 chosen client: [14, 12, 17, 1, 7]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0002696980981537226, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0009677290069198029, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005234716411267847, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00040632983592974885, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005646330849301124, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 16 meta round 2 chosen client: [15, 17, 5, 19, 8]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00048534270877448413, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005442423313781191, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0004959321536932935, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008281389996110916, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00045930095424751016, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 16 meta round 3 chosen client: [9, 18, 5, 15, 19]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0003369132747239847, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00046769971878448915, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0005256243736662551, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0004958008193520632, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008346737050511038, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 16 meta round 4 chosen client: [12, 17, 14, 16, 13]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0009696233357923726, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005816711255365276, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00029115686254843956, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006630187315034268, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00044098187073220705, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 16 meta round 5 chosen client: [13, 1, 4, 10, 3]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00045109698913944093, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.000411021150506624, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006992894052509366, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00048457773614088716, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0004759901155141831, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
************ Loss Avg 0.050835517216044825, LR 0.03, Round 16 ends ************  

TEST Student: Epoch: 16

TEST AUROC: 0.603431, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 17 meta round 0 chosen client: [19, 12, 10, 3, 7]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0006375371783341949, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0007555320865422901, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00034772396536246903, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00033742348793046925, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004016797218075506, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 17 meta round 1 chosen client: [7, 11, 8, 5, 14]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004300039520155853, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 7.632693893810938e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00030042984060685285, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00038486391737232686, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00019553428402022374, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 17 meta round 2 chosen client: [7, 10, 3, 15, 9]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004563642953423998, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003765768656037459, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00037015465756797184, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0003625330926717232, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00022120378101438595, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 17 meta round 3 chosen client: [2, 1, 17, 3, 6]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0004009281571294802, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00027641027891815343, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0004323766993000119, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0003970181314473718, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0001810677965387594, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 17 meta round 4 chosen client: [7, 6, 16, 13, 17]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004775797804960838, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00020572932270875174, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0004949202552556106, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002979904488942554, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00047468759277407294, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 17 meta round 5 chosen client: [3, 1, 0, 4, 7]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00042495410116316634, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00029847560884862595, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.4710310794869248 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004860803092014976, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005077281288182489, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
************ Loss Avg 0.04940136380545164, LR 0.03, Round 17 ends ************  

TEST Student: Epoch: 17

TEST AUROC: 0.606833, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 18 meta round 0 chosen client: [18, 0, 11, 15, 1]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0002504591898792165, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.453042205499143 lr : 0.03
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 9.321381730842404e-05, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0003052099226316876, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00024323323251759042, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 18 meta round 1 chosen client: [6, 2, 16, 10, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00018580670165238848, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00031526301435882314, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0004196352507636623, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003126700278793076, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00040231366703722863, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 18 meta round 2 chosen client: [10, 17, 18, 8, 19]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003375970652619987, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00040040811290964484, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0002839632939463223, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0002497172121991298, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005413398838031869, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 18 meta round 3 chosen client: [17, 14, 8, 3, 18]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0004415009690959799, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00016374660393039724, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0002749534971542289, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0003631318077818183, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0003105049399891868, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 18 meta round 4 chosen client: [9, 3, 1, 17, 6]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00018331728595647427, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00039113801130952197, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00026287906945160613, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0004691440530453177, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00021397404023024347, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 18 meta round 5 chosen client: [8, 19, 2, 4, 7]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00029270574249551373, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005858657535170026, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0003410219232180333, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00042880142704927407, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004210461468644028, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
************ Loss Avg 0.04875089223874603, LR 0.03, Round 18 ends ************  

TEST Student: Epoch: 18

TEST AUROC: 0.610466, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 19 meta round 0 chosen client: [4, 5, 3, 16, 19]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00035438194073134267, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0002701123735054442, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0003335033067872116, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.000363041846211389, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0004726120177320599, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 19 meta round 1 chosen client: [11, 8, 2, 5, 18]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00016139227523126465, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00026687304769978937, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00028311031478335194, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0002969106915502305, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0002795645199916584, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 19 meta round 2 chosen client: [16, 13, 8, 18, 0]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0003903507415804493, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00021646688031269458, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0002818763453547035, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00030197112856613885, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.580473474093846 lr : 0.03
Comm round 19 meta round 3 chosen client: [13, 6, 8, 15, 9]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002279855501818297, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00021834646537646896, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0002981318101973329, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0002719343545322772, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00016831740328968777, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 19 meta round 4 chosen client: [8, 12, 3, 16, 19]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0003099518298483872, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0005037539562585556, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0003584868668440322, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00041613813282608924, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005066323827076047, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 19 meta round 5 chosen client: [5, 10, 16, 17, 18]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00032173700775706864, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0002904297213937188, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00043791069145329665, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0003915451503500621, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0003253953578273973, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.05299307794015758, LR 0.03, Round 19 ends ************  

TEST Student: Epoch: 19

TEST AUROC: 0.610329, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 20 meta round 0 chosen client: [15, 14, 4, 13, 8]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00036010895264553254, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00016285037792950982, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00047643807700960825, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002619531987258628, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004127626090735248, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 20 meta round 1 chosen client: [14, 18, 4, 16, 9]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00017942589042694166, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0004001232874644403, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005093448686123353, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005801725387382398, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0002044726685131469, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 20 meta round 2 chosen client: [11, 1, 10, 15, 2]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00011409816613650037, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00026327741357906744, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003800177482530828, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0003955288037104765, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0003610901438237523, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 20 meta round 3 chosen client: [8, 17, 4, 9, 16]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004446103463067175, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005500977420670933, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005497831410297843, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00022115015532041003, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006177220336108117, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 20 meta round 4 chosen client: [5, 8, 12, 19, 10]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00041906454098949086, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004901969759316671, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.000720645018413456, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0007077322547840408, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004137237576350313, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 20 meta round 5 chosen client: [7, 11, 10, 0, 18]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00042790097708907875, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00013240710143236356, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004528455979668471, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.415239185703044 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00042897622430852306, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.047562590210485714, LR 0.03, Round 20 ends ************  

TEST Student: Epoch: 20

TEST AUROC: 0.615839, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 21 meta round 0 chosen client: [14, 7, 16, 10, 15]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00014323063034239704, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0003431960437340492, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0004498176658373387, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00032452224394515286, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00029401601153110205, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 21 meta round 1 chosen client: [18, 13, 7, 4, 17]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0003179948697733279, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002166312402489169, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0003732679727433536, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0003923804053181176, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0003943652628476721, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 21 meta round 2 chosen client: [11, 8, 6, 4, 9]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00018622409834279097, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0003313494890733182, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00021980922558240295, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00043022761117696525, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0001712609803319167, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 21 meta round 3 chosen client: [17, 15, 12, 1, 8]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0004438637257700829, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00033212185384959763, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0005381303299347767, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00022622146579811758, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00035803989527494195, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 21 meta round 4 chosen client: [9, 10, 0, 5, 18]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00018295441656880062, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00036252260906621814, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.40271414785969 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00031843362042115485, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00034779238113616075, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 21 meta round 5 chosen client: [3, 10, 1, 4, 2]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0003291223002374214, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00039488755483662, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00024257466358859546, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004676436382440096, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00026419625161603716, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
************ Loss Avg 0.04707036487722872, LR 0.03, Round 21 ends ************  

TEST Student: Epoch: 21

TEST AUROC: 0.617687, TEST Accus: 0.195874, TEST Pre: 0.019587, TEST Recall: 0.100000
Comm round 22 meta round 0 chosen client: [16, 6, 15, 18, 11]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005067084819559374, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0003104660600133618, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00038710382878329814, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00041146000714636303, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00029770213996016537, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 22 meta round 1 chosen client: [13, 5, 7, 6, 17]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002836399935866643, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00038991232505678885, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0004444461132012433, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00032175610439204, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.000480463227187551, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 22 meta round 2 chosen client: [0, 18, 17, 11, 5]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.366134290792504 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00042513383717353764, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005162942217229383, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0002915013192250626, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00042110210230677066, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Comm round 22 meta round 3 chosen client: [18, 15, 10, 3, 9]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0004468517250239125, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0004121818464857195, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.000426914632232089, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00039887065778592453, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0002318371978752246, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 22 meta round 4 chosen client: [3, 18, 9, 12, 1]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00043121819713373303, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0004554526409871566, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00025458468156069067, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0005786309953287451, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0003260498271584965, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 22 meta round 5 chosen client: [14, 8, 15, 13, 10]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00020363141194331658, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0003951222057736459, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00044407043119113393, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00027748971035056826, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004526970630555799, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
************ Loss Avg 0.04591191945927007, LR 0.03, Round 22 ends ************  

TEST Student: Epoch: 22

TEST AUROC: 0.618060, TEST Accus: 0.195951, TEST Pre: 0.023332, TEST Recall: 0.100099
Comm round 23 meta round 0 chosen client: [9, 7, 4, 15, 19]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00030904730482251143, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.000490282034451621, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004896830401516386, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0004497119737117408, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0004769567079701795, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 23 meta round 1 chosen client: [19, 13, 16, 0, 14]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005201946621990572, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00037164307989661537, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.000511223538568793, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.3298772695113201 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0002756007245008015, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 23 meta round 2 chosen client: [10, 13, 12, 11, 15]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004488945620511819, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003553441970094139, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0005760972071180327, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0004335367984822369, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0004791633790983514, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 23 meta round 3 chosen client: [2, 15, 8, 3, 18]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00038446364938170605, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0005000309451973477, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004273590078014422, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00045454505620260273, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.000472210723576912, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 23 meta round 4 chosen client: [10, 16, 11, 1, 7]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004753939712576664, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005441680078234402, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00041463381194262183, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0004061727547484291, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005047003917122941, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 23 meta round 5 chosen client: [14, 13, 3, 16, 17]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00028551284975202924, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00033199580317714363, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0004858558059562971, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005653914115219911, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.000509945471167575, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
************ Loss Avg 0.04476090094608573, LR 0.03, Round 23 ends ************  

TEST Student: Epoch: 23

TEST AUROC: 0.619896, TEST Accus: 0.196297, TEST Pre: 0.022278, TEST Recall: 0.100575
Comm round 24 meta round 0 chosen client: [2, 3, 6, 15, 12]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0004658878474618264, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0005258602694604113, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0005164371834615704, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0005315559632156062, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.000614093851375704, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 24 meta round 1 chosen client: [14, 10, 7, 18, 9]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.000386176054069603, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004938426420016311, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.000573397442237295, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0005483924663470437, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00039182157154384723, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 24 meta round 2 chosen client: [17, 2, 10, 15, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.000532093839238173, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0004715275613956952, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0005179375072876955, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0005443240770966021, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0006033032018771897, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 24 meta round 3 chosen client: [19, 0, 18, 4, 3]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005585680602309414, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.3094924955951923 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0005662346447934397, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005423922089643643, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0005608653798065331, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 24 meta round 4 chosen client: [11, 6, 8, 16, 19]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0005280152804516547, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0005031811987451426, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004696285179761617, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005962204772093501, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.000578519082549834, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 24 meta round 5 chosen client: [8, 16, 12, 4, 5]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004646146891928993, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.000610574169349704, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.000648448959853138, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.000543885313885449, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0005152913279923015, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
************ Loss Avg 0.04416318621280877, LR 0.03, Round 24 ends ************  

TEST Student: Epoch: 24

TEST AUROC: 0.617751, TEST Accus: 0.196412, TEST Pre: 0.022535, TEST Recall: 0.100753
Comm round 25 meta round 0 chosen client: [8, 0, 7, 13, 9]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004461815061382879, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2829778863459218 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005736484014890336, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000527385049312123, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0005064959690638783, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 25 meta round 1 chosen client: [0, 2, 15, 13, 7]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.301574638911656 lr : 0.03
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.000541854050381863, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0004914831508918164, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004580985432613041, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.000565152003568633, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 25 meta round 2 chosen client: [11, 17, 18, 13, 10]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0005973806273686932, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00046718710914371944, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 10 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0005767949729084244, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004164074301932765, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004795657670033036, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 25 meta round 3 chosen client: [7, 17, 10, 6, 2]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005795190714147444, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0004936340512525847, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 31 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004824451451864222, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00054045714120772, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0005347047245734194, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 25 meta round 4 chosen client: [5, 7, 10, 3, 16]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.000511491990631034, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005719779020672342, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004929550223409776, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0005103192544473652, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005598047797827692, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 25 meta round 5 chosen client: [13, 2, 4, 5, 10]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003745953016717113, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0005222611403691449, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005105782913724108, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.000518125973090331, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004990846337650196, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 4 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
************ Loss Avg 0.08663007047538249, LR 0.03, Round 25 ends ************  

TEST Student: Epoch: 25

TEST AUROC: 0.627197, TEST Accus: 0.207667, TEST Pre: 0.039855, TEST Recall: 0.115364
Comm round 26 meta round 0 chosen client: [1, 6, 7, 13, 18]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011040977438025903, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0010178314827288082, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0011899266848139143, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005896185518348969, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0011536739184521139, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 26 meta round 1 chosen client: [12, 3, 7, 17, 16]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001022158753928832, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0011268983303775063, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0011507813024554008, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0008854382536266984, unsupervised loss ratio: 1.0, lr 0.021, 60 pseu out of 69 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0011224411189418714, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 26 meta round 2 chosen client: [19, 10, 11, 9, 7]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.000984307930570466, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0009568914759037053, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 24 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0010140244166905177, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0008692600666243514, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0011333274490495499, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 26 meta round 3 chosen client: [15, 10, 2, 1, 17]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0010065377019390536, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0009466812635796016, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 33 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0010088566701770539, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0010814782212170341, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0008754882494512217, unsupervised loss ratio: 1.0, lr 0.021, 127 pseu out of 165 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 26 meta round 4 chosen client: [13, 14, 2, 0, 3]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005259470379283904, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008521953564151331, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0009736342236421825, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2887559983195092 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0010878987412589985, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 26 meta round 5 chosen client: [17, 11, 5, 14, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0008712969563136027, unsupervised loss ratio: 1.0, lr 0.021, 202 pseu out of 288 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0009391329349455191, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0010716528574493333, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.000864339768392683, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0010468979164782422, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 4 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
************ Loss Avg 0.043907623789949946, LR 0.03, Round 26 ends ************  

TEST Student: Epoch: 26

TEST AUROC: 0.620516, TEST Accus: 0.202558, TEST Pre: 0.035606, TEST Recall: 0.108416
Comm round 27 meta round 0 chosen client: [13, 8, 0, 17, 6]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005321653773889766, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0007649326819461066, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2795667976749188 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006533809656534215, unsupervised loss ratio: 1.0, lr 0.021, 313 pseu out of 450 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0009283427548918711, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 27 meta round 1 chosen client: [10, 7, 19, 0, 15]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0007362058647137521, unsupervised loss ratio: 1.0, lr 0.021, 39 pseu out of 58 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008854606024285133, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 7 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008193104300656929, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.29017892905644 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0007880923489350468, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 27 meta round 2 chosen client: [4, 7, 8, 2, 19]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0008595421843762909, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0009247256324530239, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 20 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0007135691665212107, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 21 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0009079093911818095, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008066306408391728, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 27 meta round 3 chosen client: [9, 4, 13, 8, 17]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.000963365722175998, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0008166004032347469, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004541345364394424, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 13 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0006816684457646716, unsupervised loss ratio: 1.0, lr 0.021, 36 pseu out of 37 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006842280538343214, unsupervised loss ratio: 1.0, lr 0.021, 401 pseu out of 667 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 27 meta round 4 chosen client: [15, 11, 0, 2, 4]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0007952372584371075, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 5 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0009142505141426227, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2967880781815977 lr : 0.03
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0009041483572218567, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0007833348968738897, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 27 meta round 5 chosen client: [7, 0, 19, 12, 1]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0009083648384638274, unsupervised loss ratio: 1.0, lr 0.021, 32 pseu out of 34 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2711513772302745 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0007878987369342492, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 6 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0008392394096719929, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011187145804486623, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
************ Loss Avg 0.1719552211979423, LR 0.03, Round 27 ends ************  

TEST Student: Epoch: 27

TEST AUROC: 0.662220, TEST Accus: 0.244929, TEST Pre: 0.064832, TEST Recall: 0.158251
Comm round 28 meta round 0 chosen client: [7, 5, 8, 18, 19]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002593574575607468, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 43 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0023244616525919465, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016346854799849098, unsupervised loss ratio: 1.0, lr 0.021, 89 pseu out of 91 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0025989500184853873, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00207909183369245, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 20 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 28 meta round 1 chosen client: [8, 15, 6, 1, 19]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015244425204627987, unsupervised loss ratio: 1.0, lr 0.021, 172 pseu out of 177 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002172394434203922, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 22 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002174827315763611, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002322397444669793, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0019532520621000095, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 50 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Comm round 28 meta round 2 chosen client: [10, 15, 18, 0, 12]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002021473497232615, unsupervised loss ratio: 1.0, lr 0.021, 59 pseu out of 99 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002074548362641228, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 37 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0024744466257592044, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2379643321037292 lr : 0.03
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0022066211289105317, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 4 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 28 meta round 3 chosen client: [14, 10, 3, 8, 9]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019558697716671636, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0018825511636758416, unsupervised loss ratio: 1.0, lr 0.021, 84 pseu out of 141 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0025145458013347316, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014587265982299868, unsupervised loss ratio: 1.0, lr 0.021, 287 pseu out of 299 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002029740182613885, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 28 meta round 4 chosen client: [2, 19, 9, 14, 8]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0021152509115858094, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001988896903080436, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 115 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001983357390768274, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019605489796958864, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013877186696049648, unsupervised loss ratio: 1.0, lr 0.021, 394 pseu out of 418 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 28 meta round 5 chosen client: [8, 1, 12, 6, 16]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012862782013343121, unsupervised loss ratio: 1.0, lr 0.021, 555 pseu out of 583 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002266363621257791, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0020881174442668755, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 25 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0019911963735585628, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0023235933107064394, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 14 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
************ Loss Avg 0.043245075145973866, LR 0.03, Round 28 ends ************  

TEST Student: Epoch: 28

TEST AUROC: 0.641744, TEST Accus: 0.216234, TEST Pre: 0.045901, TEST Recall: 0.123743
Comm round 29 meta round 0 chosen client: [6, 1, 3, 7, 8]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001391050275887592, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0017457851521080223, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0015271987812021898, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0015000858262423067, unsupervised loss ratio: 1.0, lr 0.021, 70 pseu out of 79 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008272197545693416, unsupervised loss ratio: 1.0, lr 0.021, 733 pseu out of 784 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Comm round 29 meta round 1 chosen client: [8, 19, 10, 5, 6]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008096527825500743, unsupervised loss ratio: 1.0, lr 0.021, 868 pseu out of 926 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0011662387621935266, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 210 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001152147262975381, unsupervised loss ratio: 1.0, lr 0.021, 125 pseu out of 195 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0015431639278444965, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0013169886956018381, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 17 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 29 meta round 2 chosen client: [14, 17, 15, 4, 2]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0016764367782426152, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.001139514633299162, unsupervised loss ratio: 1.0, lr 0.021, 509 pseu out of 924 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0012426020261325622, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 70 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001356389078113901, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 5 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0014695312073897747, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 29 meta round 3 chosen client: [4, 3, 18, 13, 14]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0013457338227742604, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 20 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0014900646438036347, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0017164985442327128, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0007929360692318277, unsupervised loss ratio: 1.0, lr 0.021, 25 pseu out of 30 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0016237851108819473, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 29 meta round 4 chosen client: [1, 17, 12, 2, 11]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0016967014483426038, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010872435252230357, unsupervised loss ratio: 1.0, lr 0.021, 605 pseu out of 1209 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0012961780552157305, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 88 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001440443099930971, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015497152435273165, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 29 meta round 5 chosen client: [16, 0, 13, 1, 12]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0014165902432039014, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 25 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2168627223189996 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006833870333355015, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 76 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0016958571561589474, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0012976932025695633, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 219 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
************ Loss Avg 0.041861985148726154, LR 0.03, Round 29 ends ************  

TEST Student: Epoch: 29

TEST AUROC: 0.639271, TEST Accus: 0.208897, TEST Pre: 0.040873, TEST Recall: 0.114720
Comm round 30 meta round 0 chosen client: [18, 1, 12, 7, 13]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0015021018431677173, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0014800423835744944, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001084382964957816, unsupervised loss ratio: 1.0, lr 0.021, 6 pseu out of 377 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0012023015022770357, unsupervised loss ratio: 1.0, lr 0.021, 97 pseu out of 110 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006237277305799426, unsupervised loss ratio: 1.0, lr 0.021, 125 pseu out of 140 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 30 meta round 1 chosen client: [10, 16, 8, 17, 19]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0009226017518185785, unsupervised loss ratio: 1.0, lr 0.021, 161 pseu out of 284 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0011725779374694972, unsupervised loss ratio: 1.0, lr 0.021, 29 pseu out of 50 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0006733672170184946, unsupervised loss ratio: 1.0, lr 0.021, 1086 pseu out of 1176 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009368247631535834, unsupervised loss ratio: 1.0, lr 0.021, 705 pseu out of 1491 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0009340578404729827, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 353 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Comm round 30 meta round 2 chosen client: [6, 14, 1, 5, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0010705227584854795, unsupervised loss ratio: 1.0, lr 0.021, 42 pseu out of 44 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001501470654285654, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0014382964539591495, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001246402972400738, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001066205985446845, unsupervised loss ratio: 1.0, lr 0.021, 49 pseu out of 61 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 30 meta round 3 chosen client: [10, 14, 7, 1, 2]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0009360938214552428, unsupervised loss ratio: 1.0, lr 0.021, 198 pseu out of 381 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014560304169373756, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0012055872234318836, unsupervised loss ratio: 1.0, lr 0.021, 134 pseu out of 159 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0013603269358210992, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0012616964744492656, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 30 meta round 4 chosen client: [17, 3, 1, 5, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009378378447439607, unsupervised loss ratio: 1.0, lr 0.021, 786 pseu out of 1787 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0012081479156742197, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 8 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0013001626825936865, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0012342843635496303, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0010224972003405647, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 99 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 30 meta round 5 chosen client: [12, 10, 17, 11, 3]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0010555689565889122, unsupervised loss ratio: 1.0, lr 0.021, 6 pseu out of 578 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0008787038366727788, unsupervised loss ratio: 1.0, lr 0.021, 235 pseu out of 479 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009269526264437571, unsupervised loss ratio: 1.0, lr 0.021, 832 pseu out of 2067 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001315684629844327, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0012121901703981816, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 17 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
************ Loss Avg 0.0011388883286004299, LR 0.03, Round 30 ends ************  

TEST Student: Epoch: 30

TEST AUROC: 0.624100, TEST Accus: 0.198294, TEST Pre: 0.032328, TEST Recall: 0.102751
Comm round 31 meta round 0 chosen client: [19, 7, 14, 13, 16]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005636860076218653, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 547 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0006694942469319078, unsupervised loss ratio: 1.0, lr 0.021, 167 pseu out of 223 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014016972060992637, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005512766335830408, unsupervised loss ratio: 1.0, lr 0.021, 238 pseu out of 279 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006947243046091839, unsupervised loss ratio: 1.0, lr 0.021, 51 pseu out of 84 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Comm round 31 meta round 1 chosen client: [19, 9, 12, 5, 7]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005789145489427774, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 758 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0016304751231843882, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0006373860388218115, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 899 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0008067007584031671, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 7 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.000701129958682801, unsupervised loss ratio: 1.0, lr 0.021, 205 pseu out of 285 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 31 meta round 2 chosen client: [10, 4, 11, 8, 6]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0005127729698493756, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 628 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006411577388274646, unsupervised loss ratio: 1.0, lr 0.021, 124 pseu out of 180 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0009974456224881578, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 5 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00042490420391061434, unsupervised loss ratio: 1.0, lr 0.021, 1222 pseu out of 1334 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0007187896488281642, unsupervised loss ratio: 1.0, lr 0.021, 97 pseu out of 103 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 31 meta round 3 chosen client: [9, 6, 10, 4, 17]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014617231661557322, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0006662624429631303, unsupervised loss ratio: 1.0, lr 0.021, 182 pseu out of 191 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.000525772141027746, unsupervised loss ratio: 1.0, lr 0.021, 315 pseu out of 701 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006049344120251517, unsupervised loss ratio: 1.0, lr 0.021, 163 pseu out of 241 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005984792807647938, unsupervised loss ratio: 1.0, lr 0.021, 899 pseu out of 2352 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 31 meta round 4 chosen client: [17, 14, 13, 2, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005997154415429881, unsupervised loss ratio: 1.0, lr 0.021, 928 pseu out of 2644 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0012960641055762994, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004474110417936187, unsupervised loss ratio: 1.0, lr 0.021, 352 pseu out of 418 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0009509932327394685, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0006791466322073785, unsupervised loss ratio: 1.0, lr 0.021, 244 pseu out of 344 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 31 meta round 5 chosen client: [6, 17, 8, 5, 12]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0006339012500087636, unsupervised loss ratio: 1.0, lr 0.021, 280 pseu out of 302 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006429392335288783, unsupervised loss ratio: 1.0, lr 0.021, 950 pseu out of 2820 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004009731882916867, unsupervised loss ratio: 1.0, lr 0.021, 1368 pseu out of 1515 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007459551909915553, unsupervised loss ratio: 1.0, lr 0.021, 26 pseu out of 29 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0006628118306657092, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1167 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
************ Loss Avg 0.0007482545867022294, LR 0.03, Round 31 ends ************  

TEST Student: Epoch: 31

TEST AUROC: 0.618922, TEST Accus: 0.196258, TEST Pre: 0.025539, TEST Recall: 0.100481
Comm round 32 meta round 0 chosen client: [8, 6, 11, 7, 4]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0003547826814624955, unsupervised loss ratio: 1.0, lr 0.021, 1507 pseu out of 1686 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.000489832576536371, unsupervised loss ratio: 1.0, lr 0.021, 379 pseu out of 421 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0007765285017740098, unsupervised loss ratio: 1.0, lr 0.021, 38 pseu out of 38 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005010262795202344, unsupervised loss ratio: 1.0, lr 0.021, 285 pseu out of 423 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004520395207994928, unsupervised loss ratio: 1.0, lr 0.021, 233 pseu out of 388 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Comm round 32 meta round 1 chosen client: [13, 6, 19, 2, 17]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003573084351215985, unsupervised loss ratio: 1.0, lr 0.021, 477 pseu out of 596 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0004617548984242603, unsupervised loss ratio: 1.0, lr 0.021, 506 pseu out of 579 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.000418272974153903, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 998 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0008433538827202504, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0005028886414780656, unsupervised loss ratio: 1.0, lr 0.021, 978 pseu out of 3080 are correct, 0 correct by model, 0 correct by ema before train, 1069 by model during train, total 5558
Comm round 32 meta round 2 chosen client: [6, 14, 5, 18, 1]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0004682702816300688, unsupervised loss ratio: 1.0, lr 0.021, 591 pseu out of 689 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0012086276379484457, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0005556553607943971, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 55 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.000951457186602056, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0009363183592696016, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Comm round 32 meta round 3 chosen client: [0, 19, 14, 8, 13]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.3169557415709203 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00043744792231173517, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1200 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0011068160326403538, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00036305297612670984, unsupervised loss ratio: 1.0, lr 0.021, 1614 pseu out of 1826 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00029582274639663303, unsupervised loss ratio: 1.0, lr 0.021, 653 pseu out of 817 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 32 meta round 4 chosen client: [4, 8, 7, 5, 10]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004237424529116926, unsupervised loss ratio: 1.0, lr 0.021, 275 pseu out of 500 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.000342436977391003, unsupervised loss ratio: 1.0, lr 0.021, 1743 pseu out of 1990 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0005118751236855482, unsupervised loss ratio: 1.0, lr 0.021, 320 pseu out of 502 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0005718898114015455, unsupervised loss ratio: 1.0, lr 0.021, 62 pseu out of 101 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0003963811737023583, unsupervised loss ratio: 1.0, lr 0.021, 349 pseu out of 838 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Comm round 32 meta round 5 chosen client: [4, 16, 10, 9, 18]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004221696088077604, unsupervised loss ratio: 1.0, lr 0.021, 340 pseu out of 655 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0005141313905354406, unsupervised loss ratio: 1.0, lr 0.021, 64 pseu out of 143 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00040842382842474134, unsupervised loss ratio: 1.0, lr 0.021, 376 pseu out of 970 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001466523426912587, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.000877188772493456, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
************ Loss Avg 0.04447905870109658, LR 0.03, Round 32 ends ************  

TEST Student: Epoch: 32

TEST AUROC: 0.637554, TEST Accus: 0.200830, TEST Pre: 0.034242, TEST Recall: 0.105487
Comm round 33 meta round 0 chosen client: [15, 11, 18, 8, 0]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0006818701221163792, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 122 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0006779675136385777, unsupervised loss ratio: 1.0, lr 0.021, 87 pseu out of 88 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0008888938140848444, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0005547187779484375, unsupervised loss ratio: 1.0, lr 0.021, 1813 pseu out of 2098 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2318195931765499 lr : 0.03
Comm round 33 meta round 1 chosen client: [19, 8, 11, 16, 18]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0007761812219261908, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 1363 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0005360383732693208, unsupervised loss ratio: 1.0, lr 0.021, 1881 pseu out of 2192 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.000612313241163065, unsupervised loss ratio: 1.0, lr 0.021, 148 pseu out of 153 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0007438511682147557, unsupervised loss ratio: 1.0, lr 0.021, 105 pseu out of 227 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0008793816038329775, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 8 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 33 meta round 2 chosen client: [15, 4, 6, 12, 18]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0006841919292687984, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 179 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006915291178590869, unsupervised loss ratio: 1.0, lr 0.021, 402 pseu out of 801 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0006777152319546735, unsupervised loss ratio: 1.0, lr 0.021, 686 pseu out of 844 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0008463214421580131, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1447 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0008723031221759609, unsupervised loss ratio: 1.0, lr 0.021, 6 pseu out of 6 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 33 meta round 3 chosen client: [4, 17, 2, 7, 3]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0007012049490373419, unsupervised loss ratio: 1.0, lr 0.021, 431 pseu out of 880 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0008782969186237702, unsupervised loss ratio: 1.0, lr 0.021, 998 pseu out of 3201 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0007498382460436828, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 4 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008727633464262069, unsupervised loss ratio: 1.0, lr 0.021, 337 pseu out of 553 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0007586514416938631, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 24 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 33 meta round 4 chosen client: [7, 10, 18, 13, 11]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008791573051824414, unsupervised loss ratio: 1.0, lr 0.021, 363 pseu out of 645 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0007112628721595934, unsupervised loss ratio: 1.0, lr 0.021, 395 pseu out of 1082 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0007964228829627649, unsupervised loss ratio: 1.0, lr 0.021, 21 pseu out of 24 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0001888278506990222, unsupervised loss ratio: 1.0, lr 0.021, 817 pseu out of 1058 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0005464524133458326, unsupervised loss ratio: 1.0, lr 0.021, 232 pseu out of 240 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 33 meta round 5 chosen client: [5, 6, 9, 0, 17]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007359492411211011, unsupervised loss ratio: 1.0, lr 0.021, 82 pseu out of 143 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0006976328318621423, unsupervised loss ratio: 1.0, lr 0.021, 753 pseu out of 975 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0010821159915024138, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.290036791441392 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0008611581187920067, unsupervised loss ratio: 1.0, lr 0.021, 1007 pseu out of 3336 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
************ Loss Avg 0.08474797985690018, LR 0.03, Round 33 ends ************  

TEST Student: Epoch: 33

TEST AUROC: 0.670961, TEST Accus: 0.222918, TEST Pre: 0.047192, TEST Recall: 0.129804
Comm round 34 meta round 0 chosen client: [11, 8, 15, 1, 19]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0008637767350592185, unsupervised loss ratio: 1.0, lr 0.021, 354 pseu out of 376 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009422460624364248, unsupervised loss ratio: 1.0, lr 0.021, 1911 pseu out of 2237 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0011697586263135936, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 261 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0012350606663924892, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0013530902756312385, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 1596 are correct, 0 correct by model, 0 correct by ema before train, 21 by model during train, total 4949
Comm round 34 meta round 1 chosen client: [7, 2, 5, 8, 9]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0015770891681873205, unsupervised loss ratio: 1.0, lr 0.021, 365 pseu out of 698 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011508916698706646, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 9 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0012534183343170119, unsupervised loss ratio: 1.0, lr 0.021, 104 pseu out of 200 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009341966265310475, unsupervised loss ratio: 1.0, lr 0.021, 1989 pseu out of 2333 are correct, 0 correct by model, 0 correct by ema before train, 2349 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001314264614376481, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 34 meta round 2 chosen client: [4, 7, 8, 9, 6]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0012467022990301578, unsupervised loss ratio: 1.0, lr 0.021, 463 pseu out of 1011 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001546235089055979, unsupervised loss ratio: 1.0, lr 0.021, 388 pseu out of 774 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009391622137400191, unsupervised loss ratio: 1.0, lr 0.021, 2017 pseu out of 2403 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012719379495441292, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0012589739802195622, unsupervised loss ratio: 1.0, lr 0.021, 830 pseu out of 1110 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 34 meta round 3 chosen client: [2, 18, 17, 19, 9]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011061655601397867, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 11 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0013327871387850286, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 34 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014419572136161484, unsupervised loss ratio: 1.0, lr 0.021, 1021 pseu out of 3405 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001298704726743894, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1727 are correct, 0 correct by model, 0 correct by ema before train, 21 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001311872082253642, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 34 meta round 4 chosen client: [1, 6, 13, 3, 12]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011426553530504973, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 5 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0012355776205473323, unsupervised loss ratio: 1.0, lr 0.021, 899 pseu out of 1247 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002819826792909811, unsupervised loss ratio: 1.0, lr 0.021, 933 pseu out of 1242 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013825748932764067, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 33 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013895279727876187, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1703 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 34 meta round 5 chosen client: [1, 16, 12, 4, 14]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011200957800965848, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 10 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0013619050694644818, unsupervised loss ratio: 1.0, lr 0.021, 130 pseu out of 296 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013858022621004945, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1943 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0012270311604619824, unsupervised loss ratio: 1.0, lr 0.021, 517 pseu out of 1150 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001245374438550436, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
************ Loss Avg 0.001210693942062355, LR 0.03, Round 34 ends ************  

TEST Student: Epoch: 34

TEST AUROC: 0.637399, TEST Accus: 0.199639, TEST Pre: 0.035036, TEST Recall: 0.103727
Comm round 35 meta round 0 chosen client: [1, 5, 19, 7, 11]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0007583096313926323, unsupervised loss ratio: 1.0, lr 0.021, 26 pseu out of 27 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0006048623968648618, unsupervised loss ratio: 1.0, lr 0.021, 126 pseu out of 250 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0005865217692469462, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1968 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 4949
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0006716467900192724, unsupervised loss ratio: 1.0, lr 0.021, 404 pseu out of 835 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0005051364896644372, unsupervised loss ratio: 1.0, lr 0.021, 501 pseu out of 533 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 35 meta round 1 chosen client: [5, 6, 0, 14, 9]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0005948651478469341, unsupervised loss ratio: 1.0, lr 0.021, 157 pseu out of 368 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0005538139628934796, unsupervised loss ratio: 1.0, lr 0.021, 933 pseu out of 1362 are correct, 0 correct by model, 0 correct by ema before train, 1236 by model during train, total 4383
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2739518625395638 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0011130155550993302, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012600134963307668, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 35 meta round 2 chosen client: [4, 17, 16, 18, 5]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0004926218874364471, unsupervised loss ratio: 1.0, lr 0.021, 555 pseu out of 1329 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006298699769815002, unsupervised loss ratio: 1.0, lr 0.021, 1026 pseu out of 3518 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.000559646086137528, unsupervised loss ratio: 1.0, lr 0.021, 149 pseu out of 394 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0007278256630848369, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 57 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0006159861487637991, unsupervised loss ratio: 1.0, lr 0.021, 173 pseu out of 436 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Comm round 35 meta round 3 chosen client: [13, 8, 17, 10, 3]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00019833436509558805, unsupervised loss ratio: 1.0, lr 0.021, 1110 pseu out of 1497 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0004512498467477144, unsupervised loss ratio: 1.0, lr 0.021, 2071 pseu out of 2471 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006675847654495837, unsupervised loss ratio: 1.0, lr 0.021, 1034 pseu out of 3720 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0004823232917135164, unsupervised loss ratio: 1.0, lr 0.021, 430 pseu out of 1220 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0006364138323533552, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 60 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 35 meta round 4 chosen client: [15, 5, 19, 16, 18]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0005415882967869178, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 373 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0006447023958765489, unsupervised loss ratio: 1.0, lr 0.021, 197 pseu out of 556 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0006315015673000091, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 2147 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006075151857240584, unsupervised loss ratio: 1.0, lr 0.021, 177 pseu out of 504 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0006870499694034354, unsupervised loss ratio: 1.0, lr 0.021, 64 pseu out of 75 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 35 meta round 5 chosen client: [16, 4, 11, 10, 17]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0006219483053189565, unsupervised loss ratio: 1.0, lr 0.021, 202 pseu out of 639 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0005435096049156513, unsupervised loss ratio: 1.0, lr 0.021, 577 pseu out of 1434 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.000467412950911239, unsupervised loss ratio: 1.0, lr 0.021, 673 pseu out of 735 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0005075501366859656, unsupervised loss ratio: 1.0, lr 0.021, 445 pseu out of 1326 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0006904550831384914, unsupervised loss ratio: 1.0, lr 0.021, 1042 pseu out of 3840 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
************ Loss Avg 0.04306683790462492, LR 0.03, Round 35 ends ************  

TEST Student: Epoch: 35

TEST AUROC: 0.649009, TEST Accus: 0.202750, TEST Pre: 0.037514, TEST Recall: 0.107058
Comm round 36 meta round 0 chosen client: [0, 8, 2, 9, 13]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.2432589153854214 lr : 0.03
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0005658358484197379, unsupervised loss ratio: 1.0, lr 0.021, 2106 pseu out of 2542 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0007168934479566468, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 33 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0010856732465240552, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00016247232565932545, unsupervised loss ratio: 1.0, lr 0.021, 1247 pseu out of 1693 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 36 meta round 1 chosen client: [2, 3, 6, 19, 13]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0006595854155464275, unsupervised loss ratio: 1.0, lr 0.021, 29 pseu out of 43 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0007510028303840954, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 91 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0007384128445098041, unsupervised loss ratio: 1.0, lr 0.021, 1002 pseu out of 1510 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0007999478070698201, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 2276 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 4949
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00015958480879031044, unsupervised loss ratio: 1.0, lr 0.021, 1367 pseu out of 1883 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Comm round 36 meta round 2 chosen client: [10, 18, 2, 19, 6]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.000663682251138982, unsupervised loss ratio: 1.0, lr 0.021, 462 pseu out of 1435 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0007552086107251751, unsupervised loss ratio: 1.0, lr 0.021, 86 pseu out of 103 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0006486327762277575, unsupervised loss ratio: 1.0, lr 0.021, 39 pseu out of 69 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008310397036742264, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2466 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 4949
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0007290919610818821, unsupervised loss ratio: 1.0, lr 0.021, 1037 pseu out of 1625 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 36 meta round 3 chosen client: [14, 3, 19, 16, 12]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009642306611181773, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0007441561823335567, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 130 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008342621393892794, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2624 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0007742653337505752, unsupervised loss ratio: 1.0, lr 0.021, 216 pseu out of 767 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.000839442703484868, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2181 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Comm round 36 meta round 4 chosen client: [10, 5, 12, 7, 2]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0006997420794756055, unsupervised loss ratio: 1.0, lr 0.021, 488 pseu out of 1557 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007623245020694726, unsupervised loss ratio: 1.0, lr 0.021, 218 pseu out of 692 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0008200015465263278, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2414 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008047731791101306, unsupervised loss ratio: 1.0, lr 0.021, 422 pseu out of 902 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0006312763850603785, unsupervised loss ratio: 1.0, lr 0.021, 48 pseu out of 95 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Comm round 36 meta round 5 chosen client: [1, 15, 0, 5, 19]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0007296351789746707, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 53 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0006586289721711253, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 504 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.257381596127335 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007872622146187198, unsupervised loss ratio: 1.0, lr 0.021, 222 pseu out of 799 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0008589409788748106, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2761 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
************ Loss Avg 0.08402721724824741, LR 0.03, Round 36 ends ************  

TEST Student: Epoch: 36

TEST AUROC: 0.681351, TEST Accus: 0.228104, TEST Pre: 0.063990, TEST Recall: 0.135161
Comm round 37 meta round 0 chosen client: [8, 4, 6, 1, 0]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009391044810307392, unsupervised loss ratio: 1.0, lr 0.021, 2141 pseu out of 2615 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0011953616325165116, unsupervised loss ratio: 1.0, lr 0.021, 591 pseu out of 1576 are correct, 0 correct by model, 0 correct by ema before train, 720 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0012874415357752393, unsupervised loss ratio: 1.0, lr 0.021, 1074 pseu out of 1732 are correct, 0 correct by model, 0 correct by ema before train, 1238 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011966646941401428, unsupervised loss ratio: 1.0, lr 0.021, 84 pseu out of 93 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1330665118840275 lr : 0.03
Comm round 37 meta round 1 chosen client: [15, 18, 9, 10, 6]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0011352898008436358, unsupervised loss ratio: 1.0, lr 0.021, 6 pseu out of 622 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0013726317540406147, unsupervised loss ratio: 1.0, lr 0.021, 112 pseu out of 145 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014674773416050743, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0012535714195109904, unsupervised loss ratio: 1.0, lr 0.021, 500 pseu out of 1623 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00128307271718412, unsupervised loss ratio: 1.0, lr 0.021, 1107 pseu out of 1862 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Comm round 37 meta round 2 chosen client: [4, 5, 19, 0, 3]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0011913222551811486, unsupervised loss ratio: 1.0, lr 0.021, 617 pseu out of 1731 are correct, 0 correct by model, 0 correct by ema before train, 721 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013698378256254936, unsupervised loss ratio: 1.0, lr 0.021, 236 pseu out of 900 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0014190708340417284, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2856 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1706512205454769 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013877184065417428, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 180 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Comm round 37 meta round 3 chosen client: [7, 5, 3, 16, 15]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0014161625205395888, unsupervised loss ratio: 1.0, lr 0.021, 430 pseu out of 966 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013596785687039928, unsupervised loss ratio: 1.0, lr 0.021, 249 pseu out of 1021 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013697306901901487, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 239 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0014672102549754572, unsupervised loss ratio: 1.0, lr 0.021, 237 pseu out of 870 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0011322092118427043, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 800 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Comm round 37 meta round 4 chosen client: [2, 7, 18, 5, 13]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011424731097317167, unsupervised loss ratio: 1.0, lr 0.021, 68 pseu out of 141 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0014524513440287241, unsupervised loss ratio: 1.0, lr 0.021, 441 pseu out of 1056 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.001303805471656637, unsupervised loss ratio: 1.0, lr 0.021, 144 pseu out of 184 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001340226850426588, unsupervised loss ratio: 1.0, lr 0.021, 260 pseu out of 1138 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00024086671464058364, unsupervised loss ratio: 1.0, lr 0.021, 1476 pseu out of 2076 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 37 meta round 5 chosen client: [2, 12, 18, 6, 16]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011039297824027017, unsupervised loss ratio: 1.0, lr 0.021, 94 pseu out of 190 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001377368023774276, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2643 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0013176324719097465, unsupervised loss ratio: 1.0, lr 0.021, 163 pseu out of 215 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0012472960490571415, unsupervised loss ratio: 1.0, lr 0.021, 1123 pseu out of 1952 are correct, 0 correct by model, 0 correct by ema before train, 1237 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0014490370698784646, unsupervised loss ratio: 1.0, lr 0.021, 253 pseu out of 979 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
************ Loss Avg 0.07796454584204332, LR 0.03, Round 37 ends ************  

TEST Student: Epoch: 37

TEST AUROC: 0.696624, TEST Accus: 0.245890, TEST Pre: 0.085080, TEST Recall: 0.157023
Comm round 38 meta round 0 chosen client: [4, 10, 0, 5, 11]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0014081473186490171, unsupervised loss ratio: 1.0, lr 0.021, 648 pseu out of 1870 are correct, 0 correct by model, 0 correct by ema before train, 721 by model during train, total 3987
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0015700883683668256, unsupervised loss ratio: 1.0, lr 0.021, 515 pseu out of 1763 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1329695570225617 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0016511395787362194, unsupervised loss ratio: 1.0, lr 0.021, 269 pseu out of 1264 are correct, 0 correct by model, 0 correct by ema before train, 298 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0011448773884694674, unsupervised loss ratio: 1.0, lr 0.021, 828 pseu out of 926 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Comm round 38 meta round 1 chosen client: [6, 8, 12, 5, 13]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0015536098069497857, unsupervised loss ratio: 1.0, lr 0.021, 1136 pseu out of 2062 are correct, 0 correct by model, 0 correct by ema before train, 1238 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011034914466847567, unsupervised loss ratio: 1.0, lr 0.021, 2162 pseu out of 2653 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0016148180623228351, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0016384319431858411, unsupervised loss ratio: 1.0, lr 0.021, 269 pseu out of 1328 are correct, 0 correct by model, 0 correct by ema before train, 298 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003275700822133192, unsupervised loss ratio: 1.0, lr 0.021, 1566 pseu out of 2249 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 38 meta round 2 chosen client: [16, 13, 12, 3, 0]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0017405007679595567, unsupervised loss ratio: 1.0, lr 0.021, 263 pseu out of 1112 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003363163660821047, unsupervised loss ratio: 1.0, lr 0.021, 1663 pseu out of 2410 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001654641553048148, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3028 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0016288672963388048, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 306 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1379190561722736 lr : 0.03
Comm round 38 meta round 3 chosen client: [8, 9, 17, 3, 4]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001138860423850474, unsupervised loss ratio: 1.0, lr 0.021, 2191 pseu out of 2716 are correct, 0 correct by model, 0 correct by ema before train, 2349 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014597538845717078, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015830474078719471, unsupervised loss ratio: 1.0, lr 0.021, 1042 pseu out of 3863 are correct, 0 correct by model, 0 correct by ema before train, 1071 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0016064190042145907, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 369 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001458627407185896, unsupervised loss ratio: 1.0, lr 0.021, 654 pseu out of 1935 are correct, 0 correct by model, 0 correct by ema before train, 722 by model during train, total 3987
Comm round 38 meta round 4 chosen client: [15, 13, 9, 10, 4]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0013720722767035253, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 912 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003673329705696048, unsupervised loss ratio: 1.0, lr 0.021, 1744 pseu out of 2518 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014768974312270682, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001569413943296491, unsupervised loss ratio: 1.0, lr 0.021, 523 pseu out of 1853 are correct, 0 correct by model, 0 correct by ema before train, 571 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0014270883261887652, unsupervised loss ratio: 1.0, lr 0.021, 654 pseu out of 1998 are correct, 0 correct by model, 0 correct by ema before train, 724 by model during train, total 3987
Comm round 38 meta round 5 chosen client: [3, 0, 2, 12, 6]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0017170441580154666, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 473 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1211676804386839 lr : 0.03
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001402831905233186, unsupervised loss ratio: 1.0, lr 0.021, 111 pseu out of 246 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0016785749298934307, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3108 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001564287297103716, unsupervised loss ratio: 1.0, lr 0.021, 1154 pseu out of 2114 are correct, 0 correct by model, 0 correct by ema before train, 1240 by model during train, total 4383
************ Loss Avg 0.1143083681659484, LR 0.03, Round 38 ends ************  

TEST Student: Epoch: 38

TEST AUROC: 0.717733, TEST Accus: 0.289490, TEST Pre: 0.103566, TEST Recall: 0.218302
Comm round 39 meta round 0 chosen client: [3, 2, 1, 9, 6]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0025209482524327803, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 544 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002236270844670279, unsupervised loss ratio: 1.0, lr 0.021, 122 pseu out of 316 are correct, 0 correct by model, 0 correct by ema before train, 252 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00211857092600861, unsupervised loss ratio: 1.0, lr 0.021, 119 pseu out of 143 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002162555421280019, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002248257158604194, unsupervised loss ratio: 1.0, lr 0.021, 1159 pseu out of 2189 are correct, 0 correct by model, 0 correct by ema before train, 1238 by model during train, total 4383
Comm round 39 meta round 1 chosen client: [16, 15, 8, 6, 3]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0027693256403731764, unsupervised loss ratio: 1.0, lr 0.021, 273 pseu out of 1202 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0019853680287129603, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1079 are correct, 0 correct by model, 0 correct by ema before train, 9 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001640430080101396, unsupervised loss ratio: 1.0, lr 0.021, 2191 pseu out of 2705 are correct, 0 correct by model, 0 correct by ema before train, 2349 by model during train, total 4036
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0021400674266497726, unsupervised loss ratio: 1.0, lr 0.021, 1177 pseu out of 2243 are correct, 0 correct by model, 0 correct by ema before train, 1250 by model during train, total 4383
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002467848391623712, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 641 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 3526
Comm round 39 meta round 2 chosen client: [0, 7, 4, 11, 2]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1007529290354983 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0023524341522715986, unsupervised loss ratio: 1.0, lr 0.021, 435 pseu out of 1107 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020955084589317384, unsupervised loss ratio: 1.0, lr 0.021, 671 pseu out of 2072 are correct, 0 correct by model, 0 correct by ema before train, 727 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0017971565894185915, unsupervised loss ratio: 1.0, lr 0.021, 1009 pseu out of 1131 are correct, 0 correct by model, 0 correct by ema before train, 1848 by model during train, total 4088
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0021417101975419513, unsupervised loss ratio: 1.0, lr 0.021, 137 pseu out of 375 are correct, 0 correct by model, 0 correct by ema before train, 253 by model during train, total 2665
Comm round 39 meta round 3 chosen client: [3, 14, 0, 15, 17]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0025140844019395964, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 733 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0021127683805499337, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 1 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.094008585628198 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002016579164046561, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1185 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 4099
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0020413904125673762, unsupervised loss ratio: 1.0, lr 0.021, 1049 pseu out of 3935 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 5558
Comm round 39 meta round 4 chosen client: [11, 8, 10, 18, 4]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001713076174382877, unsupervised loss ratio: 1.0, lr 0.021, 1131 pseu out of 1290 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015961913032924713, unsupervised loss ratio: 1.0, lr 0.021, 2225 pseu out of 2751 are correct, 0 correct by model, 0 correct by ema before train, 2350 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0024501455331558428, unsupervised loss ratio: 1.0, lr 0.021, 519 pseu out of 1873 are correct, 0 correct by model, 0 correct by ema before train, 574 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002578686883983513, unsupervised loss ratio: 1.0, lr 0.021, 199 pseu out of 261 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002025536070245185, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 2117 are correct, 0 correct by model, 0 correct by ema before train, 726 by model during train, total 3987
Comm round 39 meta round 5 chosen client: [5, 18, 12, 1, 2]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002289157062120064, unsupervised loss ratio: 1.0, lr 0.021, 271 pseu out of 1461 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0023648595864263675, unsupervised loss ratio: 1.0, lr 0.021, 218 pseu out of 296 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002169053283675263, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3240 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0020532007925439535, unsupervised loss ratio: 1.0, lr 0.021, 150 pseu out of 182 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0020831423060458506, unsupervised loss ratio: 1.0, lr 0.021, 156 pseu out of 415 are correct, 0 correct by model, 0 correct by ema before train, 253 by model during train, total 2665
************ Loss Avg 0.07518152791957641, LR 0.03, Round 39 ends ************  

TEST Student: Epoch: 39

TEST AUROC: 0.713213, TEST Accus: 0.280347, TEST Pre: 0.208242, TEST Recall: 0.209024
Comm round 40 meta round 0 chosen client: [14, 5, 8, 9, 18]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019037294974127276, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001966780050634788, unsupervised loss ratio: 1.0, lr 0.021, 279 pseu out of 1489 are correct, 0 correct by model, 0 correct by ema before train, 300 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013883264525702543, unsupervised loss ratio: 1.0, lr 0.021, 2218 pseu out of 2744 are correct, 0 correct by model, 0 correct by ema before train, 2346 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001989179506415018, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00207500455629391, unsupervised loss ratio: 1.0, lr 0.021, 254 pseu out of 346 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 40 meta round 1 chosen client: [5, 3, 9, 16, 2]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0020071867871056235, unsupervised loss ratio: 1.0, lr 0.021, 284 pseu out of 1574 are correct, 0 correct by model, 0 correct by ema before train, 299 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0022307707080082245, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 794 are correct, 0 correct by model, 0 correct by ema before train, 14 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0020116281434807374, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0024245088990609786, unsupervised loss ratio: 1.0, lr 0.021, 282 pseu out of 1287 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001954981494539728, unsupervised loss ratio: 1.0, lr 0.021, 161 pseu out of 504 are correct, 0 correct by model, 0 correct by ema before train, 254 by model during train, total 2665
Comm round 40 meta round 2 chosen client: [9, 5, 8, 7, 11]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0019025233826444794, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 0 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0020375501943683465, unsupervised loss ratio: 1.0, lr 0.021, 283 pseu out of 1644 are correct, 0 correct by model, 0 correct by ema before train, 302 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014067113742157744, unsupervised loss ratio: 1.0, lr 0.021, 2237 pseu out of 2798 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0018795989179544938, unsupervised loss ratio: 1.0, lr 0.021, 456 pseu out of 1139 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001551786609525152, unsupervised loss ratio: 1.0, lr 0.021, 1254 pseu out of 1449 are correct, 0 correct by model, 0 correct by ema before train, 1846 by model during train, total 4088
Comm round 40 meta round 3 chosen client: [17, 15, 14, 0, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017909489022755202, unsupervised loss ratio: 1.0, lr 0.021, 1047 pseu out of 3916 are correct, 0 correct by model, 0 correct by ema before train, 1074 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017566119925154803, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 1322 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0018924444518757589, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.058728674236609 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0020635454448683257, unsupervised loss ratio: 1.0, lr 0.021, 458 pseu out of 1215 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 40 meta round 4 chosen client: [9, 18, 6, 10, 3]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0019312590523407347, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 3 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002159204088254935, unsupervised loss ratio: 1.0, lr 0.021, 281 pseu out of 393 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0019344631042601406, unsupervised loss ratio: 1.0, lr 0.021, 1188 pseu out of 2305 are correct, 0 correct by model, 0 correct by ema before train, 1248 by model during train, total 4383
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002057492106767564, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1939 are correct, 0 correct by model, 0 correct by ema before train, 576 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0022921655204949536, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 871 are correct, 0 correct by model, 0 correct by ema before train, 15 by model during train, total 3526
Comm round 40 meta round 5 chosen client: [8, 10, 0, 17, 1]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013761922055550713, unsupervised loss ratio: 1.0, lr 0.021, 2243 pseu out of 2808 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002065764194663518, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1987 are correct, 0 correct by model, 0 correct by ema before train, 580 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1106736100449854 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017301453225282502, unsupervised loss ratio: 1.0, lr 0.021, 1050 pseu out of 3923 are correct, 0 correct by model, 0 correct by ema before train, 1074 by model during train, total 5558
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0019137122691041085, unsupervised loss ratio: 1.0, lr 0.021, 181 pseu out of 214 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
************ Loss Avg 0.07410321665037765, LR 0.03, Round 40 ends ************  

TEST Student: Epoch: 40

TEST AUROC: 0.715017, TEST Accus: 0.279617, TEST Pre: 0.156562, TEST Recall: 0.206885
Comm round 41 meta round 0 chosen client: [3, 11, 9, 18, 14]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0023102937140200602, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 915 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 3526
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015647081509087002, unsupervised loss ratio: 1.0, lr 0.021, 1366 pseu out of 1623 are correct, 0 correct by model, 0 correct by ema before train, 1850 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0019282216283803184, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 4 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002069128437950793, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 417 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0018479244088556504, unsupervised loss ratio: 1.0, lr 0.021, 1 pseu out of 2 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 41 meta round 1 chosen client: [15, 18, 10, 11, 8]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017882051321346528, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1446 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0020647477908318657, unsupervised loss ratio: 1.0, lr 0.021, 348 pseu out of 500 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002149270839411123, unsupervised loss ratio: 1.0, lr 0.021, 540 pseu out of 2016 are correct, 0 correct by model, 0 correct by ema before train, 579 by model during train, total 3684
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015790946208653622, unsupervised loss ratio: 1.0, lr 0.021, 1467 pseu out of 1760 are correct, 0 correct by model, 0 correct by ema before train, 1849 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013727805670669113, unsupervised loss ratio: 1.0, lr 0.021, 2255 pseu out of 2817 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Comm round 41 meta round 2 chosen client: [9, 4, 17, 7, 18]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018981564628322506, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 10 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0018249786138305412, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 2220 are correct, 0 correct by model, 0 correct by ema before train, 735 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017925653895684358, unsupervised loss ratio: 1.0, lr 0.021, 1050 pseu out of 3950 are correct, 0 correct by model, 0 correct by ema before train, 1077 by model during train, total 5558
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0019677660126874866, unsupervised loss ratio: 1.0, lr 0.021, 473 pseu out of 1302 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00200500040632, unsupervised loss ratio: 1.0, lr 0.021, 366 pseu out of 535 are correct, 0 correct by model, 0 correct by ema before train, 548 by model during train, total 2298
Comm round 41 meta round 3 chosen client: [2, 3, 18, 11, 0]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0019284853797649877, unsupervised loss ratio: 1.0, lr 0.021, 174 pseu out of 579 are correct, 0 correct by model, 0 correct by ema before train, 253 by model during train, total 2665
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0022825192125830135, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 1002 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0021163799149993188, unsupervised loss ratio: 1.0, lr 0.021, 391 pseu out of 584 are correct, 0 correct by model, 0 correct by ema before train, 550 by model during train, total 2298
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015693831146563753, unsupervised loss ratio: 1.0, lr 0.021, 1531 pseu out of 1873 are correct, 0 correct by model, 0 correct by ema before train, 1857 by model during train, total 4088
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0347882411917861 lr : 0.03
Comm round 41 meta round 4 chosen client: [10, 15, 11, 14, 8]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0021941803500120497, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 2055 are correct, 0 correct by model, 0 correct by ema before train, 587 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017876381367946473, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1510 are correct, 0 correct by model, 0 correct by ema before train, 21 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015615888114552945, unsupervised loss ratio: 1.0, lr 0.021, 1572 pseu out of 1971 are correct, 0 correct by model, 0 correct by ema before train, 1861 by model during train, total 4088
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0017893054085134556, unsupervised loss ratio: 1.0, lr 0.021, 2 pseu out of 7 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013920593795901937, unsupervised loss ratio: 1.0, lr 0.021, 2245 pseu out of 2823 are correct, 0 correct by model, 0 correct by ema before train, 2349 by model during train, total 4036
Comm round 41 meta round 5 chosen client: [7, 1, 17, 13, 15]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0020014421629289594, unsupervised loss ratio: 1.0, lr 0.021, 470 pseu out of 1308 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0017828063090990593, unsupervised loss ratio: 1.0, lr 0.021, 230 pseu out of 279 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.001759279323621364, unsupervised loss ratio: 1.0, lr 0.021, 1052 pseu out of 3940 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004560441993200615, unsupervised loss ratio: 1.0, lr 0.021, 1805 pseu out of 2651 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0018057329124600912, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1664 are correct, 0 correct by model, 0 correct by ema before train, 25 by model during train, total 4099
************ Loss Avg 0.036245930932774964, LR 0.03, Round 41 ends ************  

TEST Student: Epoch: 41

TEST AUROC: 0.700325, TEST Accus: 0.250538, TEST Pre: 0.120220, TEST Recall: 0.170962
Comm round 42 meta round 0 chosen client: [19, 9, 1, 3, 10]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0015879802686424975, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2965 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014136594647964186, unsupervised loss ratio: 1.0, lr 0.021, 0 pseu out of 9 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0013470326510553316, unsupervised loss ratio: 1.0, lr 0.021, 276 pseu out of 359 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0017169922068985346, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 1064 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0015590188940505273, unsupervised loss ratio: 1.0, lr 0.021, 546 pseu out of 2099 are correct, 0 correct by model, 0 correct by ema before train, 590 by model during train, total 3684
Comm round 42 meta round 1 chosen client: [17, 12, 18, 4, 9]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0013481133895787015, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 3945 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013599225054753738, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3272 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0014315952010090565, unsupervised loss ratio: 1.0, lr 0.021, 409 pseu out of 620 are correct, 0 correct by model, 0 correct by ema before train, 550 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0013027019223146555, unsupervised loss ratio: 1.0, lr 0.021, 679 pseu out of 2257 are correct, 0 correct by model, 0 correct by ema before train, 740 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014263314240249908, unsupervised loss ratio: 1.0, lr 0.021, 4 pseu out of 20 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 42 meta round 2 chosen client: [17, 16, 1, 4, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0013271332986053378, unsupervised loss ratio: 1.0, lr 0.021, 1052 pseu out of 3926 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0017386179075759576, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 1418 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001408513286150992, unsupervised loss ratio: 1.0, lr 0.021, 319 pseu out of 409 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0012935267683739464, unsupervised loss ratio: 1.0, lr 0.021, 693 pseu out of 2299 are correct, 0 correct by model, 0 correct by ema before train, 744 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0014623460486361112, unsupervised loss ratio: 1.0, lr 0.021, 475 pseu out of 1349 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 42 meta round 3 chosen client: [17, 12, 16, 6, 7]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0012923706444676153, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4019 are correct, 0 correct by model, 0 correct by ema before train, 1079 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013967806861425439, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3363 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.001818347880693122, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 1501 are correct, 0 correct by model, 0 correct by ema before train, 321 by model during train, total 3883
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0015099859995551515, unsupervised loss ratio: 1.0, lr 0.021, 1191 pseu out of 2342 are correct, 0 correct by model, 0 correct by ema before train, 1255 by model during train, total 4383
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001519998975429469, unsupervised loss ratio: 1.0, lr 0.021, 474 pseu out of 1429 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 42 meta round 4 chosen client: [7, 14, 11, 4, 15]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001485571132574338, unsupervised loss ratio: 1.0, lr 0.021, 479 pseu out of 1425 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014128757280890238, unsupervised loss ratio: 1.0, lr 0.021, 3 pseu out of 16 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001154793489149597, unsupervised loss ratio: 1.0, lr 0.021, 1620 pseu out of 2044 are correct, 0 correct by model, 0 correct by ema before train, 1861 by model during train, total 4088
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0013503691861553797, unsupervised loss ratio: 1.0, lr 0.021, 700 pseu out of 2353 are correct, 0 correct by model, 0 correct by ema before train, 746 by model during train, total 3987
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0013497725693014217, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1747 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 4099
Comm round 42 meta round 5 chosen client: [2, 12, 18, 6, 1]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001370861680091669, unsupervised loss ratio: 1.0, lr 0.021, 179 pseu out of 638 are correct, 0 correct by model, 0 correct by ema before train, 253 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013821657853744303, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3449 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0014370162486253928, unsupervised loss ratio: 1.0, lr 0.021, 422 pseu out of 655 are correct, 0 correct by model, 0 correct by ema before train, 549 by model during train, total 2298
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00144510624754796, unsupervised loss ratio: 1.0, lr 0.021, 1206 pseu out of 2416 are correct, 0 correct by model, 0 correct by ema before train, 1258 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001348674733180371, unsupervised loss ratio: 1.0, lr 0.021, 356 pseu out of 486 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2621
************ Loss Avg 0.0014332725407855307, LR 0.03, Round 42 ends ************  

TEST Student: Epoch: 42

TEST AUROC: 0.672821, TEST Accus: 0.207629, TEST Pre: 0.114310, TEST Recall: 0.115252
Comm round 43 meta round 0 chosen client: [11, 16, 9, 6, 13]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0007500875144614838, unsupervised loss ratio: 1.0, lr 0.021, 1663 pseu out of 2156 are correct, 0 correct by model, 0 correct by ema before train, 1863 by model during train, total 4088
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0009120485404712438, unsupervised loss ratio: 1.0, lr 0.021, 303 pseu out of 1668 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0010650921758497134, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 37 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0008668579672382253, unsupervised loss ratio: 1.0, lr 0.021, 1198 pseu out of 2451 are correct, 0 correct by model, 0 correct by ema before train, 1270 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00015942563679684902, unsupervised loss ratio: 1.0, lr 0.021, 1884 pseu out of 2812 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Comm round 43 meta round 1 chosen client: [5, 18, 9, 8, 0]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0008072252776550098, unsupervised loss ratio: 1.0, lr 0.021, 285 pseu out of 1726 are correct, 0 correct by model, 0 correct by ema before train, 300 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0007910937064379039, unsupervised loss ratio: 1.0, lr 0.021, 429 pseu out of 697 are correct, 0 correct by model, 0 correct by ema before train, 552 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0009490926065525316, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 43 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0007599782434795088, unsupervised loss ratio: 1.0, lr 0.021, 2257 pseu out of 2850 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1269984403435065 lr : 0.03
Comm round 43 meta round 2 chosen client: [5, 0, 11, 9, 1]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007890179181007714, unsupervised loss ratio: 1.0, lr 0.021, 288 pseu out of 1880 are correct, 0 correct by model, 0 correct by ema before train, 303 by model during train, total 3866
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1083891817501612 lr : 0.03
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0007529673575845663, unsupervised loss ratio: 1.0, lr 0.021, 1700 pseu out of 2228 are correct, 0 correct by model, 0 correct by ema before train, 1867 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.000882572394739664, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 70 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.000859815412961946, unsupervised loss ratio: 1.0, lr 0.021, 410 pseu out of 582 are correct, 0 correct by model, 0 correct by ema before train, 637 by model during train, total 2621
Comm round 43 meta round 3 chosen client: [7, 12, 6, 14, 19]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0009069837189879484, unsupervised loss ratio: 1.0, lr 0.021, 480 pseu out of 1521 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0007268330939243444, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3554 are correct, 0 correct by model, 0 correct by ema before train, 8 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0008817908195508779, unsupervised loss ratio: 1.0, lr 0.021, 1199 pseu out of 2505 are correct, 0 correct by model, 0 correct by ema before train, 1273 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0011912408111983855, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 27 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0007926851831143722, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3063 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 4949
Comm round 43 meta round 4 chosen client: [11, 0, 18, 14, 13]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0007214818688225932, unsupervised loss ratio: 1.0, lr 0.021, 1714 pseu out of 2310 are correct, 0 correct by model, 0 correct by ema before train, 1864 by model during train, total 4088
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1742954911017904 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0008234796421473018, unsupervised loss ratio: 1.0, lr 0.021, 453 pseu out of 755 are correct, 0 correct by model, 0 correct by ema before train, 553 by model during train, total 2298
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0010422416627548184, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 52 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00014004234592795325, unsupervised loss ratio: 1.0, lr 0.021, 1956 pseu out of 2979 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Comm round 43 meta round 5 chosen client: [10, 9, 0, 3, 7]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0008275806888785405, unsupervised loss ratio: 1.0, lr 0.021, 553 pseu out of 2114 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.000877965453751299, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 88 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.165134027296183 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.000968602122676592, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 1125 are correct, 0 correct by model, 0 correct by ema before train, 28 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008626633475964459, unsupervised loss ratio: 1.0, lr 0.021, 485 pseu out of 1552 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
************ Loss Avg 0.15319753353344337, LR 0.03, Round 43 ends ************  

TEST Student: Epoch: 43

TEST AUROC: 0.742351, TEST Accus: 0.314305, TEST Pre: 0.154934, TEST Recall: 0.256548
Comm round 44 meta round 0 chosen client: [1, 12, 13, 18, 15]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003820812258664973, unsupervised loss ratio: 1.0, lr 0.021, 449 pseu out of 661 are correct, 0 correct by model, 0 correct by ema before train, 638 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.003306460859150522, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3576 are correct, 0 correct by model, 0 correct by ema before train, 10 by model during train, total 5750
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0012232762669169707, unsupervised loss ratio: 1.0, lr 0.021, 1970 pseu out of 3030 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003976229849892358, unsupervised loss ratio: 1.0, lr 0.021, 462 pseu out of 776 are correct, 0 correct by model, 0 correct by ema before train, 553 by model during train, total 2298
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003266482037724927, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1860 are correct, 0 correct by model, 0 correct by ema before train, 54 by model during train, total 4099
Comm round 44 meta round 1 chosen client: [10, 2, 16, 8, 19]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004186996748542477, unsupervised loss ratio: 1.0, lr 0.021, 551 pseu out of 2152 are correct, 0 correct by model, 0 correct by ema before train, 601 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003974804405256042, unsupervised loss ratio: 1.0, lr 0.021, 192 pseu out of 686 are correct, 0 correct by model, 0 correct by ema before train, 254 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004836370263889921, unsupervised loss ratio: 1.0, lr 0.021, 304 pseu out of 1706 are correct, 0 correct by model, 0 correct by ema before train, 324 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0023530762380801207, unsupervised loss ratio: 1.0, lr 0.021, 2256 pseu out of 2846 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.004220013670139731, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3088 are correct, 0 correct by model, 0 correct by ema before train, 22 by model during train, total 4949
Comm round 44 meta round 2 chosen client: [15, 2, 5, 6, 0]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0031580296924892956, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1850 are correct, 0 correct by model, 0 correct by ema before train, 64 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0037213393287467106, unsupervised loss ratio: 1.0, lr 0.021, 205 pseu out of 767 are correct, 0 correct by model, 0 correct by ema before train, 259 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.003919728723408074, unsupervised loss ratio: 1.0, lr 0.021, 288 pseu out of 1842 are correct, 0 correct by model, 0 correct by ema before train, 306 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0035281790659992375, unsupervised loss ratio: 1.0, lr 0.021, 1196 pseu out of 2507 are correct, 0 correct by model, 0 correct by ema before train, 1277 by model during train, total 4383
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0329253515418695 lr : 0.03
Comm round 44 meta round 3 chosen client: [17, 3, 18, 8, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0028733898130855686, unsupervised loss ratio: 1.0, lr 0.021, 1047 pseu out of 3957 are correct, 0 correct by model, 0 correct by ema before train, 1077 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004664872182339812, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 1155 are correct, 0 correct by model, 0 correct by ema before train, 24 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003594337477503965, unsupervised loss ratio: 1.0, lr 0.021, 480 pseu out of 809 are correct, 0 correct by model, 0 correct by ema before train, 558 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002131918627469531, unsupervised loss ratio: 1.0, lr 0.021, 2266 pseu out of 2832 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004382040809656753, unsupervised loss ratio: 1.0, lr 0.021, 308 pseu out of 1710 are correct, 0 correct by model, 0 correct by ema before train, 324 by model during train, total 3883
Comm round 44 meta round 4 chosen client: [17, 8, 11, 15, 18]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002846959004200053, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 3878 are correct, 0 correct by model, 0 correct by ema before train, 1083 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0021057792976080236, unsupervised loss ratio: 1.0, lr 0.021, 2250 pseu out of 2816 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0031628611868654843, unsupervised loss ratio: 1.0, lr 0.021, 1733 pseu out of 2384 are correct, 0 correct by model, 0 correct by ema before train, 1868 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0031319864168136307, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1839 are correct, 0 correct by model, 0 correct by ema before train, 74 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003610324311820376, unsupervised loss ratio: 1.0, lr 0.021, 486 pseu out of 831 are correct, 0 correct by model, 0 correct by ema before train, 559 by model during train, total 2298
Comm round 44 meta round 5 chosen client: [1, 8, 11, 0, 15]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003440163896146526, unsupervised loss ratio: 1.0, lr 0.021, 460 pseu out of 675 are correct, 0 correct by model, 0 correct by ema before train, 640 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002079789239701313, unsupervised loss ratio: 1.0, lr 0.021, 2262 pseu out of 2827 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0029124457123543834, unsupervised loss ratio: 1.0, lr 0.021, 1750 pseu out of 2389 are correct, 0 correct by model, 0 correct by ema before train, 1870 by model during train, total 4088
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.011154932635171 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0030831604462806493, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1829 are correct, 0 correct by model, 0 correct by ema before train, 79 by model during train, total 4099
************ Loss Avg 0.07125307040025959, LR 0.03, Round 44 ends ************  

TEST Student: Epoch: 44

TEST AUROC: 0.723484, TEST Accus: 0.274047, TEST Pre: 0.137693, TEST Recall: 0.202422
Comm round 45 meta round 0 chosen client: [17, 5, 3, 19, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0018036672912388183, unsupervised loss ratio: 1.0, lr 0.021, 1051 pseu out of 3923 are correct, 0 correct by model, 0 correct by ema before train, 1082 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002104607779536488, unsupervised loss ratio: 1.0, lr 0.021, 288 pseu out of 1937 are correct, 0 correct by model, 0 correct by ema before train, 310 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002533391771326673, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1186 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 3526
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0026067096220615963, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3083 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 4949
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0019200475709069344, unsupervised loss ratio: 1.0, lr 0.021, 692 pseu out of 2366 are correct, 0 correct by model, 0 correct by ema before train, 766 by model during train, total 3987
Comm round 45 meta round 1 chosen client: [13, 14, 2, 17, 12]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005510775636293594, unsupervised loss ratio: 1.0, lr 0.021, 1982 pseu out of 3045 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001984084779961091, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 61 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0022085402174741916, unsupervised loss ratio: 1.0, lr 0.021, 207 pseu out of 771 are correct, 0 correct by model, 0 correct by ema before train, 257 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0018356874921016566, unsupervised loss ratio: 1.0, lr 0.021, 1052 pseu out of 3874 are correct, 0 correct by model, 0 correct by ema before train, 1085 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0019935834480242598, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3509 are correct, 0 correct by model, 0 correct by ema before train, 9 by model during train, total 5750
Comm round 45 meta round 2 chosen client: [17, 6, 4, 11, 2]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0018235723375631817, unsupervised loss ratio: 1.0, lr 0.021, 1051 pseu out of 3924 are correct, 0 correct by model, 0 correct by ema before train, 1083 by model during train, total 5558
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00196644107632312, unsupervised loss ratio: 1.0, lr 0.021, 1201 pseu out of 2514 are correct, 0 correct by model, 0 correct by ema before train, 1285 by model during train, total 4383
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00192253583338156, unsupervised loss ratio: 1.0, lr 0.021, 696 pseu out of 2410 are correct, 0 correct by model, 0 correct by ema before train, 761 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0018418194949845201, unsupervised loss ratio: 1.0, lr 0.021, 1762 pseu out of 2389 are correct, 0 correct by model, 0 correct by ema before train, 1896 by model during train, total 4088
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0022470088054736457, unsupervised loss ratio: 1.0, lr 0.021, 215 pseu out of 844 are correct, 0 correct by model, 0 correct by ema before train, 263 by model during train, total 2665
Comm round 45 meta round 3 chosen client: [13, 2, 19, 8, 9]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005788631666692415, unsupervised loss ratio: 1.0, lr 0.021, 2014 pseu out of 3113 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002302316587052441, unsupervised loss ratio: 1.0, lr 0.021, 228 pseu out of 944 are correct, 0 correct by model, 0 correct by ema before train, 266 by model during train, total 2665
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002574159690620712, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3093 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014006548368001859, unsupervised loss ratio: 1.0, lr 0.021, 2265 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0022995012889926634, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 96 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 45 meta round 4 chosen client: [2, 6, 15, 10, 8]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002269874968554913, unsupervised loss ratio: 1.0, lr 0.021, 219 pseu out of 945 are correct, 0 correct by model, 0 correct by ema before train, 270 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0020862558605216877, unsupervised loss ratio: 1.0, lr 0.021, 1209 pseu out of 2588 are correct, 0 correct by model, 0 correct by ema before train, 1294 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0018831478526408318, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1896 are correct, 0 correct by model, 0 correct by ema before train, 89 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0023739968129465805, unsupervised loss ratio: 1.0, lr 0.021, 551 pseu out of 2128 are correct, 0 correct by model, 0 correct by ema before train, 609 by model during train, total 3684
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013642611040154407, unsupervised loss ratio: 1.0, lr 0.021, 2257 pseu out of 2813 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Comm round 45 meta round 5 chosen client: [12, 13, 7, 6, 14]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002044289150702146, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3658 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 5750
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005795463179218409, unsupervised loss ratio: 1.0, lr 0.021, 2051 pseu out of 3175 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0023013498847341486, unsupervised loss ratio: 1.0, lr 0.021, 488 pseu out of 1626 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002037120920157168, unsupervised loss ratio: 1.0, lr 0.021, 1206 pseu out of 2518 are correct, 0 correct by model, 0 correct by ema before train, 1293 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001914540995406269, unsupervised loss ratio: 1.0, lr 0.021, 6 pseu out of 82 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
************ Loss Avg 0.0019117551507241125, LR 0.03, Round 45 ends ************  

TEST Student: Epoch: 45

TEST AUROC: 0.690508, TEST Accus: 0.221958, TEST Pre: 0.127452, TEST Recall: 0.133258
Comm round 46 meta round 0 chosen client: [12, 10, 17, 3, 2]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0009782545132717738, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3675 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 5750
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001287346907513987, unsupervised loss ratio: 1.0, lr 0.021, 548 pseu out of 2219 are correct, 0 correct by model, 0 correct by ema before train, 616 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009626402043277163, unsupervised loss ratio: 1.0, lr 0.021, 1054 pseu out of 3937 are correct, 0 correct by model, 0 correct by ema before train, 1081 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.001318190760814884, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1277 are correct, 0 correct by model, 0 correct by ema before train, 45 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0010976867176525826, unsupervised loss ratio: 1.0, lr 0.021, 228 pseu out of 1035 are correct, 0 correct by model, 0 correct by ema before train, 273 by model during train, total 2665
Comm round 46 meta round 1 chosen client: [7, 8, 3, 5, 12]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0009694507498352323, unsupervised loss ratio: 1.0, lr 0.021, 485 pseu out of 1636 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009502494409048268, unsupervised loss ratio: 1.0, lr 0.021, 2254 pseu out of 2808 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0014180507973183662, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1374 are correct, 0 correct by model, 0 correct by ema before train, 28 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0010664936304893955, unsupervised loss ratio: 1.0, lr 0.021, 286 pseu out of 1962 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0009805375014871566, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3848 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 5750
Comm round 46 meta round 2 chosen client: [16, 2, 8, 15, 11]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0013449759037447635, unsupervised loss ratio: 1.0, lr 0.021, 309 pseu out of 1772 are correct, 0 correct by model, 0 correct by ema before train, 327 by model during train, total 3883
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0010878855800477876, unsupervised loss ratio: 1.0, lr 0.021, 230 pseu out of 1118 are correct, 0 correct by model, 0 correct by ema before train, 274 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009853628342852971, unsupervised loss ratio: 1.0, lr 0.021, 2273 pseu out of 2885 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.001103590670390986, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 1999 are correct, 0 correct by model, 0 correct by ema before train, 96 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0010111123165188474, unsupervised loss ratio: 1.0, lr 0.021, 1770 pseu out of 2436 are correct, 0 correct by model, 0 correct by ema before train, 1887 by model during train, total 4088
Comm round 46 meta round 3 chosen client: [11, 16, 5, 4, 3]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0010486998044143547, unsupervised loss ratio: 1.0, lr 0.021, 1786 pseu out of 2498 are correct, 0 correct by model, 0 correct by ema before train, 1890 by model during train, total 4088
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0014347434492369535, unsupervised loss ratio: 1.0, lr 0.021, 313 pseu out of 1822 are correct, 0 correct by model, 0 correct by ema before train, 326 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0010603494635882376, unsupervised loss ratio: 1.0, lr 0.021, 287 pseu out of 2038 are correct, 0 correct by model, 0 correct by ema before train, 308 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0008785559526470948, unsupervised loss ratio: 1.0, lr 0.021, 693 pseu out of 2482 are correct, 0 correct by model, 0 correct by ema before train, 776 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0014257115215384278, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1444 are correct, 0 correct by model, 0 correct by ema before train, 39 by model during train, total 3526
Comm round 46 meta round 4 chosen client: [3, 4, 14, 2, 5]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013416967244016373, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1531 are correct, 0 correct by model, 0 correct by ema before train, 35 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0009245878923499572, unsupervised loss ratio: 1.0, lr 0.021, 703 pseu out of 2551 are correct, 0 correct by model, 0 correct by ema before train, 788 by model during train, total 3987
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009449269379150461, unsupervised loss ratio: 1.0, lr 0.021, 5 pseu out of 108 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011121630141999396, unsupervised loss ratio: 1.0, lr 0.021, 231 pseu out of 1196 are correct, 0 correct by model, 0 correct by ema before train, 289 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001063177434128297, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2119 are correct, 0 correct by model, 0 correct by ema before train, 311 by model during train, total 3866
Comm round 46 meta round 5 chosen client: [2, 14, 11, 19, 15]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0011320790190005763, unsupervised loss ratio: 1.0, lr 0.021, 236 pseu out of 1280 are correct, 0 correct by model, 0 correct by ema before train, 287 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009604257956556412, unsupervised loss ratio: 1.0, lr 0.021, 7 pseu out of 154 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0011065901217079954, unsupervised loss ratio: 1.0, lr 0.021, 1790 pseu out of 2558 are correct, 0 correct by model, 0 correct by ema before train, 1885 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0012944843666702628, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3190 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 4949
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.001103990244155284, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2067 are correct, 0 correct by model, 0 correct by ema before train, 82 by model during train, total 4099
************ Loss Avg 0.001113133675673777, LR 0.03, Round 46 ends ************  

TEST Student: Epoch: 46

TEST AUROC: 0.678709, TEST Accus: 0.208513, TEST Pre: 0.125061, TEST Recall: 0.116315
Comm round 47 meta round 0 chosen client: [1, 3, 18, 12, 14]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0008762974629928245, unsupervised loss ratio: 1.0, lr 0.021, 477 pseu out of 732 are correct, 0 correct by model, 0 correct by ema before train, 644 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.001009013419531714, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1603 are correct, 0 correct by model, 0 correct by ema before train, 39 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0009392055960941232, unsupervised loss ratio: 1.0, lr 0.021, 476 pseu out of 838 are correct, 0 correct by model, 0 correct by ema before train, 566 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0007336497067525569, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3954 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 5750
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008112571544409024, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 210 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Comm round 47 meta round 1 chosen client: [1, 7, 10, 4, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0007949750174813699, unsupervised loss ratio: 1.0, lr 0.021, 502 pseu out of 823 are correct, 0 correct by model, 0 correct by ema before train, 645 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.000856038992843913, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 1764 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0009755940605075387, unsupervised loss ratio: 1.0, lr 0.021, 555 pseu out of 2265 are correct, 0 correct by model, 0 correct by ema before train, 614 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006928232328463641, unsupervised loss ratio: 1.0, lr 0.021, 705 pseu out of 2609 are correct, 0 correct by model, 0 correct by ema before train, 780 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0007999858512665101, unsupervised loss ratio: 1.0, lr 0.021, 237 pseu out of 1362 are correct, 0 correct by model, 0 correct by ema before train, 289 by model during train, total 2665
Comm round 47 meta round 2 chosen client: [8, 12, 19, 1, 7]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008824274442531532, unsupervised loss ratio: 1.0, lr 0.021, 2270 pseu out of 2891 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0006915128838348513, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4129 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0009598755816860388, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3225 are correct, 0 correct by model, 0 correct by ema before train, 26 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0007809968608454233, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 909 are correct, 0 correct by model, 0 correct by ema before train, 644 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0008212636340221462, unsupervised loss ratio: 1.0, lr 0.021, 489 pseu out of 1790 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Comm round 47 meta round 3 chosen client: [3, 2, 6, 17, 8]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0010540116402678126, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1710 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0008116175567487343, unsupervised loss ratio: 1.0, lr 0.021, 238 pseu out of 1380 are correct, 0 correct by model, 0 correct by ema before train, 282 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0009656061107913653, unsupervised loss ratio: 1.0, lr 0.021, 1208 pseu out of 2578 are correct, 0 correct by model, 0 correct by ema before train, 1295 by model during train, total 4383
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0007955928198623888, unsupervised loss ratio: 1.0, lr 0.021, 1054 pseu out of 4044 are correct, 0 correct by model, 0 correct by ema before train, 1080 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008805721529938637, unsupervised loss ratio: 1.0, lr 0.021, 2284 pseu out of 2942 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Comm round 47 meta round 4 chosen client: [15, 12, 5, 1, 0]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0008956513280001953, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2210 are correct, 0 correct by model, 0 correct by ema before train, 74 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0007050937154821844, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4265 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0007826407706235215, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2185 are correct, 0 correct by model, 0 correct by ema before train, 310 by model during train, total 3866
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0008133108118583062, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 980 are correct, 0 correct by model, 0 correct by ema before train, 648 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.1234264361615083 lr : 0.03
Comm round 47 meta round 5 chosen client: [4, 9, 7, 15, 19]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0006908934641008576, unsupervised loss ratio: 1.0, lr 0.021, 701 pseu out of 2676 are correct, 0 correct by model, 0 correct by ema before train, 773 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0008523761902728842, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 138 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0007759412062743929, unsupervised loss ratio: 1.0, lr 0.021, 490 pseu out of 1878 are correct, 0 correct by model, 0 correct by ema before train, 497 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0008465221904246462, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2304 are correct, 0 correct by model, 0 correct by ema before train, 75 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0009095475311952237, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3362 are correct, 0 correct by model, 0 correct by ema before train, 25 by model during train, total 4949
************ Loss Avg 0.03826102435166013, LR 0.03, Round 47 ends ************  

TEST Student: Epoch: 47

TEST AUROC: 0.690494, TEST Accus: 0.215389, TEST Pre: 0.135499, TEST Recall: 0.124730
Comm round 48 meta round 0 chosen client: [10, 5, 3, 15, 16]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0011664779599884461, unsupervised loss ratio: 1.0, lr 0.021, 554 pseu out of 2291 are correct, 0 correct by model, 0 correct by ema before train, 617 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.000986084617296478, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 2260 are correct, 0 correct by model, 0 correct by ema before train, 305 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0012370679799330122, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1761 are correct, 0 correct by model, 0 correct by ema before train, 43 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0010204427575025384, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2443 are correct, 0 correct by model, 0 correct by ema before train, 61 by model during train, total 4099
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0013028479784299605, unsupervised loss ratio: 1.0, lr 0.021, 311 pseu out of 1936 are correct, 0 correct by model, 0 correct by ema before train, 331 by model during train, total 3883
Comm round 48 meta round 1 chosen client: [16, 15, 14, 0, 8]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0012335662069715193, unsupervised loss ratio: 1.0, lr 0.021, 313 pseu out of 2014 are correct, 0 correct by model, 0 correct by ema before train, 329 by model during train, total 3883
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0009362213872708918, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2473 are correct, 0 correct by model, 0 correct by ema before train, 74 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008271407956878344, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 259 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0634308007298683 lr : 0.03
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.00082085136131127, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 2976 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Comm round 48 meta round 2 chosen client: [14, 13, 10, 2, 11]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0007994772150237677, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 333 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002020039047870264, unsupervised loss ratio: 1.0, lr 0.021, 2056 pseu out of 3245 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001097438851439651, unsupervised loss ratio: 1.0, lr 0.021, 559 pseu out of 2335 are correct, 0 correct by model, 0 correct by ema before train, 606 by model during train, total 3684
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0009987399112322323, unsupervised loss ratio: 1.0, lr 0.021, 242 pseu out of 1460 are correct, 0 correct by model, 0 correct by ema before train, 289 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0009823671489357366, unsupervised loss ratio: 1.0, lr 0.021, 1793 pseu out of 2587 are correct, 0 correct by model, 0 correct by ema before train, 1894 by model during train, total 4088
Comm round 48 meta round 3 chosen client: [3, 15, 2, 1, 19]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013045884841501123, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1898 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0009364551844328161, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2545 are correct, 0 correct by model, 0 correct by ema before train, 62 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0010081937112512865, unsupervised loss ratio: 1.0, lr 0.021, 241 pseu out of 1491 are correct, 0 correct by model, 0 correct by ema before train, 296 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0009034582890751885, unsupervised loss ratio: 1.0, lr 0.021, 572 pseu out of 1038 are correct, 0 correct by model, 0 correct by ema before train, 652 by model during train, total 2621
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0011874716100208342, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3437 are correct, 0 correct by model, 0 correct by ema before train, 27 by model during train, total 4949
Comm round 48 meta round 4 chosen client: [11, 19, 8, 18, 1]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0009722781933305669, unsupervised loss ratio: 1.0, lr 0.021, 1809 pseu out of 2635 are correct, 0 correct by model, 0 correct by ema before train, 1891 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001103308777927827, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3504 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008487408122164197, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3034 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0009431153529375377, unsupervised loss ratio: 1.0, lr 0.021, 497 pseu out of 896 are correct, 0 correct by model, 0 correct by ema before train, 560 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0008954201596391546, unsupervised loss ratio: 1.0, lr 0.021, 574 pseu out of 1111 are correct, 0 correct by model, 0 correct by ema before train, 649 by model during train, total 2621
Comm round 48 meta round 5 chosen client: [8, 16, 5, 4, 2]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008068132915468595, unsupervised loss ratio: 1.0, lr 0.021, 2296 pseu out of 3015 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0012694789978415996, unsupervised loss ratio: 1.0, lr 0.021, 312 pseu out of 2062 are correct, 0 correct by model, 0 correct by ema before train, 329 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0009697320480777531, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2379 are correct, 0 correct by model, 0 correct by ema before train, 301 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0008770273360867231, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2760 are correct, 0 correct by model, 0 correct by ema before train, 771 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0010250744526274502, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 1542 are correct, 0 correct by model, 0 correct by ema before train, 290 by model during train, total 2665
************ Loss Avg 0.0364030895168947, LR 0.03, Round 48 ends ************  

TEST Student: Epoch: 48

TEST AUROC: 0.694801, TEST Accus: 0.218539, TEST Pre: 0.141461, TEST Recall: 0.129012
Comm round 49 meta round 0 chosen client: [19, 3, 8, 18, 15]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0012362146436106951, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3555 are correct, 0 correct by model, 0 correct by ema before train, 28 by model during train, total 4949
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013933820281246362, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1931 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008590050135808269, unsupervised loss ratio: 1.0, lr 0.021, 2300 pseu out of 3062 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.001027266279884821, unsupervised loss ratio: 1.0, lr 0.021, 505 pseu out of 951 are correct, 0 correct by model, 0 correct by ema before train, 558 by model during train, total 2298
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0011149579817496347, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2673 are correct, 0 correct by model, 0 correct by ema before train, 71 by model during train, total 4099
Comm round 49 meta round 1 chosen client: [8, 14, 3, 18, 11]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0008580627338972135, unsupervised loss ratio: 1.0, lr 0.021, 2308 pseu out of 3064 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008324304115817403, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 365 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.001353761549320812, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 1971 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00102607703269718, unsupervised loss ratio: 1.0, lr 0.021, 511 pseu out of 992 are correct, 0 correct by model, 0 correct by ema before train, 564 by model during train, total 2298
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001037539425851719, unsupervised loss ratio: 1.0, lr 0.021, 1807 pseu out of 2642 are correct, 0 correct by model, 0 correct by ema before train, 1891 by model during train, total 4088
Comm round 49 meta round 2 chosen client: [17, 1, 13, 18, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009633558722020224, unsupervised loss ratio: 1.0, lr 0.021, 1052 pseu out of 4108 are correct, 0 correct by model, 0 correct by ema before train, 1082 by model during train, total 5558
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0010049239513691423, unsupervised loss ratio: 1.0, lr 0.021, 583 pseu out of 1183 are correct, 0 correct by model, 0 correct by ema before train, 653 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00023966361192633178, unsupervised loss ratio: 1.0, lr 0.021, 2088 pseu out of 3310 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0010118755825614142, unsupervised loss ratio: 1.0, lr 0.021, 515 pseu out of 1008 are correct, 0 correct by model, 0 correct by ema before train, 566 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0009665057108837313, unsupervised loss ratio: 1.0, lr 0.021, 706 pseu out of 2796 are correct, 0 correct by model, 0 correct by ema before train, 774 by model during train, total 3987
Comm round 49 meta round 3 chosen client: [7, 1, 14, 10, 18]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0010762326995833204, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 1912 are correct, 0 correct by model, 0 correct by ema before train, 498 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.000975365777465901, unsupervised loss ratio: 1.0, lr 0.021, 601 pseu out of 1209 are correct, 0 correct by model, 0 correct by ema before train, 654 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0007912917600620086, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 420 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0012914246020453244, unsupervised loss ratio: 1.0, lr 0.021, 560 pseu out of 2383 are correct, 0 correct by model, 0 correct by ema before train, 617 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0010435680758544346, unsupervised loss ratio: 1.0, lr 0.021, 518 pseu out of 1061 are correct, 0 correct by model, 0 correct by ema before train, 570 by model during train, total 2298
Comm round 49 meta round 4 chosen client: [18, 3, 12, 4, 6]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0010655944837102045, unsupervised loss ratio: 1.0, lr 0.021, 524 pseu out of 1072 are correct, 0 correct by model, 0 correct by ema before train, 567 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0013895733493752363, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 2063 are correct, 0 correct by model, 0 correct by ema before train, 49 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0010058747446035137, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4362 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0009212681884130848, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2876 are correct, 0 correct by model, 0 correct by ema before train, 767 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0011587981839050146, unsupervised loss ratio: 1.0, lr 0.021, 1216 pseu out of 2678 are correct, 0 correct by model, 0 correct by ema before train, 1289 by model during train, total 4383
Comm round 49 meta round 5 chosen client: [7, 0, 18, 16, 1]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0010509806393551675, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 1971 are correct, 0 correct by model, 0 correct by ema before train, 496 by model during train, total 3280
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0539534456875859 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0010553387546679005, unsupervised loss ratio: 1.0, lr 0.021, 523 pseu out of 1134 are correct, 0 correct by model, 0 correct by ema before train, 567 by model during train, total 2298
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0014453961883221188, unsupervised loss ratio: 1.0, lr 0.021, 315 pseu out of 2166 are correct, 0 correct by model, 0 correct by ema before train, 327 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0009659459309016423, unsupervised loss ratio: 1.0, lr 0.021, 605 pseu out of 1301 are correct, 0 correct by model, 0 correct by ema before train, 656 by model during train, total 2621
************ Loss Avg 0.036137170696503094, LR 0.03, Round 49 ends ************  

TEST Student: Epoch: 49

TEST AUROC: 0.700863, TEST Accus: 0.222073, TEST Pre: 0.144102, TEST Recall: 0.133813
Comm round 50 meta round 0 chosen client: [15, 16, 0, 13, 6]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0012351222384985215, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2704 are correct, 0 correct by model, 0 correct by ema before train, 60 by model during train, total 4099
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0015336806193131526, unsupervised loss ratio: 1.0, lr 0.021, 317 pseu out of 2222 are correct, 0 correct by model, 0 correct by ema before train, 335 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.966861370874911 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00028730609335332824, unsupervised loss ratio: 1.0, lr 0.021, 2099 pseu out of 3350 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0011885844983423697, unsupervised loss ratio: 1.0, lr 0.021, 1212 pseu out of 2729 are correct, 0 correct by model, 0 correct by ema before train, 1286 by model during train, total 4383
Comm round 50 meta round 1 chosen client: [2, 10, 14, 1, 3]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0012433676830759005, unsupervised loss ratio: 1.0, lr 0.021, 247 pseu out of 1562 are correct, 0 correct by model, 0 correct by ema before train, 282 by model during train, total 2665
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0013258093536494236, unsupervised loss ratio: 1.0, lr 0.021, 563 pseu out of 2373 are correct, 0 correct by model, 0 correct by ema before train, 620 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009209342463167779, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 468 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 2083
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0011100306306261478, unsupervised loss ratio: 1.0, lr 0.021, 609 pseu out of 1336 are correct, 0 correct by model, 0 correct by ema before train, 652 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.001495443033880812, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 2069 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 3526
Comm round 50 meta round 2 chosen client: [12, 4, 10, 5, 7]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001088999387057912, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4532 are correct, 0 correct by model, 0 correct by ema before train, 12 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001073648596444862, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2900 are correct, 0 correct by model, 0 correct by ema before train, 772 by model during train, total 3987
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0014149175765161435, unsupervised loss ratio: 1.0, lr 0.021, 561 pseu out of 2463 are correct, 0 correct by model, 0 correct by ema before train, 622 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001168317084208314, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2422 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0011415551794366015, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2011 are correct, 0 correct by model, 0 correct by ema before train, 498 by model during train, total 3280
Comm round 50 meta round 3 chosen client: [10, 5, 16, 19, 9]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0013398088581041143, unsupervised loss ratio: 1.0, lr 0.021, 559 pseu out of 2507 are correct, 0 correct by model, 0 correct by ema before train, 614 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0012034846879599127, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2483 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0015131437666256165, unsupervised loss ratio: 1.0, lr 0.021, 316 pseu out of 2249 are correct, 0 correct by model, 0 correct by ema before train, 334 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0013551913617471328, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3635 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0009845186982096897, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 164 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Comm round 50 meta round 4 chosen client: [17, 10, 18, 13, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010388577925630085, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4204 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0013414825451287344, unsupervised loss ratio: 1.0, lr 0.021, 562 pseu out of 2484 are correct, 0 correct by model, 0 correct by ema before train, 616 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00114204879436228, unsupervised loss ratio: 1.0, lr 0.021, 529 pseu out of 1149 are correct, 0 correct by model, 0 correct by ema before train, 571 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003053399882677911, unsupervised loss ratio: 1.0, lr 0.021, 2113 pseu out of 3389 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.001572927928598384, unsupervised loss ratio: 1.0, lr 0.021, 315 pseu out of 2295 are correct, 0 correct by model, 0 correct by ema before train, 332 by model during train, total 3883
Comm round 50 meta round 5 chosen client: [17, 18, 3, 8, 0]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010017137017754045, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4290 are correct, 0 correct by model, 0 correct by ema before train, 1071 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0011529694359827165, unsupervised loss ratio: 1.0, lr 0.021, 523 pseu out of 1170 are correct, 0 correct by model, 0 correct by ema before train, 569 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0014882667359026008, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 2074 are correct, 0 correct by model, 0 correct by ema before train, 45 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009104674576576599, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3111 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.042139814824474 lr : 0.03
************ Loss Avg 0.06805263745576635, LR 0.03, Round 50 ends ************  

TEST Student: Epoch: 50

TEST AUROC: 0.714369, TEST Accus: 0.248118, TEST Pre: 0.148951, TEST Recall: 0.169371
Comm round 51 meta round 0 chosen client: [13, 14, 4, 16, 10]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000457008706674106, unsupervised loss ratio: 1.0, lr 0.021, 2139 pseu out of 3439 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015176038617606866, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 541 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016416826838394627, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2940 are correct, 0 correct by model, 0 correct by ema before train, 772 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002291269904788828, unsupervised loss ratio: 1.0, lr 0.021, 315 pseu out of 2335 are correct, 0 correct by model, 0 correct by ema before train, 335 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0019375769198663405, unsupervised loss ratio: 1.0, lr 0.021, 567 pseu out of 2493 are correct, 0 correct by model, 0 correct by ema before train, 614 by model during train, total 3684
Comm round 51 meta round 1 chosen client: [10, 12, 17, 9, 11]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0018828026388354342, unsupervised loss ratio: 1.0, lr 0.021, 566 pseu out of 2481 are correct, 0 correct by model, 0 correct by ema before train, 623 by model during train, total 3684
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0015997322732194637, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4557 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014067767616147283, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4316 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001687586087630027, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 206 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015551018450423726, unsupervised loss ratio: 1.0, lr 0.021, 1804 pseu out of 2700 are correct, 0 correct by model, 0 correct by ema before train, 1902 by model during train, total 4088
Comm round 51 meta round 2 chosen client: [16, 1, 10, 0, 18]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0022300139191697857, unsupervised loss ratio: 1.0, lr 0.021, 319 pseu out of 2327 are correct, 0 correct by model, 0 correct by ema before train, 338 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001780636353054788, unsupervised loss ratio: 1.0, lr 0.021, 606 pseu out of 1336 are correct, 0 correct by model, 0 correct by ema before train, 653 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001930400021655228, unsupervised loss ratio: 1.0, lr 0.021, 563 pseu out of 2483 are correct, 0 correct by model, 0 correct by ema before train, 621 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0508620945774778 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0018393747935382028, unsupervised loss ratio: 1.0, lr 0.021, 526 pseu out of 1164 are correct, 0 correct by model, 0 correct by ema before train, 567 by model during train, total 2298
Comm round 51 meta round 3 chosen client: [6, 17, 8, 0, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0017034901981748155, unsupervised loss ratio: 1.0, lr 0.021, 1217 pseu out of 2793 are correct, 0 correct by model, 0 correct by ema before train, 1299 by model during train, total 4383
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014066647975063272, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4311 are correct, 0 correct by model, 0 correct by ema before train, 1076 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012459834006222081, unsupervised loss ratio: 1.0, lr 0.021, 2310 pseu out of 3089 are correct, 0 correct by model, 0 correct by ema before train, 2346 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0375230652945382 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016376815089772987, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2956 are correct, 0 correct by model, 0 correct by ema before train, 779 by model during train, total 3987
Comm round 51 meta round 4 chosen client: [10, 4, 16, 19, 8]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001965504079446967, unsupervised loss ratio: 1.0, lr 0.021, 559 pseu out of 2519 are correct, 0 correct by model, 0 correct by ema before train, 626 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0015967310233492523, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2930 are correct, 0 correct by model, 0 correct by ema before train, 765 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002221502892321861, unsupervised loss ratio: 1.0, lr 0.021, 318 pseu out of 2316 are correct, 0 correct by model, 0 correct by ema before train, 345 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0020258398969114446, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3675 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011769920046731386, unsupervised loss ratio: 1.0, lr 0.021, 2307 pseu out of 3102 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Comm round 51 meta round 5 chosen client: [18, 7, 2, 5, 3]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0018149274627729836, unsupervised loss ratio: 1.0, lr 0.021, 527 pseu out of 1195 are correct, 0 correct by model, 0 correct by ema before train, 573 by model during train, total 2298
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0018462313382769935, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2081 are correct, 0 correct by model, 0 correct by ema before train, 497 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0019850230157663603, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 1579 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0018467354968945938, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 2586 are correct, 0 correct by model, 0 correct by ema before train, 311 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0023469157908298905, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 2122 are correct, 0 correct by model, 0 correct by ema before train, 43 by model during train, total 3526
************ Loss Avg 0.07123209831830764, LR 0.03, Round 51 ends ************  

TEST Student: Epoch: 51

TEST AUROC: 0.714850, TEST Accus: 0.251114, TEST Pre: 0.140050, TEST Recall: 0.172143
Comm round 52 meta round 0 chosen client: [0, 4, 9, 8, 14]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9989408388429758 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016259000489270196, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2926 are correct, 0 correct by model, 0 correct by ema before train, 776 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0015725524679981863, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 227 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011665535137126426, unsupervised loss ratio: 1.0, lr 0.021, 2312 pseu out of 3139 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014117044382587526, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 576 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 2083
Comm round 52 meta round 1 chosen client: [9, 4, 13, 17, 15]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0016151279355485545, unsupervised loss ratio: 1.0, lr 0.021, 28 pseu out of 260 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001589200860868755, unsupervised loss ratio: 1.0, lr 0.021, 713 pseu out of 2958 are correct, 0 correct by model, 0 correct by ema before train, 778 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004329124928779616, unsupervised loss ratio: 1.0, lr 0.021, 2118 pseu out of 3434 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014254281815173555, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4339 are correct, 0 correct by model, 0 correct by ema before train, 1073 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017184678781352256, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2721 are correct, 0 correct by model, 0 correct by ema before train, 59 by model during train, total 4099
Comm round 52 meta round 2 chosen client: [19, 14, 0, 8, 4]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0020518327043809667, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3637 are correct, 0 correct by model, 0 correct by ema before train, 47 by model during train, total 4949
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014915418842892077, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 656 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9814192895986595 lr : 0.03
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012186701385701326, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3129 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016291748403408934, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 3025 are correct, 0 correct by model, 0 correct by ema before train, 783 by model during train, total 3987
Comm round 52 meta round 3 chosen client: [9, 3, 0, 15, 17]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0016259250966228407, unsupervised loss ratio: 1.0, lr 0.021, 29 pseu out of 299 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002368401136014394, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 2161 are correct, 0 correct by model, 0 correct by ema before train, 56 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9909314063130593 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0016288308541194195, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2727 are correct, 0 correct by model, 0 correct by ema before train, 69 by model during train, total 4099
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0013895075217601255, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4390 are correct, 0 correct by model, 0 correct by ema before train, 1079 by model during train, total 5558
Comm round 52 meta round 4 chosen client: [1, 14, 2, 15, 18]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0019131465190340105, unsupervised loss ratio: 1.0, lr 0.021, 617 pseu out of 1422 are correct, 0 correct by model, 0 correct by ema before train, 662 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00148371523810607, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 695 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0020081964612472802, unsupervised loss ratio: 1.0, lr 0.021, 244 pseu out of 1624 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017575566788694303, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2763 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.001807375537787771, unsupervised loss ratio: 1.0, lr 0.021, 529 pseu out of 1223 are correct, 0 correct by model, 0 correct by ema before train, 572 by model during train, total 2298
Comm round 52 meta round 5 chosen client: [13, 11, 14, 2, 15]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004611663398001406, unsupervised loss ratio: 1.0, lr 0.021, 2127 pseu out of 3462 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001641551311877265, unsupervised loss ratio: 1.0, lr 0.021, 1801 pseu out of 2670 are correct, 0 correct by model, 0 correct by ema before train, 1898 by model during train, total 4088
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00152207227250928, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 753 are correct, 0 correct by model, 0 correct by ema before train, 18 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0019384855141175823, unsupervised loss ratio: 1.0, lr 0.021, 249 pseu out of 1622 are correct, 0 correct by model, 0 correct by ema before train, 303 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.001730870053590759, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2817 are correct, 0 correct by model, 0 correct by ema before train, 67 by model during train, total 4099
************ Loss Avg 0.10045058008918589, LR 0.03, Round 52 ends ************  

TEST Student: Epoch: 52

TEST AUROC: 0.743739, TEST Accus: 0.293946, TEST Pre: 0.166925, TEST Recall: 0.232210
Comm round 53 meta round 0 chosen client: [3, 11, 13, 14, 12]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004035377049928813, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 2174 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 3526
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0026818029964488233, unsupervised loss ratio: 1.0, lr 0.021, 1814 pseu out of 2717 are correct, 0 correct by model, 0 correct by ema before train, 1906 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0007869608343136892, unsupervised loss ratio: 1.0, lr 0.021, 2136 pseu out of 3465 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0028889015824957328, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 779 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0025354447984783394, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4541 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 5750
Comm round 53 meta round 1 chosen client: [10, 16, 4, 7, 5]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00338496741686209, unsupervised loss ratio: 1.0, lr 0.021, 564 pseu out of 2463 are correct, 0 correct by model, 0 correct by ema before train, 628 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003954113585126326, unsupervised loss ratio: 1.0, lr 0.021, 316 pseu out of 2340 are correct, 0 correct by model, 0 correct by ema before train, 348 by model during train, total 3883
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0026462659251780085, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2956 are correct, 0 correct by model, 0 correct by ema before train, 788 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0030015888198529584, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2055 are correct, 0 correct by model, 0 correct by ema before train, 499 by model during train, total 3280
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0030432265532416764, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2543 are correct, 0 correct by model, 0 correct by ema before train, 304 by model during train, total 3866
Comm round 53 meta round 2 chosen client: [12, 18, 0, 1, 3]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002496772725135088, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4548 are correct, 0 correct by model, 0 correct by ema before train, 9 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0031284292053896934, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1241 are correct, 0 correct by model, 0 correct by ema before train, 566 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9344384208017465 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003219483423092198, unsupervised loss ratio: 1.0, lr 0.021, 613 pseu out of 1426 are correct, 0 correct by model, 0 correct by ema before train, 668 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0037898440017930363, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 2113 are correct, 0 correct by model, 0 correct by ema before train, 55 by model during train, total 3526
Comm round 53 meta round 3 chosen client: [13, 12, 15, 19, 4]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0007562119675547642, unsupervised loss ratio: 1.0, lr 0.021, 2124 pseu out of 3458 are correct, 0 correct by model, 0 correct by ema before train, 2195 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002518608061493271, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4533 are correct, 0 correct by model, 0 correct by ema before train, 11 by model during train, total 5750
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0028379178656905424, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2840 are correct, 0 correct by model, 0 correct by ema before train, 65 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003357353173972418, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3612 are correct, 0 correct by model, 0 correct by ema before train, 49 by model during train, total 4949
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0025732056207729446, unsupervised loss ratio: 1.0, lr 0.021, 708 pseu out of 2952 are correct, 0 correct by model, 0 correct by ema before train, 787 by model during train, total 3987
Comm round 53 meta round 4 chosen client: [10, 4, 3, 12, 19]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0031581571454118037, unsupervised loss ratio: 1.0, lr 0.021, 558 pseu out of 2461 are correct, 0 correct by model, 0 correct by ema before train, 650 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0026520612522117084, unsupervised loss ratio: 1.0, lr 0.021, 713 pseu out of 2950 are correct, 0 correct by model, 0 correct by ema before train, 783 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003774291569633143, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 2098 are correct, 0 correct by model, 0 correct by ema before train, 74 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0025425010807036113, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4556 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003234342329401093, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 3584 are correct, 0 correct by model, 0 correct by ema before train, 57 by model during train, total 4949
Comm round 53 meta round 5 chosen client: [17, 8, 14, 4, 13]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0022435740078665615, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4312 are correct, 0 correct by model, 0 correct by ema before train, 1077 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0018758598571437801, unsupervised loss ratio: 1.0, lr 0.021, 2305 pseu out of 3104 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0026733209943455277, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 806 are correct, 0 correct by model, 0 correct by ema before train, 24 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002587316578091492, unsupervised loss ratio: 1.0, lr 0.021, 706 pseu out of 2918 are correct, 0 correct by model, 0 correct by ema before train, 805 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0007441851573846287, unsupervised loss ratio: 1.0, lr 0.021, 2136 pseu out of 3452 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
************ Loss Avg 0.033785350212692, LR 0.03, Round 53 ends ************  

TEST Student: Epoch: 53

TEST AUROC: 0.707701, TEST Accus: 0.243508, TEST Pre: 0.139900, TEST Recall: 0.161184
Comm round 54 meta round 0 chosen client: [0, 3, 5, 11, 19]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.005219318428818 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0018277030836283562, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 2108 are correct, 0 correct by model, 0 correct by ema before train, 65 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013414100735719301, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 2556 are correct, 0 correct by model, 0 correct by ema before train, 309 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0014838085417068214, unsupervised loss ratio: 1.0, lr 0.021, 1804 pseu out of 2687 are correct, 0 correct by model, 0 correct by ema before train, 1923 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001598503677926671, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 77 by model during train, total 4949
Comm round 54 meta round 1 chosen client: [18, 12, 2, 17, 7]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.001452567246613196, unsupervised loss ratio: 1.0, lr 0.021, 527 pseu out of 1212 are correct, 0 correct by model, 0 correct by ema before train, 577 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0011519462533114064, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4563 are correct, 0 correct by model, 0 correct by ema before train, 14 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0017547212898664708, unsupervised loss ratio: 1.0, lr 0.021, 247 pseu out of 1634 are correct, 0 correct by model, 0 correct by ema before train, 315 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010844273830565956, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4396 are correct, 0 correct by model, 0 correct by ema before train, 1081 by model during train, total 5558
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0012637078062443135, unsupervised loss ratio: 1.0, lr 0.021, 496 pseu out of 2054 are correct, 0 correct by model, 0 correct by ema before train, 500 by model during train, total 3280
Comm round 54 meta round 2 chosen client: [3, 14, 12, 15, 13]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.001966894287241822, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 2136 are correct, 0 correct by model, 0 correct by ema before train, 73 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0010874165984039957, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 826 are correct, 0 correct by model, 0 correct by ema before train, 23 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0012069122726744454, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4648 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 5750
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0014039562294783537, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2841 are correct, 0 correct by model, 0 correct by ema before train, 69 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00029496843397560117, unsupervised loss ratio: 1.0, lr 0.021, 2130 pseu out of 3481 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Comm round 54 meta round 3 chosen client: [5, 6, 4, 2, 7]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013999527427138853, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2591 are correct, 0 correct by model, 0 correct by ema before train, 309 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00141556534420132, unsupervised loss ratio: 1.0, lr 0.021, 1216 pseu out of 2811 are correct, 0 correct by model, 0 correct by ema before train, 1295 by model during train, total 4383
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0013151953859801685, unsupervised loss ratio: 1.0, lr 0.021, 713 pseu out of 2930 are correct, 0 correct by model, 0 correct by ema before train, 813 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00170713410867999, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 1659 are correct, 0 correct by model, 0 correct by ema before train, 306 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0013367481867764862, unsupervised loss ratio: 1.0, lr 0.021, 490 pseu out of 2116 are correct, 0 correct by model, 0 correct by ema before train, 504 by model during train, total 3280
Comm round 54 meta round 4 chosen client: [1, 13, 12, 2, 7]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0014592048147034535, unsupervised loss ratio: 1.0, lr 0.021, 617 pseu out of 1435 are correct, 0 correct by model, 0 correct by ema before train, 666 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002817413786310758, unsupervised loss ratio: 1.0, lr 0.021, 2140 pseu out of 3501 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001201333540181319, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4731 are correct, 0 correct by model, 0 correct by ema before train, 14 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0017045954383710133, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1683 are correct, 0 correct by model, 0 correct by ema before train, 322 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001332504488975526, unsupervised loss ratio: 1.0, lr 0.021, 490 pseu out of 2132 are correct, 0 correct by model, 0 correct by ema before train, 502 by model during train, total 3280
Comm round 54 meta round 5 chosen client: [17, 15, 5, 9, 8]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0011159614295211632, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4398 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0014346572565465557, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2897 are correct, 0 correct by model, 0 correct by ema before train, 65 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0014443656078493986, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2676 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3866
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014082635548052, unsupervised loss ratio: 1.0, lr 0.021, 33 pseu out of 336 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0010128584265984841, unsupervised loss ratio: 1.0, lr 0.021, 2311 pseu out of 3118 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
************ Loss Avg 0.03479027811036846, LR 0.03, Round 54 ends ************  

TEST Student: Epoch: 54

TEST AUROC: 0.699840, TEST Accus: 0.233904, TEST Pre: 0.137008, TEST Recall: 0.147859
Comm round 55 meta round 0 chosen client: [2, 0, 10, 19, 16]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0014456440140271471, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 1689 are correct, 0 correct by model, 0 correct by ema before train, 321 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.006793245977285 lr : 0.03
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0014944799467198678, unsupervised loss ratio: 1.0, lr 0.021, 563 pseu out of 2498 are correct, 0 correct by model, 0 correct by ema before train, 646 by model during train, total 3684
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0014108695580104652, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 3632 are correct, 0 correct by model, 0 correct by ema before train, 81 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0016390834457897505, unsupervised loss ratio: 1.0, lr 0.021, 318 pseu out of 2323 are correct, 0 correct by model, 0 correct by ema before train, 356 by model during train, total 3883
Comm round 55 meta round 1 chosen client: [4, 9, 19, 18, 5]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0011316961377844333, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2996 are correct, 0 correct by model, 0 correct by ema before train, 794 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0011286304512328502, unsupervised loss ratio: 1.0, lr 0.021, 34 pseu out of 382 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0013118460641029135, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 3716 are correct, 0 correct by model, 0 correct by ema before train, 85 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0012638234054773217, unsupervised loss ratio: 1.0, lr 0.021, 529 pseu out of 1245 are correct, 0 correct by model, 0 correct by ema before train, 584 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0011000168127137558, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2692 are correct, 0 correct by model, 0 correct by ema before train, 312 by model during train, total 3866
Comm round 55 meta round 2 chosen client: [1, 2, 13, 0, 19]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0012851080348965053, unsupervised loss ratio: 1.0, lr 0.021, 618 pseu out of 1467 are correct, 0 correct by model, 0 correct by ema before train, 680 by model during train, total 2621
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0015247927221935242, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 1750 are correct, 0 correct by model, 0 correct by ema before train, 315 by model during train, total 2665
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00022948490676738447, unsupervised loss ratio: 1.0, lr 0.021, 2140 pseu out of 3509 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9910911783880118 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001353739343474631, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 3751 are correct, 0 correct by model, 0 correct by ema before train, 89 by model during train, total 4949
Comm round 55 meta round 3 chosen client: [3, 14, 1, 10, 15]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0015929524513142365, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 2212 are correct, 0 correct by model, 0 correct by ema before train, 71 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008638486024486183, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 900 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 2083
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0013294542611508471, unsupervised loss ratio: 1.0, lr 0.021, 618 pseu out of 1506 are correct, 0 correct by model, 0 correct by ema before train, 669 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0015267933375635665, unsupervised loss ratio: 1.0, lr 0.021, 566 pseu out of 2499 are correct, 0 correct by model, 0 correct by ema before train, 651 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0011893443797816872, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2910 are correct, 0 correct by model, 0 correct by ema before train, 75 by model during train, total 4099
Comm round 55 meta round 4 chosen client: [6, 16, 7, 2, 14]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0011638172605223415, unsupervised loss ratio: 1.0, lr 0.021, 1219 pseu out of 2830 are correct, 0 correct by model, 0 correct by ema before train, 1290 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0017625853718930215, unsupervised loss ratio: 1.0, lr 0.021, 319 pseu out of 2367 are correct, 0 correct by model, 0 correct by ema before train, 358 by model during train, total 3883
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0010438968895939, unsupervised loss ratio: 1.0, lr 0.021, 489 pseu out of 2145 are correct, 0 correct by model, 0 correct by ema before train, 501 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001468864665921068, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1747 are correct, 0 correct by model, 0 correct by ema before train, 312 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008890384377798799, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 932 are correct, 0 correct by model, 0 correct by ema before train, 21 by model during train, total 2083
Comm round 55 meta round 5 chosen client: [3, 10, 5, 6, 13]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0016724035979547938, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2266 are correct, 0 correct by model, 0 correct by ema before train, 96 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001546870948192824, unsupervised loss ratio: 1.0, lr 0.021, 566 pseu out of 2512 are correct, 0 correct by model, 0 correct by ema before train, 650 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0011213579235148051, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2768 are correct, 0 correct by model, 0 correct by ema before train, 311 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001185980483305816, unsupervised loss ratio: 1.0, lr 0.021, 1217 pseu out of 2917 are correct, 0 correct by model, 0 correct by ema before train, 1284 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002427016480103672, unsupervised loss ratio: 1.0, lr 0.021, 2143 pseu out of 3526 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
************ Loss Avg 0.0677601183155812, LR 0.03, Round 55 ends ************  

TEST Student: Epoch: 55

TEST AUROC: 0.720164, TEST Accus: 0.250307, TEST Pre: 0.141987, TEST Recall: 0.170648
Comm round 56 meta round 0 chosen client: [10, 3, 9, 16, 7]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0021150957387550897, unsupervised loss ratio: 1.0, lr 0.021, 570 pseu out of 2548 are correct, 0 correct by model, 0 correct by ema before train, 670 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0024977434264396186, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 2259 are correct, 0 correct by model, 0 correct by ema before train, 85 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018497804477293459, unsupervised loss ratio: 1.0, lr 0.021, 36 pseu out of 398 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0025838043199103997, unsupervised loss ratio: 1.0, lr 0.021, 319 pseu out of 2404 are correct, 0 correct by model, 0 correct by ema before train, 359 by model during train, total 3883
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0018153051812707698, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2207 are correct, 0 correct by model, 0 correct by ema before train, 500 by model during train, total 3280
Comm round 56 meta round 1 chosen client: [7, 18, 6, 15, 5]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0017759039793208314, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2235 are correct, 0 correct by model, 0 correct by ema before train, 498 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0020084638769427934, unsupervised loss ratio: 1.0, lr 0.021, 533 pseu out of 1283 are correct, 0 correct by model, 0 correct by ema before train, 580 by model during train, total 2298
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001763967725455059, unsupervised loss ratio: 1.0, lr 0.021, 1214 pseu out of 2922 are correct, 0 correct by model, 0 correct by ema before train, 1295 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0018229602226011382, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2930 are correct, 0 correct by model, 0 correct by ema before train, 80 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0018322381866546194, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2819 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3866
Comm round 56 meta round 2 chosen client: [13, 0, 5, 3, 15]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004065960907856776, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3538 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9732612030846732 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0018272018651707006, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 318 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002310828756760332, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 2267 are correct, 0 correct by model, 0 correct by ema before train, 90 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017632661193112233, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2973 are correct, 0 correct by model, 0 correct by ema before train, 73 by model during train, total 4099
Comm round 56 meta round 3 chosen client: [19, 17, 0, 5, 10]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0020137432203717674, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 3783 are correct, 0 correct by model, 0 correct by ema before train, 94 by model during train, total 4949
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0013646010290055226, unsupervised loss ratio: 1.0, lr 0.021, 1056 pseu out of 4432 are correct, 0 correct by model, 0 correct by ema before train, 1078 by model during train, total 5558
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9310871764105193 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0018687833131092494, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2824 are correct, 0 correct by model, 0 correct by ema before train, 314 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002027929903024101, unsupervised loss ratio: 1.0, lr 0.021, 564 pseu out of 2552 are correct, 0 correct by model, 0 correct by ema before train, 663 by model during train, total 3684
Comm round 56 meta round 4 chosen client: [18, 14, 8, 2, 1]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0019209371110062217, unsupervised loss ratio: 1.0, lr 0.021, 531 pseu out of 1275 are correct, 0 correct by model, 0 correct by ema before train, 582 by model during train, total 2298
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0016094485622350917, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 961 are correct, 0 correct by model, 0 correct by ema before train, 25 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012150660522729506, unsupervised loss ratio: 1.0, lr 0.021, 2312 pseu out of 3097 are correct, 0 correct by model, 0 correct by ema before train, 2346 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0022207032556512524, unsupervised loss ratio: 1.0, lr 0.021, 246 pseu out of 1766 are correct, 0 correct by model, 0 correct by ema before train, 323 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002011943145700526, unsupervised loss ratio: 1.0, lr 0.021, 616 pseu out of 1519 are correct, 0 correct by model, 0 correct by ema before train, 675 by model during train, total 2621
Comm round 56 meta round 5 chosen client: [1, 19, 12, 13, 0]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00187790217644694, unsupervised loss ratio: 1.0, lr 0.021, 619 pseu out of 1523 are correct, 0 correct by model, 0 correct by ema before train, 680 by model during train, total 2621
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0019699412709413967, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 3780 are correct, 0 correct by model, 0 correct by ema before train, 89 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001540280401887786, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4740 are correct, 0 correct by model, 0 correct by ema before train, 13 by model during train, total 5750
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004515605078422133, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3540 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.935114146495352 lr : 0.03
************ Loss Avg 0.09626428406257158, LR 0.03, Round 56 ends ************  

TEST Student: Epoch: 56

TEST AUROC: 0.749809, TEST Accus: 0.297595, TEST Pre: 0.151897, TEST Recall: 0.234587
Comm round 57 meta round 0 chosen client: [4, 12, 9, 3, 14]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002942172089769017, unsupervised loss ratio: 1.0, lr 0.021, 715 pseu out of 2964 are correct, 0 correct by model, 0 correct by ema before train, 799 by model during train, total 3987
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0028469754211578723, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4754 are correct, 0 correct by model, 0 correct by ema before train, 15 by model during train, total 5750
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.003516183258465457, unsupervised loss ratio: 1.0, lr 0.021, 35 pseu out of 444 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004456197671970585, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2295 are correct, 0 correct by model, 0 correct by ema before train, 97 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.003248860399859647, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 998 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 2083
Comm round 57 meta round 1 chosen client: [3, 1, 14, 8, 5]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004188877694105031, unsupervised loss ratio: 1.0, lr 0.021, 25 pseu out of 2226 are correct, 0 correct by model, 0 correct by ema before train, 113 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0037445455914499556, unsupervised loss ratio: 1.0, lr 0.021, 620 pseu out of 1555 are correct, 0 correct by model, 0 correct by ema before train, 681 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0031676722062525878, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1029 are correct, 0 correct by model, 0 correct by ema before train, 26 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002013517137015697, unsupervised loss ratio: 1.0, lr 0.021, 2315 pseu out of 3100 are correct, 0 correct by model, 0 correct by ema before train, 2348 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.003498802604211006, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2825 are correct, 0 correct by model, 0 correct by ema before train, 317 by model during train, total 3866
Comm round 57 meta round 2 chosen client: [16, 4, 18, 3, 6]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004489076795193871, unsupervised loss ratio: 1.0, lr 0.021, 320 pseu out of 2451 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 3883
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028899621651766617, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2947 are correct, 0 correct by model, 0 correct by ema before train, 817 by model during train, total 3987
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003567411751848542, unsupervised loss ratio: 1.0, lr 0.021, 534 pseu out of 1269 are correct, 0 correct by model, 0 correct by ema before train, 579 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004173382780728778, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 2215 are correct, 0 correct by model, 0 correct by ema before train, 116 by model during train, total 3526
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0030225477032903313, unsupervised loss ratio: 1.0, lr 0.021, 1228 pseu out of 2968 are correct, 0 correct by model, 0 correct by ema before train, 1293 by model during train, total 4383
Comm round 57 meta round 3 chosen client: [1, 6, 10, 18, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003491431664925341, unsupervised loss ratio: 1.0, lr 0.021, 612 pseu out of 1536 are correct, 0 correct by model, 0 correct by ema before train, 700 by model during train, total 2621
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002906731697663233, unsupervised loss ratio: 1.0, lr 0.021, 1222 pseu out of 2926 are correct, 0 correct by model, 0 correct by ema before train, 1291 by model during train, total 4383
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0035831496663439764, unsupervised loss ratio: 1.0, lr 0.021, 566 pseu out of 2545 are correct, 0 correct by model, 0 correct by ema before train, 660 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0034060812872161884, unsupervised loss ratio: 1.0, lr 0.021, 533 pseu out of 1290 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 2298
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003908669603766785, unsupervised loss ratio: 1.0, lr 0.021, 249 pseu out of 1763 are correct, 0 correct by model, 0 correct by ema before train, 332 by model during train, total 2665
Comm round 57 meta round 4 chosen client: [2, 9, 8, 16, 10]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003792341205380147, unsupervised loss ratio: 1.0, lr 0.021, 247 pseu out of 1740 are correct, 0 correct by model, 0 correct by ema before train, 346 by model during train, total 2665
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00331169390766364, unsupervised loss ratio: 1.0, lr 0.021, 37 pseu out of 498 are correct, 0 correct by model, 0 correct by ema before train, 49 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001973926440058449, unsupervised loss ratio: 1.0, lr 0.021, 2299 pseu out of 3093 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004025672216991298, unsupervised loss ratio: 1.0, lr 0.021, 315 pseu out of 2363 are correct, 0 correct by model, 0 correct by ema before train, 389 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0034331204008375264, unsupervised loss ratio: 1.0, lr 0.021, 567 pseu out of 2484 are correct, 0 correct by model, 0 correct by ema before train, 687 by model during train, total 3684
Comm round 57 meta round 5 chosen client: [3, 18, 5, 16, 2]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.00420920993922534, unsupervised loss ratio: 1.0, lr 0.021, 31 pseu out of 2218 are correct, 0 correct by model, 0 correct by ema before train, 131 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0033627839519694033, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1286 are correct, 0 correct by model, 0 correct by ema before train, 593 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0033446619774741655, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2824 are correct, 0 correct by model, 0 correct by ema before train, 317 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003928249031992354, unsupervised loss ratio: 1.0, lr 0.021, 321 pseu out of 2306 are correct, 0 correct by model, 0 correct by ema before train, 379 by model during train, total 3883
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0038005281406055602, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1766 are correct, 0 correct by model, 0 correct by ema before train, 341 by model during train, total 2665
************ Loss Avg 0.003474814546753615, LR 0.03, Round 57 ends ************  

TEST Student: Epoch: 57

TEST AUROC: 0.701431, TEST Accus: 0.231139, TEST Pre: 0.144405, TEST Recall: 0.143826
Comm round 58 meta round 0 chosen client: [8, 17, 5, 6, 2]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0009006430935301069, unsupervised loss ratio: 1.0, lr 0.021, 2317 pseu out of 3094 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009507851363373814, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4508 are correct, 0 correct by model, 0 correct by ema before train, 1079 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0011471419807019658, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 2786 are correct, 0 correct by model, 0 correct by ema before train, 311 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0013018905461860309, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 2970 are correct, 0 correct by model, 0 correct by ema before train, 1299 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0014030699219022477, unsupervised loss ratio: 1.0, lr 0.021, 247 pseu out of 1746 are correct, 0 correct by model, 0 correct by ema before train, 342 by model during train, total 2665
Comm round 58 meta round 1 chosen client: [6, 13, 2, 14, 18]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0012700243547653267, unsupervised loss ratio: 1.0, lr 0.021, 1221 pseu out of 3020 are correct, 0 correct by model, 0 correct by ema before train, 1314 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00023760435153420432, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3552 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001446595755017673, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1781 are correct, 0 correct by model, 0 correct by ema before train, 352 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0008655985425734384, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1070 are correct, 0 correct by model, 0 correct by ema before train, 28 by model during train, total 2083
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0012850004180412118, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1274 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 2298
Comm round 58 meta round 2 chosen client: [15, 16, 13, 4, 0]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0012670877357567616, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2989 are correct, 0 correct by model, 0 correct by ema before train, 70 by model during train, total 4099
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0016285897553211352, unsupervised loss ratio: 1.0, lr 0.021, 320 pseu out of 2362 are correct, 0 correct by model, 0 correct by ema before train, 398 by model during train, total 3883
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002481735826191745, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3567 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001116297981103084, unsupervised loss ratio: 1.0, lr 0.021, 704 pseu out of 2970 are correct, 0 correct by model, 0 correct by ema before train, 814 by model during train, total 3987
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9749723806673166 lr : 0.03
Comm round 58 meta round 3 chosen client: [2, 0, 3, 5, 11]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0015150963847104105, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1812 are correct, 0 correct by model, 0 correct by ema before train, 355 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 1.0292843628902824 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0016865463814091136, unsupervised loss ratio: 1.0, lr 0.021, 29 pseu out of 2167 are correct, 0 correct by model, 0 correct by ema before train, 120 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0012150231212545491, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2852 are correct, 0 correct by model, 0 correct by ema before train, 319 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0012636459341592854, unsupervised loss ratio: 1.0, lr 0.021, 1814 pseu out of 2733 are correct, 0 correct by model, 0 correct by ema before train, 1923 by model during train, total 4088
Comm round 58 meta round 4 chosen client: [1, 15, 18, 0, 3]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001212007082181006, unsupervised loss ratio: 1.0, lr 0.021, 621 pseu out of 1509 are correct, 0 correct by model, 0 correct by ema before train, 688 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0012613336590640337, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3046 are correct, 0 correct by model, 0 correct by ema before train, 66 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0013305782890205996, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1295 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9557002515208964 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0017400206721244363, unsupervised loss ratio: 1.0, lr 0.021, 34 pseu out of 2247 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 3526
Comm round 58 meta round 5 chosen client: [10, 14, 0, 4, 11]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.001459722244582171, unsupervised loss ratio: 1.0, lr 0.021, 569 pseu out of 2503 are correct, 0 correct by model, 0 correct by ema before train, 684 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009099294459729483, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1120 are correct, 0 correct by model, 0 correct by ema before train, 27 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9832081904216688 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0011644711337303595, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2981 are correct, 0 correct by model, 0 correct by ema before train, 816 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001265182689166977, unsupervised loss ratio: 1.0, lr 0.021, 1820 pseu out of 2779 are correct, 0 correct by model, 0 correct by ema before train, 1913 by model during train, total 4088
************ Loss Avg 0.13247524152309767, LR 0.03, Round 58 ends ************  

TEST Student: Epoch: 58

TEST AUROC: 0.774817, TEST Accus: 0.331861, TEST Pre: 0.177989, TEST Recall: 0.278623
Comm round 59 meta round 0 chosen client: [4, 8, 10, 9, 3]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.004354931772612627, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 2946 are correct, 0 correct by model, 0 correct by ema before train, 813 by model during train, total 3987
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0028015146183406614, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 3073 are correct, 0 correct by model, 0 correct by ema before train, 2340 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0051933549834286856, unsupervised loss ratio: 1.0, lr 0.021, 572 pseu out of 2479 are correct, 0 correct by model, 0 correct by ema before train, 704 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0052045835268304304, unsupervised loss ratio: 1.0, lr 0.021, 39 pseu out of 528 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.006616345252301211, unsupervised loss ratio: 1.0, lr 0.021, 32 pseu out of 2221 are correct, 0 correct by model, 0 correct by ema before train, 138 by model during train, total 3526
Comm round 59 meta round 1 chosen client: [1, 8, 19, 9, 16]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.005529685269632354, unsupervised loss ratio: 1.0, lr 0.021, 621 pseu out of 1591 are correct, 0 correct by model, 0 correct by ema before train, 708 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002590936048363801, unsupervised loss ratio: 1.0, lr 0.021, 2298 pseu out of 3057 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005971948019204996, unsupervised loss ratio: 1.0, lr 0.021, 24 pseu out of 3747 are correct, 0 correct by model, 0 correct by ema before train, 117 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.005042313216512816, unsupervised loss ratio: 1.0, lr 0.021, 38 pseu out of 546 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00635763716532803, unsupervised loss ratio: 1.0, lr 0.021, 321 pseu out of 2317 are correct, 0 correct by model, 0 correct by ema before train, 401 by model during train, total 3883
Comm round 59 meta round 2 chosen client: [19, 12, 8, 1, 2]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005464550101374372, unsupervised loss ratio: 1.0, lr 0.021, 34 pseu out of 3613 are correct, 0 correct by model, 0 correct by ema before train, 150 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.004480323099091442, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4643 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 5750
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002543965091035716, unsupervised loss ratio: 1.0, lr 0.021, 2293 pseu out of 3007 are correct, 0 correct by model, 0 correct by ema before train, 2346 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.005139904585099075, unsupervised loss ratio: 1.0, lr 0.021, 622 pseu out of 1566 are correct, 0 correct by model, 0 correct by ema before train, 722 by model during train, total 2621
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005966233444355783, unsupervised loss ratio: 1.0, lr 0.021, 249 pseu out of 1787 are correct, 0 correct by model, 0 correct by ema before train, 359 by model during train, total 2665
Comm round 59 meta round 3 chosen client: [15, 3, 2, 8, 10]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.005029584091747753, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2984 are correct, 0 correct by model, 0 correct by ema before train, 64 by model during train, total 4099
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0061888150479977155, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 2176 are correct, 0 correct by model, 0 correct by ema before train, 135 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005326149148112606, unsupervised loss ratio: 1.0, lr 0.021, 250 pseu out of 1763 are correct, 0 correct by model, 0 correct by ema before train, 373 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002446085990868596, unsupervised loss ratio: 1.0, lr 0.021, 2286 pseu out of 2988 are correct, 0 correct by model, 0 correct by ema before train, 2341 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004654759139721763, unsupervised loss ratio: 1.0, lr 0.021, 579 pseu out of 2417 are correct, 0 correct by model, 0 correct by ema before train, 729 by model during train, total 3684
Comm round 59 meta round 4 chosen client: [19, 7, 2, 10, 17]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0053369648476990945, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 3502 are correct, 0 correct by model, 0 correct by ema before train, 172 by model during train, total 4949
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.005500045751642364, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2170 are correct, 0 correct by model, 0 correct by ema before train, 505 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005305020077641876, unsupervised loss ratio: 1.0, lr 0.021, 253 pseu out of 1722 are correct, 0 correct by model, 0 correct by ema before train, 390 by model during train, total 2665
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004673753134456688, unsupervised loss ratio: 1.0, lr 0.021, 583 pseu out of 2384 are correct, 0 correct by model, 0 correct by ema before train, 757 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0038376272945054644, unsupervised loss ratio: 1.0, lr 0.021, 1056 pseu out of 4425 are correct, 0 correct by model, 0 correct by ema before train, 1082 by model during train, total 5558
Comm round 59 meta round 5 chosen client: [17, 15, 4, 3, 0]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0035039474779536583, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4344 are correct, 0 correct by model, 0 correct by ema before train, 1087 by model during train, total 5558
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.004681433595116967, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2970 are correct, 0 correct by model, 0 correct by ema before train, 104 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.003996088151036511, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2909 are correct, 0 correct by model, 0 correct by ema before train, 846 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0059220943512627855, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 2075 are correct, 0 correct by model, 0 correct by ema before train, 164 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8757712999168707 lr : 0.03
************ Loss Avg 0.03384772980700489, LR 0.03, Round 59 ends ************  

TEST Student: Epoch: 59

TEST AUROC: 0.731367, TEST Accus: 0.269668, TEST Pre: 0.151313, TEST Recall: 0.192262
Comm round 60 meta round 0 chosen client: [9, 4, 6, 10, 19]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0021048828687829277, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 567 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 1677
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001886460900543228, unsupervised loss ratio: 1.0, lr 0.021, 707 pseu out of 2877 are correct, 0 correct by model, 0 correct by ema before train, 850 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0022198179714800117, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 3018 are correct, 0 correct by model, 0 correct by ema before train, 1295 by model during train, total 4383
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002360108958814165, unsupervised loss ratio: 1.0, lr 0.021, 584 pseu out of 2389 are correct, 0 correct by model, 0 correct by ema before train, 753 by model during train, total 3684
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002486243454861837, unsupervised loss ratio: 1.0, lr 0.021, 35 pseu out of 3395 are correct, 0 correct by model, 0 correct by ema before train, 186 by model during train, total 4949
Comm round 60 meta round 1 chosen client: [4, 16, 14, 7, 13]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0019964812284645936, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 2915 are correct, 0 correct by model, 0 correct by ema before train, 855 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002814684708251572, unsupervised loss ratio: 1.0, lr 0.021, 317 pseu out of 2244 are correct, 0 correct by model, 0 correct by ema before train, 421 by model during train, total 3883
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002158154165513362, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1102 are correct, 0 correct by model, 0 correct by ema before train, 32 by model during train, total 2083
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002125870716274501, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2216 are correct, 0 correct by model, 0 correct by ema before train, 504 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000494353910977163, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3578 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Comm round 60 meta round 2 chosen client: [9, 1, 15, 19, 13]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002257044388830696, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 592 are correct, 0 correct by model, 0 correct by ema before train, 51 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002283738514340324, unsupervised loss ratio: 1.0, lr 0.021, 620 pseu out of 1560 are correct, 0 correct by model, 0 correct by ema before train, 724 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002197794717645033, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2886 are correct, 0 correct by model, 0 correct by ema before train, 95 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002604549388753441, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 3448 are correct, 0 correct by model, 0 correct by ema before train, 216 by model during train, total 4949
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000505424259769162, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3577 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Comm round 60 meta round 3 chosen client: [11, 6, 8, 18, 4]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0021692105028705555, unsupervised loss ratio: 1.0, lr 0.021, 1822 pseu out of 2788 are correct, 0 correct by model, 0 correct by ema before train, 1931 by model during train, total 4088
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002152797679140138, unsupervised loss ratio: 1.0, lr 0.021, 1222 pseu out of 3039 are correct, 0 correct by model, 0 correct by ema before train, 1305 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012807929495615156, unsupervised loss ratio: 1.0, lr 0.021, 2286 pseu out of 2984 are correct, 0 correct by model, 0 correct by ema before train, 2347 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0023785311851598737, unsupervised loss ratio: 1.0, lr 0.021, 530 pseu out of 1279 are correct, 0 correct by model, 0 correct by ema before train, 593 by model during train, total 2298
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0019762932428247517, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2876 are correct, 0 correct by model, 0 correct by ema before train, 855 by model during train, total 3987
Comm round 60 meta round 4 chosen client: [19, 1, 5, 11, 18]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00257785339841249, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 3403 are correct, 0 correct by model, 0 correct by ema before train, 217 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002381087811777323, unsupervised loss ratio: 1.0, lr 0.021, 621 pseu out of 1539 are correct, 0 correct by model, 0 correct by ema before train, 719 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0024457908069455353, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2909 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002112243223564292, unsupervised loss ratio: 1.0, lr 0.021, 1825 pseu out of 2786 are correct, 0 correct by model, 0 correct by ema before train, 1928 by model during train, total 4088
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0022635871201701877, unsupervised loss ratio: 1.0, lr 0.021, 533 pseu out of 1302 are correct, 0 correct by model, 0 correct by ema before train, 602 by model during train, total 2298
Comm round 60 meta round 5 chosen client: [0, 17, 12, 13, 5]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9221101001817353 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015815377982076385, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4290 are correct, 0 correct by model, 0 correct by ema before train, 1091 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0018187916446347823, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4620 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 5750
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005403316742049972, unsupervised loss ratio: 1.0, lr 0.021, 2152 pseu out of 3555 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002410519800862664, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2833 are correct, 0 correct by model, 0 correct by ema before train, 321 by model during train, total 3866
************ Loss Avg 0.032689835972445805, LR 0.03, Round 60 ends ************  

TEST Student: Epoch: 60

TEST AUROC: 0.718619, TEST Accus: 0.250307, TEST Pre: 0.153067, TEST Recall: 0.167561
Comm round 61 meta round 0 chosen client: [1, 13, 16, 10, 12]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0018491115827090675, unsupervised loss ratio: 1.0, lr 0.021, 615 pseu out of 1552 are correct, 0 correct by model, 0 correct by ema before train, 742 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003418158967949655, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3584 are correct, 0 correct by model, 0 correct by ema before train, 2193 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0023608471526474248, unsupervised loss ratio: 1.0, lr 0.021, 321 pseu out of 2282 are correct, 0 correct by model, 0 correct by ema before train, 415 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002126160609648274, unsupervised loss ratio: 1.0, lr 0.021, 589 pseu out of 2376 are correct, 0 correct by model, 0 correct by ema before train, 756 by model during train, total 3684
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001479761930143771, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4640 are correct, 0 correct by model, 0 correct by ema before train, 19 by model during train, total 5750
Comm round 61 meta round 1 chosen client: [11, 19, 0, 14, 8]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0017342095297863125, unsupervised loss ratio: 1.0, lr 0.021, 1832 pseu out of 2801 are correct, 0 correct by model, 0 correct by ema before train, 1931 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0020091959946185877, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 3446 are correct, 0 correct by model, 0 correct by ema before train, 227 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9358191210396436 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014691754459459899, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1182 are correct, 0 correct by model, 0 correct by ema before train, 33 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001184233628777065, unsupervised loss ratio: 1.0, lr 0.021, 2292 pseu out of 3015 are correct, 0 correct by model, 0 correct by ema before train, 2342 by model during train, total 4036
Comm round 61 meta round 2 chosen client: [13, 6, 3, 12, 2]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00038134001596964957, unsupervised loss ratio: 1.0, lr 0.021, 2157 pseu out of 3576 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0017363772494718432, unsupervised loss ratio: 1.0, lr 0.021, 1221 pseu out of 2991 are correct, 0 correct by model, 0 correct by ema before train, 1314 by model during train, total 4383
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002274815581326298, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 2031 are correct, 0 correct by model, 0 correct by ema before train, 164 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0015255678555048588, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4720 are correct, 0 correct by model, 0 correct by ema before train, 21 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0019189859241513269, unsupervised loss ratio: 1.0, lr 0.021, 251 pseu out of 1681 are correct, 0 correct by model, 0 correct by ema before train, 406 by model during train, total 2665
Comm round 61 meta round 3 chosen client: [4, 18, 12, 7, 1]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0015704125588175855, unsupervised loss ratio: 1.0, lr 0.021, 713 pseu out of 2909 are correct, 0 correct by model, 0 correct by ema before train, 845 by model during train, total 3987
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0017808474238134092, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1295 are correct, 0 correct by model, 0 correct by ema before train, 598 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0015081653044843632, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4770 are correct, 0 correct by model, 0 correct by ema before train, 16 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0017183129815608622, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2207 are correct, 0 correct by model, 0 correct by ema before train, 505 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0018364574260464528, unsupervised loss ratio: 1.0, lr 0.021, 621 pseu out of 1563 are correct, 0 correct by model, 0 correct by ema before train, 730 by model during train, total 2621
Comm round 61 meta round 4 chosen client: [18, 0, 1, 4, 5]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0018736101434721302, unsupervised loss ratio: 1.0, lr 0.021, 540 pseu out of 1317 are correct, 0 correct by model, 0 correct by ema before train, 584 by model during train, total 2298
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9154466512251873 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0018472890838094782, unsupervised loss ratio: 1.0, lr 0.021, 619 pseu out of 1572 are correct, 0 correct by model, 0 correct by ema before train, 741 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016433534559808552, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2926 are correct, 0 correct by model, 0 correct by ema before train, 846 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.001855929508580078, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2859 are correct, 0 correct by model, 0 correct by ema before train, 322 by model during train, total 3866
Comm round 61 meta round 5 chosen client: [17, 18, 19, 12, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.001366528638253181, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4396 are correct, 0 correct by model, 0 correct by ema before train, 1086 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0017752087959605786, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1337 are correct, 0 correct by model, 0 correct by ema before train, 588 by model during train, total 2298
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002061922163239871, unsupervised loss ratio: 1.0, lr 0.021, 72 pseu out of 3390 are correct, 0 correct by model, 0 correct by ema before train, 244 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0015308117054195869, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4748 are correct, 0 correct by model, 0 correct by ema before train, 20 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016211219074662834, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 2923 are correct, 0 correct by model, 0 correct by ema before train, 847 by model during train, total 3987
************ Loss Avg 0.06325491139197435, LR 0.03, Round 61 ends ************  

TEST Student: Epoch: 61

TEST AUROC: 0.729979, TEST Accus: 0.259219, TEST Pre: 0.157304, TEST Recall: 0.180292
Comm round 62 meta round 0 chosen client: [18, 8, 7, 13, 9]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002298070664336491, unsupervised loss ratio: 1.0, lr 0.021, 540 pseu out of 1350 are correct, 0 correct by model, 0 correct by ema before train, 603 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013800901479754657, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3022 are correct, 0 correct by model, 0 correct by ema before train, 2340 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0021600024995747777, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2237 are correct, 0 correct by model, 0 correct by ema before train, 507 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005579428247598363, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3591 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0021487668882063764, unsupervised loss ratio: 1.0, lr 0.021, 42 pseu out of 626 are correct, 0 correct by model, 0 correct by ema before train, 51 by model during train, total 1677
Comm round 62 meta round 1 chosen client: [4, 3, 10, 16, 7]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001983634358371741, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2936 are correct, 0 correct by model, 0 correct by ema before train, 848 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0028899288884401486, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 2098 are correct, 0 correct by model, 0 correct by ema before train, 183 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00236369935386204, unsupervised loss ratio: 1.0, lr 0.021, 581 pseu out of 2399 are correct, 0 correct by model, 0 correct by ema before train, 758 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.00284802692953772, unsupervised loss ratio: 1.0, lr 0.021, 329 pseu out of 2309 are correct, 0 correct by model, 0 correct by ema before train, 440 by model during train, total 3883
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0021757330362631297, unsupervised loss ratio: 1.0, lr 0.021, 490 pseu out of 2223 are correct, 0 correct by model, 0 correct by ema before train, 508 by model during train, total 3280
Comm round 62 meta round 2 chosen client: [5, 6, 13, 0, 17]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00227585025551561, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2897 are correct, 0 correct by model, 0 correct by ema before train, 315 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002041847315579788, unsupervised loss ratio: 1.0, lr 0.021, 1224 pseu out of 3029 are correct, 0 correct by model, 0 correct by ema before train, 1317 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000521187660061992, unsupervised loss ratio: 1.0, lr 0.021, 2149 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9028393626213074 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015994351927255247, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4380 are correct, 0 correct by model, 0 correct by ema before train, 1082 by model during train, total 5558
Comm round 62 meta round 3 chosen client: [15, 8, 17, 5, 1]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002239662894722782, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2934 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013329487367172987, unsupervised loss ratio: 1.0, lr 0.021, 2291 pseu out of 3019 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0016269225864028879, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4347 are correct, 0 correct by model, 0 correct by ema before train, 1082 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0022906014642327045, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2847 are correct, 0 correct by model, 0 correct by ema before train, 321 by model during train, total 3866
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0023878028945679346, unsupervised loss ratio: 1.0, lr 0.021, 624 pseu out of 1608 are correct, 0 correct by model, 0 correct by ema before train, 745 by model during train, total 2621
Comm round 62 meta round 4 chosen client: [19, 12, 15, 3, 8]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0024430200514288093, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 3466 are correct, 0 correct by model, 0 correct by ema before train, 241 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0019312443415401503, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 4805 are correct, 0 correct by model, 0 correct by ema before train, 17 by model during train, total 5750
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002184123714519396, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2907 are correct, 0 correct by model, 0 correct by ema before train, 111 by model during train, total 4099
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0029387226680098267, unsupervised loss ratio: 1.0, lr 0.021, 57 pseu out of 2143 are correct, 0 correct by model, 0 correct by ema before train, 191 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013397979158469298, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3010 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Comm round 62 meta round 5 chosen client: [18, 14, 11, 8, 0]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0022753248922526836, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1335 are correct, 0 correct by model, 0 correct by ema before train, 599 by model during train, total 2298
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002068776381554816, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1142 are correct, 0 correct by model, 0 correct by ema before train, 28 by model during train, total 2083
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002061749421955028, unsupervised loss ratio: 1.0, lr 0.021, 1829 pseu out of 2773 are correct, 0 correct by model, 0 correct by ema before train, 1943 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001358124310115727, unsupervised loss ratio: 1.0, lr 0.021, 2298 pseu out of 3042 are correct, 0 correct by model, 0 correct by ema before train, 2341 by model during train, total 4036
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9313434982786373 lr : 0.03
************ Loss Avg 0.06299686330630073, LR 0.03, Round 62 ends ************  

TEST Student: Epoch: 62

TEST AUROC: 0.737770, TEST Accus: 0.270552, TEST Pre: 0.156179, TEST Recall: 0.195026
Comm round 63 meta round 0 chosen client: [1, 7, 14, 0, 19]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00253811304559704, unsupervised loss ratio: 1.0, lr 0.021, 629 pseu out of 1610 are correct, 0 correct by model, 0 correct by ema before train, 739 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00236910112289479, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2236 are correct, 0 correct by model, 0 correct by ema before train, 506 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002195113564305233, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1158 are correct, 0 correct by model, 0 correct by ema before train, 38 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9127382775958703 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002665875305702241, unsupervised loss ratio: 1.0, lr 0.021, 81 pseu out of 3453 are correct, 0 correct by model, 0 correct by ema before train, 254 by model during train, total 4949
Comm round 63 meta round 1 chosen client: [7, 13, 17, 2, 1]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002467166332980224, unsupervised loss ratio: 1.0, lr 0.021, 490 pseu out of 2233 are correct, 0 correct by model, 0 correct by ema before train, 508 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000613275006382876, unsupervised loss ratio: 1.0, lr 0.021, 2159 pseu out of 3597 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017987828315021578, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4353 are correct, 0 correct by model, 0 correct by ema before train, 1088 by model during train, total 5558
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002870401921903803, unsupervised loss ratio: 1.0, lr 0.021, 247 pseu out of 1696 are correct, 0 correct by model, 0 correct by ema before train, 402 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002482228290584938, unsupervised loss ratio: 1.0, lr 0.021, 628 pseu out of 1627 are correct, 0 correct by model, 0 correct by ema before train, 749 by model during train, total 2621
Comm round 63 meta round 2 chosen client: [4, 11, 1, 15, 5]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002213546294822461, unsupervised loss ratio: 1.0, lr 0.021, 707 pseu out of 2956 are correct, 0 correct by model, 0 correct by ema before train, 856 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002283715553858201, unsupervised loss ratio: 1.0, lr 0.021, 1828 pseu out of 2800 are correct, 0 correct by model, 0 correct by ema before train, 1960 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0025492475748561867, unsupervised loss ratio: 1.0, lr 0.021, 624 pseu out of 1590 are correct, 0 correct by model, 0 correct by ema before train, 762 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002456032291117411, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2919 are correct, 0 correct by model, 0 correct by ema before train, 110 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00250929869715216, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2905 are correct, 0 correct by model, 0 correct by ema before train, 324 by model during train, total 3866
Comm round 63 meta round 3 chosen client: [8, 9, 15, 13, 7]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014482069511814188, unsupervised loss ratio: 1.0, lr 0.021, 2293 pseu out of 3023 are correct, 0 correct by model, 0 correct by ema before train, 2342 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002584608269562186, unsupervised loss ratio: 1.0, lr 0.021, 41 pseu out of 644 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 1677
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0023523756448412315, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2895 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005845724179811965, unsupervised loss ratio: 1.0, lr 0.021, 2156 pseu out of 3596 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002429807644847852, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2267 are correct, 0 correct by model, 0 correct by ema before train, 511 by model during train, total 3280
Comm round 63 meta round 4 chosen client: [15, 1, 11, 2, 17]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002444115695918579, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2930 are correct, 0 correct by model, 0 correct by ema before train, 115 by model during train, total 4099
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002599505787124721, unsupervised loss ratio: 1.0, lr 0.021, 630 pseu out of 1614 are correct, 0 correct by model, 0 correct by ema before train, 756 by model during train, total 2621
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002230339526249736, unsupervised loss ratio: 1.0, lr 0.021, 1829 pseu out of 2791 are correct, 0 correct by model, 0 correct by ema before train, 1964 by model during train, total 4088
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0027509788633324206, unsupervised loss ratio: 1.0, lr 0.021, 258 pseu out of 1742 are correct, 0 correct by model, 0 correct by ema before train, 406 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017640697522270869, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4387 are correct, 0 correct by model, 0 correct by ema before train, 1093 by model during train, total 5558
Comm round 63 meta round 5 chosen client: [9, 19, 1, 11, 3]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002411699049709434, unsupervised loss ratio: 1.0, lr 0.021, 42 pseu out of 665 are correct, 0 correct by model, 0 correct by ema before train, 53 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0026394740390316704, unsupervised loss ratio: 1.0, lr 0.021, 81 pseu out of 3436 are correct, 0 correct by model, 0 correct by ema before train, 277 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002706921264733665, unsupervised loss ratio: 1.0, lr 0.021, 629 pseu out of 1623 are correct, 0 correct by model, 0 correct by ema before train, 767 by model during train, total 2621
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002164846804589615, unsupervised loss ratio: 1.0, lr 0.021, 1824 pseu out of 2769 are correct, 0 correct by model, 0 correct by ema before train, 1965 by model during train, total 4088
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0030765851845769377, unsupervised loss ratio: 1.0, lr 0.021, 60 pseu out of 2077 are correct, 0 correct by model, 0 correct by ema before train, 183 by model during train, total 3526
************ Loss Avg 0.03263127607751461, LR 0.03, Round 63 ends ************  

TEST Student: Epoch: 63

TEST AUROC: 0.726575, TEST Accus: 0.251191, TEST Pre: 0.158693, TEST Recall: 0.169854
Comm round 64 meta round 0 chosen client: [4, 15, 2, 0, 11]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0017302503997814796, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2916 are correct, 0 correct by model, 0 correct by ema before train, 872 by model during train, total 3987
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0018971038191991213, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2945 are correct, 0 correct by model, 0 correct by ema before train, 135 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002187752652735937, unsupervised loss ratio: 1.0, lr 0.021, 260 pseu out of 1727 are correct, 0 correct by model, 0 correct by ema before train, 411 by model during train, total 2665
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8799333633208761 lr : 0.03
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0017155974210254499, unsupervised loss ratio: 1.0, lr 0.021, 1832 pseu out of 2793 are correct, 0 correct by model, 0 correct by ema before train, 1972 by model during train, total 4088
Comm round 64 meta round 1 chosen client: [2, 9, 19, 7, 10]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002219133806647733, unsupervised loss ratio: 1.0, lr 0.021, 265 pseu out of 1733 are correct, 0 correct by model, 0 correct by ema before train, 416 by model during train, total 2665
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018988998511944104, unsupervised loss ratio: 1.0, lr 0.021, 43 pseu out of 693 are correct, 0 correct by model, 0 correct by ema before train, 54 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002151824598117039, unsupervised loss ratio: 1.0, lr 0.021, 86 pseu out of 3477 are correct, 0 correct by model, 0 correct by ema before train, 263 by model during train, total 4949
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001722958731709066, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2291 are correct, 0 correct by model, 0 correct by ema before train, 513 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0022270201147405497, unsupervised loss ratio: 1.0, lr 0.021, 582 pseu out of 2383 are correct, 0 correct by model, 0 correct by ema before train, 764 by model during train, total 3684
Comm round 64 meta round 2 chosen client: [2, 8, 14, 19, 18]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002235127032257705, unsupervised loss ratio: 1.0, lr 0.021, 258 pseu out of 1756 are correct, 0 correct by model, 0 correct by ema before train, 409 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012816666949504452, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3079 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014868795335518591, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1175 are correct, 0 correct by model, 0 correct by ema before train, 35 by model during train, total 2083
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0021450932813772503, unsupervised loss ratio: 1.0, lr 0.021, 107 pseu out of 3528 are correct, 0 correct by model, 0 correct by ema before train, 303 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002047512337513682, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1372 are correct, 0 correct by model, 0 correct by ema before train, 598 by model during train, total 2298
Comm round 64 meta round 3 chosen client: [9, 5, 12, 10, 16]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001946164502037896, unsupervised loss ratio: 1.0, lr 0.021, 45 pseu out of 706 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 1677
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0018591642962791576, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2903 are correct, 0 correct by model, 0 correct by ema before train, 322 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001548678170527435, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4809 are correct, 0 correct by model, 0 correct by ema before train, 25 by model during train, total 5750
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002108911607326169, unsupervised loss ratio: 1.0, lr 0.021, 586 pseu out of 2364 are correct, 0 correct by model, 0 correct by ema before train, 772 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0025916668991023887, unsupervised loss ratio: 1.0, lr 0.021, 330 pseu out of 2314 are correct, 0 correct by model, 0 correct by ema before train, 426 by model during train, total 3883
Comm round 64 meta round 4 chosen client: [11, 13, 0, 3, 19]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0017569048059158376, unsupervised loss ratio: 1.0, lr 0.021, 1833 pseu out of 2790 are correct, 0 correct by model, 0 correct by ema before train, 1979 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004819709082751661, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3588 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.871102368345066 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0024980930371774385, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 2096 are correct, 0 correct by model, 0 correct by ema before train, 195 by model during train, total 3526
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002220511441686167, unsupervised loss ratio: 1.0, lr 0.021, 98 pseu out of 3514 are correct, 0 correct by model, 0 correct by ema before train, 280 by model during train, total 4949
Comm round 64 meta round 5 chosen client: [10, 15, 18, 19, 17]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002173477092332303, unsupervised loss ratio: 1.0, lr 0.021, 600 pseu out of 2426 are correct, 0 correct by model, 0 correct by ema before train, 792 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0019700269812556845, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2951 are correct, 0 correct by model, 0 correct by ema before train, 123 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0019456205676154543, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1353 are correct, 0 correct by model, 0 correct by ema before train, 601 by model during train, total 2298
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002146309411797959, unsupervised loss ratio: 1.0, lr 0.021, 120 pseu out of 3577 are correct, 0 correct by model, 0 correct by ema before train, 324 by model during train, total 4949
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0013851085778100994, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4361 are correct, 0 correct by model, 0 correct by ema before train, 1089 by model during train, total 5558
************ Loss Avg 0.06015383867466276, LR 0.03, Round 64 ends ************  

TEST Student: Epoch: 64

TEST AUROC: 0.743321, TEST Accus: 0.283267, TEST Pre: 0.163855, TEST Recall: 0.212256
Comm round 65 meta round 0 chosen client: [17, 5, 3, 12, 4]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0019437158199284098, unsupervised loss ratio: 1.0, lr 0.021, 1054 pseu out of 4393 are correct, 0 correct by model, 0 correct by ema before train, 1094 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0028841462535936324, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2854 are correct, 0 correct by model, 0 correct by ema before train, 328 by model during train, total 3866
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0035239113732521738, unsupervised loss ratio: 1.0, lr 0.021, 62 pseu out of 2111 are correct, 0 correct by model, 0 correct by ema before train, 200 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002336686931408217, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4817 are correct, 0 correct by model, 0 correct by ema before train, 24 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002364827212803657, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2966 are correct, 0 correct by model, 0 correct by ema before train, 867 by model during train, total 3987
Comm round 65 meta round 1 chosen client: [15, 2, 11, 12, 7]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0027194902305731935, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2986 are correct, 0 correct by model, 0 correct by ema before train, 140 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0030821452022618836, unsupervised loss ratio: 1.0, lr 0.021, 267 pseu out of 1739 are correct, 0 correct by model, 0 correct by ema before train, 435 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002523546992961201, unsupervised loss ratio: 1.0, lr 0.021, 1843 pseu out of 2810 are correct, 0 correct by model, 0 correct by ema before train, 1982 by model during train, total 4088
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002313649924730675, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4820 are correct, 0 correct by model, 0 correct by ema before train, 27 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002759696753156067, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2290 are correct, 0 correct by model, 0 correct by ema before train, 513 by model during train, total 3280
Comm round 65 meta round 2 chosen client: [17, 3, 14, 9, 18]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0019236764410275153, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4416 are correct, 0 correct by model, 0 correct by ema before train, 1091 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0034699864889781956, unsupervised loss ratio: 1.0, lr 0.021, 65 pseu out of 2076 are correct, 0 correct by model, 0 correct by ema before train, 203 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002562359247046212, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1210 are correct, 0 correct by model, 0 correct by ema before train, 30 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002911717688052536, unsupervised loss ratio: 1.0, lr 0.021, 41 pseu out of 729 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0027509163353695637, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1347 are correct, 0 correct by model, 0 correct by ema before train, 605 by model during train, total 2298
Comm round 65 meta round 3 chosen client: [12, 18, 9, 8, 7]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0023255843449280496, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4830 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0027957643097680476, unsupervised loss ratio: 1.0, lr 0.021, 536 pseu out of 1354 are correct, 0 correct by model, 0 correct by ema before train, 607 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0027188740172682125, unsupervised loss ratio: 1.0, lr 0.021, 45 pseu out of 733 are correct, 0 correct by model, 0 correct by ema before train, 54 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014718057779461446, unsupervised loss ratio: 1.0, lr 0.021, 2301 pseu out of 3037 are correct, 0 correct by model, 0 correct by ema before train, 2340 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0027359625573108834, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2259 are correct, 0 correct by model, 0 correct by ema before train, 512 by model during train, total 3280
Comm round 65 meta round 4 chosen client: [7, 14, 13, 8, 18]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002693185963345548, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2299 are correct, 0 correct by model, 0 correct by ema before train, 515 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002510298399790896, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1184 are correct, 0 correct by model, 0 correct by ema before train, 31 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000627794710206957, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3605 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001511102653580565, unsupervised loss ratio: 1.0, lr 0.021, 2290 pseu out of 3019 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028008527394073703, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1347 are correct, 0 correct by model, 0 correct by ema before train, 621 by model during train, total 2298
Comm round 65 meta round 5 chosen client: [5, 13, 16, 7, 2]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0026854636995923384, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2838 are correct, 0 correct by model, 0 correct by ema before train, 332 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006594379549408016, unsupervised loss ratio: 1.0, lr 0.021, 2158 pseu out of 3585 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0034475323694498567, unsupervised loss ratio: 1.0, lr 0.021, 327 pseu out of 2300 are correct, 0 correct by model, 0 correct by ema before train, 453 by model during train, total 3883
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0026962774807963376, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2280 are correct, 0 correct by model, 0 correct by ema before train, 518 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003083207805286206, unsupervised loss ratio: 1.0, lr 0.021, 271 pseu out of 1772 are correct, 0 correct by model, 0 correct by ema before train, 428 by model during train, total 2665
************ Loss Avg 0.0024944539226253786, LR 0.03, Round 65 ends ************  

TEST Student: Epoch: 65

TEST AUROC: 0.711260, TEST Accus: 0.238476, TEST Pre: 0.177074, TEST Recall: 0.152635
Comm round 66 meta round 0 chosen client: [6, 13, 5, 19, 3]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0013352582506174087, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 3068 are correct, 0 correct by model, 0 correct by ema before train, 1314 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00023938500299217115, unsupervised loss ratio: 1.0, lr 0.021, 2153 pseu out of 3597 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013646722893368025, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 2900 are correct, 0 correct by model, 0 correct by ema before train, 327 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001575380184266788, unsupervised loss ratio: 1.0, lr 0.021, 117 pseu out of 3609 are correct, 0 correct by model, 0 correct by ema before train, 317 by model during train, total 4949
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002028927586122466, unsupervised loss ratio: 1.0, lr 0.021, 59 pseu out of 2151 are correct, 0 correct by model, 0 correct by ema before train, 209 by model during train, total 3526
Comm round 66 meta round 1 chosen client: [8, 2, 14, 13, 9]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011090182969155649, unsupervised loss ratio: 1.0, lr 0.021, 2308 pseu out of 3081 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0017436271688590448, unsupervised loss ratio: 1.0, lr 0.021, 266 pseu out of 1781 are correct, 0 correct by model, 0 correct by ema before train, 437 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009811197400488186, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 1263 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002645104508146533, unsupervised loss ratio: 1.0, lr 0.021, 2164 pseu out of 3620 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0011408966825843822, unsupervised loss ratio: 1.0, lr 0.021, 45 pseu out of 788 are correct, 0 correct by model, 0 correct by ema before train, 55 by model during train, total 1677
Comm round 66 meta round 2 chosen client: [13, 1, 16, 15, 19]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002563820193152701, unsupervised loss ratio: 1.0, lr 0.021, 2164 pseu out of 3626 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0014193963270816134, unsupervised loss ratio: 1.0, lr 0.021, 634 pseu out of 1634 are correct, 0 correct by model, 0 correct by ema before train, 772 by model during train, total 2621
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0018542075317856841, unsupervised loss ratio: 1.0, lr 0.021, 336 pseu out of 2344 are correct, 0 correct by model, 0 correct by ema before train, 470 by model during train, total 3883
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.001492718928868551, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2999 are correct, 0 correct by model, 0 correct by ema before train, 141 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0015946005542690938, unsupervised loss ratio: 1.0, lr 0.021, 132 pseu out of 3622 are correct, 0 correct by model, 0 correct by ema before train, 327 by model during train, total 4949
Comm round 66 meta round 3 chosen client: [1, 17, 9, 6, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0015946787202776205, unsupervised loss ratio: 1.0, lr 0.021, 632 pseu out of 1661 are correct, 0 correct by model, 0 correct by ema before train, 766 by model during train, total 2621
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.000992780970476418, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4451 are correct, 0 correct by model, 0 correct by ema before train, 1091 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001339249776383103, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 783 are correct, 0 correct by model, 0 correct by ema before train, 54 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0013275758913326738, unsupervised loss ratio: 1.0, lr 0.021, 1228 pseu out of 3142 are correct, 0 correct by model, 0 correct by ema before train, 1312 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0016792407023742619, unsupervised loss ratio: 1.0, lr 0.021, 271 pseu out of 1788 are correct, 0 correct by model, 0 correct by ema before train, 438 by model during train, total 2665
Comm round 66 meta round 4 chosen client: [19, 0, 2, 12, 14]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.001640529757610355, unsupervised loss ratio: 1.0, lr 0.021, 121 pseu out of 3676 are correct, 0 correct by model, 0 correct by ema before train, 319 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9412662751820623 lr : 0.03
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0016663483111187816, unsupervised loss ratio: 1.0, lr 0.021, 271 pseu out of 1787 are correct, 0 correct by model, 0 correct by ema before train, 436 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0010497447352261387, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4835 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 5750
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0009468924280637028, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1262 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 2083
Comm round 66 meta round 5 chosen client: [12, 9, 17, 11, 16]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0010778690264689633, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 4935 are correct, 0 correct by model, 0 correct by ema before train, 31 by model during train, total 5750
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012987039097222602, unsupervised loss ratio: 1.0, lr 0.021, 45 pseu out of 800 are correct, 0 correct by model, 0 correct by ema before train, 55 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0009790957378806953, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4509 are correct, 0 correct by model, 0 correct by ema before train, 1091 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0013815236234222539, unsupervised loss ratio: 1.0, lr 0.021, 1849 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 1995 by model during train, total 4088
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0019332440512743398, unsupervised loss ratio: 1.0, lr 0.021, 337 pseu out of 2359 are correct, 0 correct by model, 0 correct by ema before train, 454 by model during train, total 3883
************ Loss Avg 0.03261912846125241, LR 0.03, Round 66 ends ************  

TEST Student: Epoch: 66

TEST AUROC: 0.717422, TEST Accus: 0.243815, TEST Pre: 0.167677, TEST Recall: 0.159408
Comm round 67 meta round 0 chosen client: [10, 14, 9, 13, 0]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0018081996782586492, unsupervised loss ratio: 1.0, lr 0.021, 598 pseu out of 2415 are correct, 0 correct by model, 0 correct by ema before train, 778 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0012519074424000626, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1280 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0014154288682793439, unsupervised loss ratio: 1.0, lr 0.021, 44 pseu out of 837 are correct, 0 correct by model, 0 correct by ema before train, 59 by model during train, total 1677
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00027928813160850934, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3598 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9700048261759232 lr : 0.03
Comm round 67 meta round 1 chosen client: [7, 10, 16, 0, 15]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001392409403426707, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2323 are correct, 0 correct by model, 0 correct by ema before train, 509 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0019245159647684417, unsupervised loss ratio: 1.0, lr 0.021, 590 pseu out of 2445 are correct, 0 correct by model, 0 correct by ema before train, 764 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002102038157019825, unsupervised loss ratio: 1.0, lr 0.021, 340 pseu out of 2411 are correct, 0 correct by model, 0 correct by ema before train, 480 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9150863715580532 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0016530834371224045, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3004 are correct, 0 correct by model, 0 correct by ema before train, 117 by model during train, total 4099
Comm round 67 meta round 2 chosen client: [13, 4, 12, 6, 11]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003198851660827285, unsupervised loss ratio: 1.0, lr 0.021, 2165 pseu out of 3629 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0014265342172057856, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2996 are correct, 0 correct by model, 0 correct by ema before train, 856 by model during train, total 3987
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013176198505486052, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4931 are correct, 0 correct by model, 0 correct by ema before train, 33 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001499954866670558, unsupervised loss ratio: 1.0, lr 0.021, 1231 pseu out of 3195 are correct, 0 correct by model, 0 correct by ema before train, 1303 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001617116783563688, unsupervised loss ratio: 1.0, lr 0.021, 1854 pseu out of 2858 are correct, 0 correct by model, 0 correct by ema before train, 1983 by model during train, total 4088
Comm round 67 meta round 3 chosen client: [6, 7, 17, 18, 1]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001477941081089818, unsupervised loss ratio: 1.0, lr 0.021, 1229 pseu out of 3188 are correct, 0 correct by model, 0 correct by ema before train, 1325 by model during train, total 4383
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001445416429375585, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2337 are correct, 0 correct by model, 0 correct by ema before train, 515 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0011561120480256177, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4545 are correct, 0 correct by model, 0 correct by ema before train, 1090 by model during train, total 5558
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0015800855956816424, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1373 are correct, 0 correct by model, 0 correct by ema before train, 610 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001742287781714212, unsupervised loss ratio: 1.0, lr 0.021, 636 pseu out of 1674 are correct, 0 correct by model, 0 correct by ema before train, 777 by model during train, total 2621
Comm round 67 meta round 4 chosen client: [13, 15, 7, 3, 8]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003031105935421646, unsupervised loss ratio: 1.0, lr 0.021, 2160 pseu out of 3623 are correct, 0 correct by model, 0 correct by ema before train, 2190 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0017186389513251645, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3036 are correct, 0 correct by model, 0 correct by ema before train, 135 by model during train, total 4099
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0014409770463736584, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2373 are correct, 0 correct by model, 0 correct by ema before train, 509 by model during train, total 3280
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0022574176218118475, unsupervised loss ratio: 1.0, lr 0.021, 74 pseu out of 2178 are correct, 0 correct by model, 0 correct by ema before train, 209 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011049856586851092, unsupervised loss ratio: 1.0, lr 0.021, 2298 pseu out of 3092 are correct, 0 correct by model, 0 correct by ema before train, 2340 by model during train, total 4036
Comm round 67 meta round 5 chosen client: [1, 11, 8, 17, 5]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0017784492697612178, unsupervised loss ratio: 1.0, lr 0.021, 634 pseu out of 1721 are correct, 0 correct by model, 0 correct by ema before train, 765 by model during train, total 2621
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001616525961253501, unsupervised loss ratio: 1.0, lr 0.021, 1847 pseu out of 2873 are correct, 0 correct by model, 0 correct by ema before train, 1998 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0011015299859167271, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3117 are correct, 0 correct by model, 0 correct by ema before train, 2341 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.001136658436902424, unsupervised loss ratio: 1.0, lr 0.021, 1062 pseu out of 4574 are correct, 0 correct by model, 0 correct by ema before train, 1087 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0016594450810130258, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2895 are correct, 0 correct by model, 0 correct by ema before train, 333 by model during train, total 3866
************ Loss Avg 0.06415395870811344, LR 0.03, Round 67 ends ************  

TEST Student: Epoch: 67

TEST AUROC: 0.744772, TEST Accus: 0.284726, TEST Pre: 0.166692, TEST Recall: 0.215220
Comm round 68 meta round 0 chosen client: [2, 8, 5, 1, 18]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0032072923717177695, unsupervised loss ratio: 1.0, lr 0.021, 283 pseu out of 1834 are correct, 0 correct by model, 0 correct by ema before train, 464 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016974656043142744, unsupervised loss ratio: 1.0, lr 0.021, 2309 pseu out of 3117 are correct, 0 correct by model, 0 correct by ema before train, 2341 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.003160440786188224, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2913 are correct, 0 correct by model, 0 correct by ema before train, 316 by model during train, total 3866
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0030788097405669893, unsupervised loss ratio: 1.0, lr 0.021, 633 pseu out of 1696 are correct, 0 correct by model, 0 correct by ema before train, 777 by model during train, total 2621
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0031095939921215177, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1387 are correct, 0 correct by model, 0 correct by ema before train, 611 by model during train, total 2298
Comm round 68 meta round 1 chosen client: [13, 17, 11, 18, 10]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0007596692821145121, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3632 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002183254446229501, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4635 are correct, 0 correct by model, 0 correct by ema before train, 1097 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002491954277502373, unsupervised loss ratio: 1.0, lr 0.021, 1861 pseu out of 2877 are correct, 0 correct by model, 0 correct by ema before train, 2008 by model during train, total 4088
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002809539259437265, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1401 are correct, 0 correct by model, 0 correct by ema before train, 608 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00302505669894564, unsupervised loss ratio: 1.0, lr 0.021, 603 pseu out of 2437 are correct, 0 correct by model, 0 correct by ema before train, 771 by model during train, total 3684
Comm round 68 meta round 2 chosen client: [18, 1, 4, 12, 2]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002802733943099156, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1352 are correct, 0 correct by model, 0 correct by ema before train, 633 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0031320099951699376, unsupervised loss ratio: 1.0, lr 0.021, 635 pseu out of 1705 are correct, 0 correct by model, 0 correct by ema before train, 787 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002526531633477481, unsupervised loss ratio: 1.0, lr 0.021, 708 pseu out of 3022 are correct, 0 correct by model, 0 correct by ema before train, 869 by model during train, total 3987
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002644683440707417, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4947 are correct, 0 correct by model, 0 correct by ema before train, 34 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0031878326858748637, unsupervised loss ratio: 1.0, lr 0.021, 274 pseu out of 1787 are correct, 0 correct by model, 0 correct by ema before train, 459 by model during train, total 2665
Comm round 68 meta round 3 chosen client: [15, 11, 9, 19, 0]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0029413007850122926, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3052 are correct, 0 correct by model, 0 correct by ema before train, 121 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0024710316229175078, unsupervised loss ratio: 1.0, lr 0.021, 1857 pseu out of 2873 are correct, 0 correct by model, 0 correct by ema before train, 1998 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.003107243919253556, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 859 are correct, 0 correct by model, 0 correct by ema before train, 63 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003347390068647189, unsupervised loss ratio: 1.0, lr 0.021, 140 pseu out of 3704 are correct, 0 correct by model, 0 correct by ema before train, 336 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8792924272770785 lr : 0.03
Comm round 68 meta round 4 chosen client: [13, 15, 9, 2, 8]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006991435881700146, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3624 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002785630602850758, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 3053 are correct, 0 correct by model, 0 correct by ema before train, 143 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002924949855056453, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 850 are correct, 0 correct by model, 0 correct by ema before train, 61 by model during train, total 1677
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003087063297806751, unsupervised loss ratio: 1.0, lr 0.021, 279 pseu out of 1804 are correct, 0 correct by model, 0 correct by ema before train, 461 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016630417342611281, unsupervised loss ratio: 1.0, lr 0.021, 2300 pseu out of 3095 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Comm round 68 meta round 5 chosen client: [3, 7, 2, 18, 17]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003666546501335688, unsupervised loss ratio: 1.0, lr 0.021, 74 pseu out of 2144 are correct, 0 correct by model, 0 correct by ema before train, 207 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003121303382683366, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2382 are correct, 0 correct by model, 0 correct by ema before train, 511 by model during train, total 3280
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0031708776230169903, unsupervised loss ratio: 1.0, lr 0.021, 283 pseu out of 1757 are correct, 0 correct by model, 0 correct by ema before train, 453 by model during train, total 2665
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0027020160018259454, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1378 are correct, 0 correct by model, 0 correct by ema before train, 610 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0020782566714989043, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4532 are correct, 0 correct by model, 0 correct by ema before train, 1090 by model during train, total 5558
************ Loss Avg 0.0318958363696294, LR 0.03, Round 68 ends ************  

TEST Student: Epoch: 68

TEST AUROC: 0.735823, TEST Accus: 0.271051, TEST Pre: 0.171734, TEST Recall: 0.195787
Comm round 69 meta round 0 chosen client: [0, 6, 1, 9, 10]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9184769477163043 lr : 0.03
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002107941519394787, unsupervised loss ratio: 1.0, lr 0.021, 1232 pseu out of 3205 are correct, 0 correct by model, 0 correct by ema before train, 1317 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002418335461875469, unsupervised loss ratio: 1.0, lr 0.021, 642 pseu out of 1702 are correct, 0 correct by model, 0 correct by ema before train, 788 by model during train, total 2621
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0021887829239454325, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 879 are correct, 0 correct by model, 0 correct by ema before train, 60 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002463925105985254, unsupervised loss ratio: 1.0, lr 0.021, 611 pseu out of 2451 are correct, 0 correct by model, 0 correct by ema before train, 790 by model during train, total 3684
Comm round 69 meta round 1 chosen client: [1, 14, 10, 6, 19]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002459064177123875, unsupervised loss ratio: 1.0, lr 0.021, 641 pseu out of 1743 are correct, 0 correct by model, 0 correct by ema before train, 774 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019958341109679277, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1323 are correct, 0 correct by model, 0 correct by ema before train, 36 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0025083988640007787, unsupervised loss ratio: 1.0, lr 0.021, 602 pseu out of 2437 are correct, 0 correct by model, 0 correct by ema before train, 805 by model during train, total 3684
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0020810725843108703, unsupervised loss ratio: 1.0, lr 0.021, 1229 pseu out of 3184 are correct, 0 correct by model, 0 correct by ema before train, 1328 by model during train, total 4383
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0026030581603453565, unsupervised loss ratio: 1.0, lr 0.021, 130 pseu out of 3638 are correct, 0 correct by model, 0 correct by ema before train, 342 by model during train, total 4949
Comm round 69 meta round 2 chosen client: [14, 4, 18, 3, 11]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0020109035346346595, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1340 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001956841714369754, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2977 are correct, 0 correct by model, 0 correct by ema before train, 883 by model during train, total 3987
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0022476134116813126, unsupervised loss ratio: 1.0, lr 0.021, 536 pseu out of 1358 are correct, 0 correct by model, 0 correct by ema before train, 614 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002937604367096875, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 2168 are correct, 0 correct by model, 0 correct by ema before train, 219 by model during train, total 3526
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0019792429102380993, unsupervised loss ratio: 1.0, lr 0.021, 1864 pseu out of 2853 are correct, 0 correct by model, 0 correct by ema before train, 2023 by model during train, total 4088
Comm round 69 meta round 3 chosen client: [9, 10, 4, 3, 0]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00220131860826061, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 894 are correct, 0 correct by model, 0 correct by ema before train, 63 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0023985541192814708, unsupervised loss ratio: 1.0, lr 0.021, 613 pseu out of 2431 are correct, 0 correct by model, 0 correct by ema before train, 803 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0019664193491085564, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2944 are correct, 0 correct by model, 0 correct by ema before train, 879 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0028752695127747885, unsupervised loss ratio: 1.0, lr 0.021, 75 pseu out of 2181 are correct, 0 correct by model, 0 correct by ema before train, 217 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8763009808501419 lr : 0.03
Comm round 69 meta round 4 chosen client: [11, 13, 3, 14, 12]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00208267707239429, unsupervised loss ratio: 1.0, lr 0.021, 1867 pseu out of 2879 are correct, 0 correct by model, 0 correct by ema before train, 2022 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005043926860291661, unsupervised loss ratio: 1.0, lr 0.021, 2162 pseu out of 3612 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0029638811408533782, unsupervised loss ratio: 1.0, lr 0.021, 85 pseu out of 2203 are correct, 0 correct by model, 0 correct by ema before train, 232 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019834670167642107, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1348 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002009266053210013, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4898 are correct, 0 correct by model, 0 correct by ema before train, 47 by model during train, total 5750
Comm round 69 meta round 5 chosen client: [7, 9, 14, 6, 8]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0022241586095613176, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2360 are correct, 0 correct by model, 0 correct by ema before train, 524 by model during train, total 3280
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0022978242066326654, unsupervised loss ratio: 1.0, lr 0.021, 48 pseu out of 907 are correct, 0 correct by model, 0 correct by ema before train, 57 by model during train, total 1677
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0020353303213293352, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1359 are correct, 0 correct by model, 0 correct by ema before train, 44 by model during train, total 2083
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0021141868108289614, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 3185 are correct, 0 correct by model, 0 correct by ema before train, 1330 by model during train, total 4383
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013573503847510437, unsupervised loss ratio: 1.0, lr 0.021, 2310 pseu out of 3115 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
************ Loss Avg 0.06185835477680655, LR 0.03, Round 69 ends ************  

TEST Student: Epoch: 69

TEST AUROC: 0.745994, TEST Accus: 0.288722, TEST Pre: 0.171593, TEST Recall: 0.221641
Comm round 70 meta round 0 chosen client: [17, 10, 18, 16, 2]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021063003210008316, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4531 are correct, 0 correct by model, 0 correct by ema before train, 1098 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002853006694530105, unsupervised loss ratio: 1.0, lr 0.021, 617 pseu out of 2440 are correct, 0 correct by model, 0 correct by ema before train, 836 by model during train, total 3684
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028385143022104683, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1352 are correct, 0 correct by model, 0 correct by ema before train, 629 by model during train, total 2298
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0034463905069030453, unsupervised loss ratio: 1.0, lr 0.021, 344 pseu out of 2394 are correct, 0 correct by model, 0 correct by ema before train, 477 by model during train, total 3883
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029644056561491674, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 1780 are correct, 0 correct by model, 0 correct by ema before train, 461 by model during train, total 2665
Comm round 70 meta round 1 chosen client: [19, 9, 12, 18, 16]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003208919266352239, unsupervised loss ratio: 1.0, lr 0.021, 138 pseu out of 3658 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0030638835138503324, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 903 are correct, 0 correct by model, 0 correct by ema before train, 66 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002627557880219279, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 4917 are correct, 0 correct by model, 0 correct by ema before train, 47 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028859016116863736, unsupervised loss ratio: 1.0, lr 0.021, 543 pseu out of 1359 are correct, 0 correct by model, 0 correct by ema before train, 622 by model during train, total 2298
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0035587777402709985, unsupervised loss ratio: 1.0, lr 0.021, 351 pseu out of 2400 are correct, 0 correct by model, 0 correct by ema before train, 474 by model during train, total 3883
Comm round 70 meta round 2 chosen client: [1, 8, 7, 10, 3]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00297560045643278, unsupervised loss ratio: 1.0, lr 0.021, 642 pseu out of 1690 are correct, 0 correct by model, 0 correct by ema before train, 779 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016818791805235378, unsupervised loss ratio: 1.0, lr 0.021, 2300 pseu out of 3116 are correct, 0 correct by model, 0 correct by ema before train, 2342 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002979850039432327, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2313 are correct, 0 correct by model, 0 correct by ema before train, 519 by model during train, total 3280
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0028932731185140536, unsupervised loss ratio: 1.0, lr 0.021, 618 pseu out of 2428 are correct, 0 correct by model, 0 correct by ema before train, 818 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0036261413234959555, unsupervised loss ratio: 1.0, lr 0.021, 83 pseu out of 2153 are correct, 0 correct by model, 0 correct by ema before train, 227 by model during train, total 3526
Comm round 70 meta round 3 chosen client: [9, 5, 10, 4, 17]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0029634565521350683, unsupervised loss ratio: 1.0, lr 0.021, 48 pseu out of 937 are correct, 0 correct by model, 0 correct by ema before train, 68 by model during train, total 1677
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0029436110186802805, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2928 are correct, 0 correct by model, 0 correct by ema before train, 324 by model during train, total 3866
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027873685105768, unsupervised loss ratio: 1.0, lr 0.021, 621 pseu out of 2401 are correct, 0 correct by model, 0 correct by ema before train, 832 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002491957355578918, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2940 are correct, 0 correct by model, 0 correct by ema before train, 882 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021119572847128855, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4497 are correct, 0 correct by model, 0 correct by ema before train, 1095 by model during train, total 5558
Comm round 70 meta round 4 chosen client: [2, 15, 13, 6, 4]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002894992083643696, unsupervised loss ratio: 1.0, lr 0.021, 289 pseu out of 1775 are correct, 0 correct by model, 0 correct by ema before train, 484 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002836836138829732, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3027 are correct, 0 correct by model, 0 correct by ema before train, 136 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006641983821636887, unsupervised loss ratio: 1.0, lr 0.021, 2159 pseu out of 3619 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002723012147370078, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 3216 are correct, 0 correct by model, 0 correct by ema before train, 1328 by model during train, total 4383
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0024512129778500704, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2962 are correct, 0 correct by model, 0 correct by ema before train, 879 by model during train, total 3987
Comm round 70 meta round 5 chosen client: [13, 2, 12, 3, 8]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006559954886374033, unsupervised loss ratio: 1.0, lr 0.021, 2165 pseu out of 3626 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029388364526398833, unsupervised loss ratio: 1.0, lr 0.021, 299 pseu out of 1763 are correct, 0 correct by model, 0 correct by ema before train, 468 by model during train, total 2665
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002657584912635179, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 4858 are correct, 0 correct by model, 0 correct by ema before train, 63 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0035397233243981774, unsupervised loss ratio: 1.0, lr 0.021, 81 pseu out of 2139 are correct, 0 correct by model, 0 correct by ema before train, 244 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001628782256986483, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3075 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
************ Loss Avg 0.0026666642166136615, LR 0.03, Round 70 ends ************  

TEST Student: Epoch: 70

TEST AUROC: 0.713775, TEST Accus: 0.239705, TEST Pre: 0.185770, TEST Recall: 0.154896
Comm round 71 meta round 0 chosen client: [8, 16, 9, 17, 11]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0010406369639213153, unsupervised loss ratio: 1.0, lr 0.021, 2307 pseu out of 3142 are correct, 0 correct by model, 0 correct by ema before train, 2345 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0019303935047498613, unsupervised loss ratio: 1.0, lr 0.021, 348 pseu out of 2410 are correct, 0 correct by model, 0 correct by ema before train, 491 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012014436468706226, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 927 are correct, 0 correct by model, 0 correct by ema before train, 68 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010501740104920264, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4541 are correct, 0 correct by model, 0 correct by ema before train, 1088 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015440447386936285, unsupervised loss ratio: 1.0, lr 0.021, 1873 pseu out of 2889 are correct, 0 correct by model, 0 correct by ema before train, 2028 by model during train, total 4088
Comm round 71 meta round 1 chosen client: [15, 19, 5, 9, 17]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0015533056931767183, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 2993 are correct, 0 correct by model, 0 correct by ema before train, 149 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0016652299384123837, unsupervised loss ratio: 1.0, lr 0.021, 151 pseu out of 3632 are correct, 0 correct by model, 0 correct by ema before train, 366 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0013605402291134061, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2883 are correct, 0 correct by model, 0 correct by ema before train, 332 by model during train, total 3866
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0013290900765073107, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 946 are correct, 0 correct by model, 0 correct by ema before train, 63 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010327218728000834, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4590 are correct, 0 correct by model, 0 correct by ema before train, 1095 by model during train, total 5558
Comm round 71 meta round 2 chosen client: [0, 18, 16, 17, 5]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9047472464795016 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0015804024523175838, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1379 are correct, 0 correct by model, 0 correct by ema before train, 631 by model during train, total 2298
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002023472401053935, unsupervised loss ratio: 1.0, lr 0.021, 352 pseu out of 2469 are correct, 0 correct by model, 0 correct by ema before train, 484 by model during train, total 3883
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0010763075578711584, unsupervised loss ratio: 1.0, lr 0.021, 1063 pseu out of 4621 are correct, 0 correct by model, 0 correct by ema before train, 1092 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0014407951575627581, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 2937 are correct, 0 correct by model, 0 correct by ema before train, 328 by model during train, total 3866
Comm round 71 meta round 3 chosen client: [6, 11, 15, 3, 0]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001339395213332297, unsupervised loss ratio: 1.0, lr 0.021, 1228 pseu out of 3201 are correct, 0 correct by model, 0 correct by ema before train, 1336 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015664327447666437, unsupervised loss ratio: 1.0, lr 0.021, 1882 pseu out of 2945 are correct, 0 correct by model, 0 correct by ema before train, 2038 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.001604981528837995, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 3077 are correct, 0 correct by model, 0 correct by ema before train, 158 by model during train, total 4099
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002101066668858818, unsupervised loss ratio: 1.0, lr 0.021, 86 pseu out of 2162 are correct, 0 correct by model, 0 correct by ema before train, 251 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9410959226744515 lr : 0.03
Comm round 71 meta round 4 chosen client: [1, 5, 15, 0, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0015848245934537816, unsupervised loss ratio: 1.0, lr 0.021, 636 pseu out of 1739 are correct, 0 correct by model, 0 correct by ema before train, 795 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0014811263435909555, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 2965 are correct, 0 correct by model, 0 correct by ema before train, 329 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0015569087277631647, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 3093 are correct, 0 correct by model, 0 correct by ema before train, 142 by model during train, total 4099
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9484786829169916 lr : 0.03
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0017743018064980528, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 1790 are correct, 0 correct by model, 0 correct by ema before train, 478 by model during train, total 2665
Comm round 71 meta round 5 chosen client: [6, 3, 14, 13, 0]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0014723024029028265, unsupervised loss ratio: 1.0, lr 0.021, 1231 pseu out of 3231 are correct, 0 correct by model, 0 correct by ema before train, 1341 by model during train, total 4383
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002129304887473284, unsupervised loss ratio: 1.0, lr 0.021, 85 pseu out of 2253 are correct, 0 correct by model, 0 correct by ema before train, 209 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0010565174134998497, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1353 are correct, 0 correct by model, 0 correct by ema before train, 40 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002415066778435869, unsupervised loss ratio: 1.0, lr 0.021, 2164 pseu out of 3619 are correct, 0 correct by model, 0 correct by ema before train, 2194 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.9565468004771641 lr : 0.03
************ Loss Avg 0.12628686266001576, LR 0.03, Round 71 ends ************  

TEST Student: Epoch: 71

TEST AUROC: 0.780224, TEST Accus: 0.345652, TEST Pre: 0.183854, TEST Recall: 0.297224
Comm round 72 meta round 0 chosen client: [5, 19, 6, 7, 4]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.006093643304174308, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2950 are correct, 0 correct by model, 0 correct by ema before train, 332 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.006627640083957559, unsupervised loss ratio: 1.0, lr 0.021, 164 pseu out of 3608 are correct, 0 correct by model, 0 correct by ema before train, 388 by model during train, total 4949
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.005249942539840181, unsupervised loss ratio: 1.0, lr 0.021, 1230 pseu out of 3221 are correct, 0 correct by model, 0 correct by ema before train, 1337 by model during train, total 4383
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0063015906120059435, unsupervised loss ratio: 1.0, lr 0.021, 495 pseu out of 2326 are correct, 0 correct by model, 0 correct by ema before train, 527 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0043200659122140635, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 2906 are correct, 0 correct by model, 0 correct by ema before train, 918 by model during train, total 3987
Comm round 72 meta round 1 chosen client: [15, 0, 14, 8, 2]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0054985977559296705, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 3054 are correct, 0 correct by model, 0 correct by ema before train, 136 by model during train, total 4099
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8229175301230683 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.006485932040959597, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1374 are correct, 0 correct by model, 0 correct by ema before train, 39 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0028583158648700646, unsupervised loss ratio: 1.0, lr 0.021, 2305 pseu out of 3095 are correct, 0 correct by model, 0 correct by ema before train, 2344 by model during train, total 4036
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005889657125364812, unsupervised loss ratio: 1.0, lr 0.021, 307 pseu out of 1777 are correct, 0 correct by model, 0 correct by ema before train, 490 by model during train, total 2665
Comm round 72 meta round 2 chosen client: [15, 18, 2, 5, 9]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0051244567446142005, unsupervised loss ratio: 1.0, lr 0.021, 8 pseu out of 2927 are correct, 0 correct by model, 0 correct by ema before train, 164 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.005457318763041662, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1330 are correct, 0 correct by model, 0 correct by ema before train, 640 by model during train, total 2298
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005431827994817425, unsupervised loss ratio: 1.0, lr 0.021, 299 pseu out of 1734 are correct, 0 correct by model, 0 correct by ema before train, 490 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.005626210173759915, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2821 are correct, 0 correct by model, 0 correct by ema before train, 333 by model during train, total 3866
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.006650244114334109, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 956 are correct, 0 correct by model, 0 correct by ema before train, 64 by model during train, total 1677
Comm round 72 meta round 3 chosen client: [3, 10, 16, 19, 5]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.006923453705634789, unsupervised loss ratio: 1.0, lr 0.021, 80 pseu out of 2178 are correct, 0 correct by model, 0 correct by ema before train, 237 by model during train, total 3526
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.005021468278598683, unsupervised loss ratio: 1.0, lr 0.021, 626 pseu out of 2353 are correct, 0 correct by model, 0 correct by ema before train, 843 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.006810574357199376, unsupervised loss ratio: 1.0, lr 0.021, 357 pseu out of 2416 are correct, 0 correct by model, 0 correct by ema before train, 493 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.006047909029383356, unsupervised loss ratio: 1.0, lr 0.021, 182 pseu out of 3428 are correct, 0 correct by model, 0 correct by ema before train, 452 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00551261259510075, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 2767 are correct, 0 correct by model, 0 correct by ema before train, 336 by model during train, total 3866
Comm round 72 meta round 4 chosen client: [13, 19, 0, 6, 9]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0018182502925332825, unsupervised loss ratio: 1.0, lr 0.021, 2160 pseu out of 3626 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005793909037796159, unsupervised loss ratio: 1.0, lr 0.021, 192 pseu out of 3290 are correct, 0 correct by model, 0 correct by ema before train, 479 by model during train, total 4949
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8239579383207827 lr : 0.03
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.004894919258177928, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 3075 are correct, 0 correct by model, 0 correct by ema before train, 1352 by model during train, total 4383
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.006280183061284738, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 966 are correct, 0 correct by model, 0 correct by ema before train, 70 by model during train, total 1677
Comm round 72 meta round 5 chosen client: [8, 13, 16, 5, 17]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002680957599523026, unsupervised loss ratio: 1.0, lr 0.021, 2290 pseu out of 3030 are correct, 0 correct by model, 0 correct by ema before train, 2339 by model during train, total 4036
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0016930235374197995, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3595 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0061297991855039455, unsupervised loss ratio: 1.0, lr 0.021, 360 pseu out of 2319 are correct, 0 correct by model, 0 correct by ema before train, 513 by model during train, total 3883
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.005472752870610136, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2697 are correct, 0 correct by model, 0 correct by ema before train, 348 by model during train, total 3866
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.004322929481772342, unsupervised loss ratio: 1.0, lr 0.021, 1062 pseu out of 4604 are correct, 0 correct by model, 0 correct by ema before train, 1091 by model during train, total 5558
************ Loss Avg 0.05979645512547575, LR 0.03, Round 72 ends ************  

TEST Student: Epoch: 72

TEST AUROC: 0.767331, TEST Accus: 0.323486, TEST Pre: 0.180674, TEST Recall: 0.268147
Comm round 73 meta round 0 chosen client: [16, 6, 0, 7, 18]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0044585091680227245, unsupervised loss ratio: 1.0, lr 0.021, 371 pseu out of 2272 are correct, 0 correct by model, 0 correct by ema before train, 521 by model during train, total 3883
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.003407377888030116, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 3023 are correct, 0 correct by model, 0 correct by ema before train, 1358 by model during train, total 4383
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8348414186312227 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.004190480850341443, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2277 are correct, 0 correct by model, 0 correct by ema before train, 538 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003681613378123277, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1367 are correct, 0 correct by model, 0 correct by ema before train, 633 by model during train, total 2298
Comm round 73 meta round 1 chosen client: [4, 0, 9, 15, 13]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028806394843813327, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2832 are correct, 0 correct by model, 0 correct by ema before train, 925 by model during train, total 3987
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8037551209634665 lr : 0.03
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.004036394695975576, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 955 are correct, 0 correct by model, 0 correct by ema before train, 76 by model during train, total 1677
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0036633775436292547, unsupervised loss ratio: 1.0, lr 0.021, 9 pseu out of 2920 are correct, 0 correct by model, 0 correct by ema before train, 176 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0009741321071919243, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3595 are correct, 0 correct by model, 0 correct by ema before train, 2190 by model during train, total 3739
Comm round 73 meta round 2 chosen client: [5, 7, 19, 6, 4]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0037639295876972746, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 2573 are correct, 0 correct by model, 0 correct by ema before train, 352 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.004115925159287424, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2232 are correct, 0 correct by model, 0 correct by ema before train, 544 by model during train, total 3280
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0041296546039983435, unsupervised loss ratio: 1.0, lr 0.021, 205 pseu out of 3233 are correct, 0 correct by model, 0 correct by ema before train, 498 by model during train, total 4949
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0033979062404335086, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 2981 are correct, 0 correct by model, 0 correct by ema before train, 1358 by model during train, total 4383
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0030313122773631697, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 2845 are correct, 0 correct by model, 0 correct by ema before train, 905 by model during train, total 3987
Comm round 73 meta round 3 chosen client: [13, 16, 1, 10, 15]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00102230168877059, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3584 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004336370172391295, unsupervised loss ratio: 1.0, lr 0.021, 382 pseu out of 2227 are correct, 0 correct by model, 0 correct by ema before train, 551 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00428018568469802, unsupervised loss ratio: 1.0, lr 0.021, 643 pseu out of 1696 are correct, 0 correct by model, 0 correct by ema before train, 794 by model during train, total 2621
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0035262817199791558, unsupervised loss ratio: 1.0, lr 0.021, 637 pseu out of 2356 are correct, 0 correct by model, 0 correct by ema before train, 870 by model during train, total 3684
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0036064602610097678, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 2881 are correct, 0 correct by model, 0 correct by ema before train, 177 by model during train, total 4099
Comm round 73 meta round 4 chosen client: [6, 16, 3, 5, 19]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0033732884355982683, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 2897 are correct, 0 correct by model, 0 correct by ema before train, 1365 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004326398625634, unsupervised loss ratio: 1.0, lr 0.021, 396 pseu out of 2201 are correct, 0 correct by model, 0 correct by ema before train, 556 by model during train, total 3883
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004663731705867187, unsupervised loss ratio: 1.0, lr 0.021, 98 pseu out of 2090 are correct, 0 correct by model, 0 correct by ema before train, 276 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0037383320416919277, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2564 are correct, 0 correct by model, 0 correct by ema before train, 348 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.004145169951535093, unsupervised loss ratio: 1.0, lr 0.021, 222 pseu out of 3131 are correct, 0 correct by model, 0 correct by ema before train, 575 by model during train, total 4949
Comm round 73 meta round 5 chosen client: [11, 15, 16, 14, 9]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003295313928902033, unsupervised loss ratio: 1.0, lr 0.021, 1884 pseu out of 2901 are correct, 0 correct by model, 0 correct by ema before train, 2033 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0037209970601207506, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 198 by model during train, total 4099
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004290110618639432, unsupervised loss ratio: 1.0, lr 0.021, 407 pseu out of 2189 are correct, 0 correct by model, 0 correct by ema before train, 561 by model during train, total 3883
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.003809372298278366, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1365 are correct, 0 correct by model, 0 correct by ema before train, 41 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.004223931759716598, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 919 are correct, 0 correct by model, 0 correct by ema before train, 78 by model during train, total 1677
************ Loss Avg 0.05802286795106658, LR 0.03, Round 73 ends ************  

TEST Student: Epoch: 73

TEST AUROC: 0.763596, TEST Accus: 0.317763, TEST Pre: 0.183909, TEST Recall: 0.259797
Comm round 74 meta round 0 chosen client: [17, 13, 18, 15, 2]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0025646765970614278, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4486 are correct, 0 correct by model, 0 correct by ema before train, 1089 by model during train, total 5558
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0008115456395159018, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3574 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0034222390903677377, unsupervised loss ratio: 1.0, lr 0.021, 543 pseu out of 1365 are correct, 0 correct by model, 0 correct by ema before train, 641 by model during train, total 2298
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0032149368225453563, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 2777 are correct, 0 correct by model, 0 correct by ema before train, 201 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0034840458399793576, unsupervised loss ratio: 1.0, lr 0.021, 314 pseu out of 1752 are correct, 0 correct by model, 0 correct by ema before train, 511 by model during train, total 2665
Comm round 74 meta round 1 chosen client: [6, 15, 4, 17, 12]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0031346342850314536, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 2900 are correct, 0 correct by model, 0 correct by ema before train, 1393 by model during train, total 4383
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003265224870525484, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2806 are correct, 0 correct by model, 0 correct by ema before train, 201 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00283697629596905, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2822 are correct, 0 correct by model, 0 correct by ema before train, 928 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0025197080993521743, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4409 are correct, 0 correct by model, 0 correct by ema before train, 1100 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.003608089906629175, unsupervised loss ratio: 1.0, lr 0.021, 10 pseu out of 4788 are correct, 0 correct by model, 0 correct by ema before train, 61 by model during train, total 5750
Comm round 74 meta round 2 chosen client: [12, 11, 14, 13, 3]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.003571326753848957, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 4741 are correct, 0 correct by model, 0 correct by ema before train, 86 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002744216770224739, unsupervised loss ratio: 1.0, lr 0.021, 1885 pseu out of 2853 are correct, 0 correct by model, 0 correct by ema before train, 2043 by model during train, total 4088
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0035414364061910997, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1364 are correct, 0 correct by model, 0 correct by ema before train, 48 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0008357656935636365, unsupervised loss ratio: 1.0, lr 0.021, 2165 pseu out of 3559 are correct, 0 correct by model, 0 correct by ema before train, 2190 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004344243148807436, unsupervised loss ratio: 1.0, lr 0.021, 101 pseu out of 2053 are correct, 0 correct by model, 0 correct by ema before train, 293 by model during train, total 3526
Comm round 74 meta round 3 chosen client: [10, 3, 17, 19, 2]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.003324703132765817, unsupervised loss ratio: 1.0, lr 0.021, 646 pseu out of 2373 are correct, 0 correct by model, 0 correct by ema before train, 896 by model during train, total 3684
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004282997537952075, unsupervised loss ratio: 1.0, lr 0.021, 101 pseu out of 2059 are correct, 0 correct by model, 0 correct by ema before train, 273 by model during train, total 3526
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002584133904705616, unsupervised loss ratio: 1.0, lr 0.021, 1062 pseu out of 4428 are correct, 0 correct by model, 0 correct by ema before train, 1101 by model during train, total 5558
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0037240151861437764, unsupervised loss ratio: 1.0, lr 0.021, 215 pseu out of 3072 are correct, 0 correct by model, 0 correct by ema before train, 597 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0032957116906930295, unsupervised loss ratio: 1.0, lr 0.021, 310 pseu out of 1697 are correct, 0 correct by model, 0 correct by ema before train, 522 by model during train, total 2665
Comm round 74 meta round 4 chosen client: [8, 3, 17, 0, 4]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0017921375301739317, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 3017 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004236586213145139, unsupervised loss ratio: 1.0, lr 0.021, 105 pseu out of 2012 are correct, 0 correct by model, 0 correct by ema before train, 270 by model during train, total 3526
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0025922924289533376, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4378 are correct, 0 correct by model, 0 correct by ema before train, 1102 by model during train, total 5558
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8551569477635987 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028364027675706893, unsupervised loss ratio: 1.0, lr 0.021, 712 pseu out of 2802 are correct, 0 correct by model, 0 correct by ema before train, 939 by model during train, total 3987
Comm round 74 meta round 5 chosen client: [11, 9, 1, 4, 17]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002766021118077333, unsupervised loss ratio: 1.0, lr 0.021, 1896 pseu out of 2846 are correct, 0 correct by model, 0 correct by ema before train, 2053 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0037326176879341126, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 940 are correct, 0 correct by model, 0 correct by ema before train, 80 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003738361126856833, unsupervised loss ratio: 1.0, lr 0.021, 650 pseu out of 1703 are correct, 0 correct by model, 0 correct by ema before train, 820 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0027992650173560138, unsupervised loss ratio: 1.0, lr 0.021, 715 pseu out of 2774 are correct, 0 correct by model, 0 correct by ema before train, 963 by model during train, total 3987
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0025464315342063875, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4331 are correct, 0 correct by model, 0 correct by ema before train, 1097 by model during train, total 5558
************ Loss Avg 0.03144358969532487, LR 0.03, Round 74 ends ************  

TEST Student: Epoch: 74

TEST AUROC: 0.745520, TEST Accus: 0.288414, TEST Pre: 0.200227, TEST Recall: 0.219725
Comm round 75 meta round 0 chosen client: [9, 12, 18, 5, 19]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0023756406153552234, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 944 are correct, 0 correct by model, 0 correct by ema before train, 75 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002172584829127623, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 4660 are correct, 0 correct by model, 0 correct by ema before train, 78 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002300611299385006, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 1338 are correct, 0 correct by model, 0 correct by ema before train, 655 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0024522539260644527, unsupervised loss ratio: 1.0, lr 0.021, 289 pseu out of 2549 are correct, 0 correct by model, 0 correct by ema before train, 346 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0027726531612316673, unsupervised loss ratio: 1.0, lr 0.021, 239 pseu out of 3112 are correct, 0 correct by model, 0 correct by ema before train, 624 by model during train, total 4949
Comm round 75 meta round 1 chosen client: [8, 17, 4, 5, 18]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014168188511849422, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 3045 are correct, 0 correct by model, 0 correct by ema before train, 2342 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0018026700702324595, unsupervised loss ratio: 1.0, lr 0.021, 1053 pseu out of 4326 are correct, 0 correct by model, 0 correct by ema before train, 1104 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001958588493936178, unsupervised loss ratio: 1.0, lr 0.021, 704 pseu out of 2815 are correct, 0 correct by model, 0 correct by ema before train, 936 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0024766348890166304, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2583 are correct, 0 correct by model, 0 correct by ema before train, 352 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0024083569458323633, unsupervised loss ratio: 1.0, lr 0.021, 540 pseu out of 1343 are correct, 0 correct by model, 0 correct by ema before train, 651 by model during train, total 2298
Comm round 75 meta round 2 chosen client: [7, 19, 15, 4, 6]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00233055730327928, unsupervised loss ratio: 1.0, lr 0.021, 492 pseu out of 2195 are correct, 0 correct by model, 0 correct by ema before train, 539 by model during train, total 3280
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002863662648358, unsupervised loss ratio: 1.0, lr 0.021, 233 pseu out of 3125 are correct, 0 correct by model, 0 correct by ema before train, 613 by model during train, total 4949
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0023952096760625026, unsupervised loss ratio: 1.0, lr 0.021, 11 pseu out of 2754 are correct, 0 correct by model, 0 correct by ema before train, 216 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0021082526156013565, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 2791 are correct, 0 correct by model, 0 correct by ema before train, 952 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002125089115841125, unsupervised loss ratio: 1.0, lr 0.021, 1223 pseu out of 2839 are correct, 0 correct by model, 0 correct by ema before train, 1378 by model during train, total 4383
Comm round 75 meta round 3 chosen client: [9, 3, 13, 15, 14]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002257383598825308, unsupervised loss ratio: 1.0, lr 0.021, 46 pseu out of 985 are correct, 0 correct by model, 0 correct by ema before train, 81 by model during train, total 1677
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0031834002194435535, unsupervised loss ratio: 1.0, lr 0.021, 129 pseu out of 2056 are correct, 0 correct by model, 0 correct by ema before train, 305 by model during train, total 3526
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00048290036253185184, unsupervised loss ratio: 1.0, lr 0.021, 2152 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002447765243358355, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2806 are correct, 0 correct by model, 0 correct by ema before train, 212 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0019843355738416767, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1357 are correct, 0 correct by model, 0 correct by ema before train, 50 by model during train, total 2083
Comm round 75 meta round 4 chosen client: [7, 12, 19, 8, 3]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0024571430202251156, unsupervised loss ratio: 1.0, lr 0.021, 491 pseu out of 2212 are correct, 0 correct by model, 0 correct by ema before train, 550 by model during train, total 3280
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002239709027344361, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 4667 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 5750
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002737876675942411, unsupervised loss ratio: 1.0, lr 0.021, 252 pseu out of 3106 are correct, 0 correct by model, 0 correct by ema before train, 658 by model during train, total 4949
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014780129639575534, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3048 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003333926188263701, unsupervised loss ratio: 1.0, lr 0.021, 117 pseu out of 2037 are correct, 0 correct by model, 0 correct by ema before train, 288 by model during train, total 3526
Comm round 75 meta round 5 chosen client: [16, 0, 19, 15, 12]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002792195913183396, unsupervised loss ratio: 1.0, lr 0.021, 406 pseu out of 2166 are correct, 0 correct by model, 0 correct by ema before train, 589 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8469584730206704 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00276507320216833, unsupervised loss ratio: 1.0, lr 0.021, 249 pseu out of 3120 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 4949
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0025261028861747878, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 2777 are correct, 0 correct by model, 0 correct by ema before train, 223 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002297119742595694, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 4657 are correct, 0 correct by model, 0 correct by ema before train, 110 by model during train, total 5750
************ Loss Avg 0.030463366735967844, LR 0.03, Round 75 ends ************  

TEST Student: Epoch: 75

TEST AUROC: 0.736894, TEST Accus: 0.275814, TEST Pre: 0.206780, TEST Recall: 0.201608
Comm round 76 meta round 0 chosen client: [10, 16, 19, 2, 17]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0021632944900092893, unsupervised loss ratio: 1.0, lr 0.021, 633 pseu out of 2338 are correct, 0 correct by model, 0 correct by ema before train, 891 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002806520940674866, unsupervised loss ratio: 1.0, lr 0.021, 414 pseu out of 2208 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002593844872488915, unsupervised loss ratio: 1.0, lr 0.021, 248 pseu out of 3145 are correct, 0 correct by model, 0 correct by ema before train, 632 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0022157450827459493, unsupervised loss ratio: 1.0, lr 0.021, 312 pseu out of 1744 are correct, 0 correct by model, 0 correct by ema before train, 530 by model during train, total 2665
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00153831384364173, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4366 are correct, 0 correct by model, 0 correct by ema before train, 1098 by model during train, total 5558
Comm round 76 meta round 1 chosen client: [11, 5, 15, 8, 7]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0018678556743907393, unsupervised loss ratio: 1.0, lr 0.021, 1896 pseu out of 2868 are correct, 0 correct by model, 0 correct by ema before train, 2068 by model during train, total 4088
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002171212388393393, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 2584 are correct, 0 correct by model, 0 correct by ema before train, 355 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0022326175002560307, unsupervised loss ratio: 1.0, lr 0.021, 13 pseu out of 2805 are correct, 0 correct by model, 0 correct by ema before train, 206 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0013367417143651528, unsupervised loss ratio: 1.0, lr 0.021, 2300 pseu out of 3080 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0019581307345875897, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2210 are correct, 0 correct by model, 0 correct by ema before train, 555 by model during train, total 3280
Comm round 76 meta round 2 chosen client: [15, 18, 9, 7, 14]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0022182261696658454, unsupervised loss ratio: 1.0, lr 0.021, 15 pseu out of 2811 are correct, 0 correct by model, 0 correct by ema before train, 224 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002188821028943898, unsupervised loss ratio: 1.0, lr 0.021, 540 pseu out of 1372 are correct, 0 correct by model, 0 correct by ema before train, 643 by model during train, total 2298
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018471176768394394, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 955 are correct, 0 correct by model, 0 correct by ema before train, 80 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0021094545786931682, unsupervised loss ratio: 1.0, lr 0.021, 494 pseu out of 2276 are correct, 0 correct by model, 0 correct by ema before train, 560 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001574864614557362, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1370 are correct, 0 correct by model, 0 correct by ema before train, 39 by model during train, total 2083
Comm round 76 meta round 3 chosen client: [4, 2, 16, 19, 1]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001745591219145036, unsupervised loss ratio: 1.0, lr 0.021, 716 pseu out of 2787 are correct, 0 correct by model, 0 correct by ema before train, 963 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002154121625824787, unsupervised loss ratio: 1.0, lr 0.021, 318 pseu out of 1738 are correct, 0 correct by model, 0 correct by ema before train, 516 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002571083948810081, unsupervised loss ratio: 1.0, lr 0.021, 421 pseu out of 2204 are correct, 0 correct by model, 0 correct by ema before train, 609 by model during train, total 3883
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0026611968778291694, unsupervised loss ratio: 1.0, lr 0.021, 263 pseu out of 3168 are correct, 0 correct by model, 0 correct by ema before train, 688 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002083626007888375, unsupervised loss ratio: 1.0, lr 0.021, 648 pseu out of 1688 are correct, 0 correct by model, 0 correct by ema before train, 830 by model during train, total 2621
Comm round 76 meta round 4 chosen client: [7, 1, 4, 2, 15]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002020898781036242, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2290 are correct, 0 correct by model, 0 correct by ema before train, 553 by model during train, total 3280
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0020598375590563547, unsupervised loss ratio: 1.0, lr 0.021, 645 pseu out of 1694 are correct, 0 correct by model, 0 correct by ema before train, 818 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001811615043571071, unsupervised loss ratio: 1.0, lr 0.021, 710 pseu out of 2817 are correct, 0 correct by model, 0 correct by ema before train, 967 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002274518253259538, unsupervised loss ratio: 1.0, lr 0.021, 321 pseu out of 1740 are correct, 0 correct by model, 0 correct by ema before train, 532 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0021870967098668466, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 2826 are correct, 0 correct by model, 0 correct by ema before train, 212 by model during train, total 4099
Comm round 76 meta round 5 chosen client: [5, 13, 18, 12, 16]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002195502438613015, unsupervised loss ratio: 1.0, lr 0.021, 290 pseu out of 2593 are correct, 0 correct by model, 0 correct by ema before train, 355 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003701212362857867, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3563 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0021946450643655327, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 1353 are correct, 0 correct by model, 0 correct by ema before train, 651 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0018154970771219168, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 4658 are correct, 0 correct by model, 0 correct by ema before train, 122 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0026791819264409974, unsupervised loss ratio: 1.0, lr 0.021, 422 pseu out of 2198 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 3883
************ Loss Avg 0.0020549098359789373, LR 0.03, Round 76 ends ************  

TEST Student: Epoch: 76

TEST AUROC: 0.719173, TEST Accus: 0.246235, TEST Pre: 0.222484, TEST Recall: 0.163032
Comm round 77 meta round 0 chosen client: [6, 1, 5, 2, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001658120616912788, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 2948 are correct, 0 correct by model, 0 correct by ema before train, 1371 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0016347531899355535, unsupervised loss ratio: 1.0, lr 0.021, 646 pseu out of 1711 are correct, 0 correct by model, 0 correct by ema before train, 813 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0016906147624259113, unsupervised loss ratio: 1.0, lr 0.021, 292 pseu out of 2626 are correct, 0 correct by model, 0 correct by ema before train, 355 by model during train, total 3866
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0019198057028309752, unsupervised loss ratio: 1.0, lr 0.021, 332 pseu out of 1780 are correct, 0 correct by model, 0 correct by ema before train, 516 by model during train, total 2665
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016503866922686853, unsupervised loss ratio: 1.0, lr 0.021, 716 pseu out of 2829 are correct, 0 correct by model, 0 correct by ema before train, 960 by model during train, total 3987
Comm round 77 meta round 1 chosen client: [0, 19, 14, 10, 16]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.861755161261072 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0022789320232382473, unsupervised loss ratio: 1.0, lr 0.021, 259 pseu out of 3249 are correct, 0 correct by model, 0 correct by ema before train, 664 by model during train, total 4949
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.000943928968450619, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1393 are correct, 0 correct by model, 0 correct by ema before train, 52 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0020126272585034243, unsupervised loss ratio: 1.0, lr 0.021, 647 pseu out of 2372 are correct, 0 correct by model, 0 correct by ema before train, 886 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002253401190515791, unsupervised loss ratio: 1.0, lr 0.021, 421 pseu out of 2291 are correct, 0 correct by model, 0 correct by ema before train, 600 by model during train, total 3883
Comm round 77 meta round 2 chosen client: [1, 3, 9, 11, 19]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0016780863203698906, unsupervised loss ratio: 1.0, lr 0.021, 646 pseu out of 1741 are correct, 0 correct by model, 0 correct by ema before train, 803 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0024210886960125727, unsupervised loss ratio: 1.0, lr 0.021, 115 pseu out of 2055 are correct, 0 correct by model, 0 correct by ema before train, 301 by model during train, total 3526
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012840994814824727, unsupervised loss ratio: 1.0, lr 0.021, 48 pseu out of 978 are correct, 0 correct by model, 0 correct by ema before train, 82 by model during train, total 1677
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0015833296047276235, unsupervised loss ratio: 1.0, lr 0.021, 1893 pseu out of 2853 are correct, 0 correct by model, 0 correct by ema before train, 2046 by model during train, total 4088
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0021325752515202532, unsupervised loss ratio: 1.0, lr 0.021, 265 pseu out of 3262 are correct, 0 correct by model, 0 correct by ema before train, 671 by model during train, total 4949
Comm round 77 meta round 3 chosen client: [16, 12, 6, 13, 7]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002236193364684577, unsupervised loss ratio: 1.0, lr 0.021, 416 pseu out of 2301 are correct, 0 correct by model, 0 correct by ema before train, 587 by model during train, total 3883
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0013416422450164747, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 4702 are correct, 0 correct by model, 0 correct by ema before train, 136 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0016972589158061621, unsupervised loss ratio: 1.0, lr 0.021, 1230 pseu out of 3018 are correct, 0 correct by model, 0 correct by ema before train, 1396 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0002204046312865596, unsupervised loss ratio: 1.0, lr 0.021, 2158 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 2192 by model during train, total 3739
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0014368746913253115, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2296 are correct, 0 correct by model, 0 correct by ema before train, 556 by model during train, total 3280
Comm round 77 meta round 4 chosen client: [3, 14, 4, 6, 2]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002379230265172997, unsupervised loss ratio: 1.0, lr 0.021, 114 pseu out of 2097 are correct, 0 correct by model, 0 correct by ema before train, 273 by model during train, total 3526
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0011721126008496592, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1385 are correct, 0 correct by model, 0 correct by ema before train, 50 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001610681517160542, unsupervised loss ratio: 1.0, lr 0.021, 716 pseu out of 2899 are correct, 0 correct by model, 0 correct by ema before train, 938 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.001680105210929785, unsupervised loss ratio: 1.0, lr 0.021, 1228 pseu out of 3016 are correct, 0 correct by model, 0 correct by ema before train, 1376 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.001870636740932241, unsupervised loss ratio: 1.0, lr 0.021, 337 pseu out of 1809 are correct, 0 correct by model, 0 correct by ema before train, 545 by model during train, total 2665
Comm round 77 meta round 5 chosen client: [19, 9, 18, 7, 4]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0021548149726675968, unsupervised loss ratio: 1.0, lr 0.021, 252 pseu out of 3283 are correct, 0 correct by model, 0 correct by ema before train, 641 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0012797587044554315, unsupervised loss ratio: 1.0, lr 0.021, 49 pseu out of 1016 are correct, 0 correct by model, 0 correct by ema before train, 79 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0016656538710877714, unsupervised loss ratio: 1.0, lr 0.021, 537 pseu out of 1380 are correct, 0 correct by model, 0 correct by ema before train, 634 by model during train, total 2298
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001434961087607707, unsupervised loss ratio: 1.0, lr 0.021, 496 pseu out of 2306 are correct, 0 correct by model, 0 correct by ema before train, 564 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0016427760322888691, unsupervised loss ratio: 1.0, lr 0.021, 713 pseu out of 2937 are correct, 0 correct by model, 0 correct by ema before train, 932 by model during train, total 3987
************ Loss Avg 0.030357333862384612, LR 0.03, Round 77 ends ************  

TEST Student: Epoch: 77

TEST AUROC: 0.732659, TEST Accus: 0.266749, TEST Pre: 0.210769, TEST Recall: 0.189644
Comm round 78 meta round 0 chosen client: [14, 5, 0, 12, 1]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0014957390782056432, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1435 are correct, 0 correct by model, 0 correct by ema before train, 51 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00208049491200535, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 2675 are correct, 0 correct by model, 0 correct by ema before train, 349 by model during train, total 3866
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8532710598439587 lr : 0.03
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0016865658518832383, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 4693 are correct, 0 correct by model, 0 correct by ema before train, 127 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0020110659818051426, unsupervised loss ratio: 1.0, lr 0.021, 655 pseu out of 1769 are correct, 0 correct by model, 0 correct by ema before train, 832 by model during train, total 2621
Comm round 78 meta round 1 chosen client: [6, 14, 9, 8, 1]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0020084490331456714, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 3062 are correct, 0 correct by model, 0 correct by ema before train, 1369 by model during train, total 4383
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015057583452399933, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1460 are correct, 0 correct by model, 0 correct by ema before train, 46 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0017700377599491428, unsupervised loss ratio: 1.0, lr 0.021, 50 pseu out of 1004 are correct, 0 correct by model, 0 correct by ema before train, 85 by model during train, total 1677
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0012329639273502835, unsupervised loss ratio: 1.0, lr 0.021, 2311 pseu out of 3094 are correct, 0 correct by model, 0 correct by ema before train, 2343 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0019270032871423698, unsupervised loss ratio: 1.0, lr 0.021, 656 pseu out of 1768 are correct, 0 correct by model, 0 correct by ema before train, 811 by model during train, total 2621
Comm round 78 meta round 2 chosen client: [3, 0, 11, 7, 14]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0027479335653229748, unsupervised loss ratio: 1.0, lr 0.021, 119 pseu out of 2131 are correct, 0 correct by model, 0 correct by ema before train, 307 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8790820216646 lr : 0.03
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0017690670292722643, unsupervised loss ratio: 1.0, lr 0.021, 1909 pseu out of 2875 are correct, 0 correct by model, 0 correct by ema before train, 2063 by model during train, total 4088
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0018932579310225823, unsupervised loss ratio: 1.0, lr 0.021, 495 pseu out of 2334 are correct, 0 correct by model, 0 correct by ema before train, 567 by model during train, total 3280
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015056664441627536, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1461 are correct, 0 correct by model, 0 correct by ema before train, 57 by model during train, total 2083
Comm round 78 meta round 3 chosen client: [19, 1, 18, 10, 0]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002360915794270113, unsupervised loss ratio: 1.0, lr 0.021, 254 pseu out of 3352 are correct, 0 correct by model, 0 correct by ema before train, 660 by model during train, total 4949
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.001999652189225322, unsupervised loss ratio: 1.0, lr 0.021, 663 pseu out of 1794 are correct, 0 correct by model, 0 correct by ema before train, 830 by model during train, total 2621
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.00204239996512317, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 1376 are correct, 0 correct by model, 0 correct by ema before train, 656 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0021629954933124625, unsupervised loss ratio: 1.0, lr 0.021, 649 pseu out of 2398 are correct, 0 correct by model, 0 correct by ema before train, 892 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8572726833577059 lr : 0.03
Comm round 78 meta round 4 chosen client: [17, 10, 14, 4, 12]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014380815642318506, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4374 are correct, 0 correct by model, 0 correct by ema before train, 1101 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002158952861871763, unsupervised loss ratio: 1.0, lr 0.021, 644 pseu out of 2381 are correct, 0 correct by model, 0 correct by ema before train, 884 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015765842170257008, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 1494 are correct, 0 correct by model, 0 correct by ema before train, 66 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0017562492502047606, unsupervised loss ratio: 1.0, lr 0.021, 716 pseu out of 2936 are correct, 0 correct by model, 0 correct by ema before train, 937 by model during train, total 3987
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0017134726390294318, unsupervised loss ratio: 1.0, lr 0.021, 12 pseu out of 4719 are correct, 0 correct by model, 0 correct by ema before train, 137 by model during train, total 5750
Comm round 78 meta round 5 chosen client: [7, 18, 15, 5, 9]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001846122938262012, unsupervised loss ratio: 1.0, lr 0.021, 497 pseu out of 2337 are correct, 0 correct by model, 0 correct by ema before train, 568 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0019199061627861941, unsupervised loss ratio: 1.0, lr 0.021, 542 pseu out of 1375 are correct, 0 correct by model, 0 correct by ema before train, 651 by model during train, total 2298
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002006217748594981, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 2860 are correct, 0 correct by model, 0 correct by ema before train, 222 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0021075932366284925, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2661 are correct, 0 correct by model, 0 correct by ema before train, 352 by model during train, total 3866
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001742005669425621, unsupervised loss ratio: 1.0, lr 0.021, 51 pseu out of 1026 are correct, 0 correct by model, 0 correct by ema before train, 89 by model during train, total 1677
************ Loss Avg 0.08800303059142545, LR 0.03, Round 78 ends ************  

TEST Student: Epoch: 78

TEST AUROC: 0.778392, TEST Accus: 0.338045, TEST Pre: 0.196006, TEST Recall: 0.283425
Comm round 79 meta round 0 chosen client: [14, 2, 11, 8, 19]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.004632515557618303, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 1456 are correct, 0 correct by model, 0 correct by ema before train, 61 by model during train, total 2083
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.004588970626216559, unsupervised loss ratio: 1.0, lr 0.021, 327 pseu out of 1804 are correct, 0 correct by model, 0 correct by ema before train, 533 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003486063673335593, unsupervised loss ratio: 1.0, lr 0.021, 1904 pseu out of 2868 are correct, 0 correct by model, 0 correct by ema before train, 2074 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0021792604835013663, unsupervised loss ratio: 1.0, lr 0.021, 2311 pseu out of 3082 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.004725257334753106, unsupervised loss ratio: 1.0, lr 0.021, 283 pseu out of 3302 are correct, 0 correct by model, 0 correct by ema before train, 676 by model during train, total 4949
Comm round 79 meta round 1 chosen client: [3, 4, 2, 8, 1]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.005325982602828715, unsupervised loss ratio: 1.0, lr 0.021, 127 pseu out of 2078 are correct, 0 correct by model, 0 correct by ema before train, 297 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0035663407133330427, unsupervised loss ratio: 1.0, lr 0.021, 718 pseu out of 2940 are correct, 0 correct by model, 0 correct by ema before train, 958 by model during train, total 3987
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.004213057275462363, unsupervised loss ratio: 1.0, lr 0.021, 318 pseu out of 1775 are correct, 0 correct by model, 0 correct by ema before train, 525 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.002156964380333193, unsupervised loss ratio: 1.0, lr 0.021, 2301 pseu out of 3046 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.004573575868384867, unsupervised loss ratio: 1.0, lr 0.021, 661 pseu out of 1798 are correct, 0 correct by model, 0 correct by ema before train, 830 by model during train, total 2621
Comm round 79 meta round 2 chosen client: [17, 3, 0, 16, 8]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.003250913683796066, unsupervised loss ratio: 1.0, lr 0.021, 1056 pseu out of 4403 are correct, 0 correct by model, 0 correct by ema before train, 1105 by model during train, total 5558
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.005023934145616035, unsupervised loss ratio: 1.0, lr 0.021, 132 pseu out of 2072 are correct, 0 correct by model, 0 correct by ema before train, 314 by model during train, total 3526
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.809897070028344 lr : 0.03
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.005023992794077294, unsupervised loss ratio: 1.0, lr 0.021, 444 pseu out of 2315 are correct, 0 correct by model, 0 correct by ema before train, 603 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0022412626048620155, unsupervised loss ratio: 1.0, lr 0.021, 2302 pseu out of 3026 are correct, 0 correct by model, 0 correct by ema before train, 2339 by model during train, total 4036
Comm round 79 meta round 3 chosen client: [13, 11, 3, 12, 18]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0011558226848384207, unsupervised loss ratio: 1.0, lr 0.021, 2156 pseu out of 3574 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0032277307218464557, unsupervised loss ratio: 1.0, lr 0.021, 1930 pseu out of 2832 are correct, 0 correct by model, 0 correct by ema before train, 2090 by model during train, total 4088
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004929339143148225, unsupervised loss ratio: 1.0, lr 0.021, 129 pseu out of 1972 are correct, 0 correct by model, 0 correct by ema before train, 334 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.004236645474641894, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 4633 are correct, 0 correct by model, 0 correct by ema before train, 152 by model during train, total 5750
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.004310114347996811, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1380 are correct, 0 correct by model, 0 correct by ema before train, 646 by model during train, total 2298
Comm round 79 meta round 4 chosen client: [13, 19, 2, 10, 14]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0011003033097209882, unsupervised loss ratio: 1.0, lr 0.021, 2160 pseu out of 3585 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0046431523082085336, unsupervised loss ratio: 1.0, lr 0.021, 258 pseu out of 3213 are correct, 0 correct by model, 0 correct by ema before train, 700 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.004059400002006441, unsupervised loss ratio: 1.0, lr 0.021, 333 pseu out of 1749 are correct, 0 correct by model, 0 correct by ema before train, 556 by model during train, total 2665
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004056905890044211, unsupervised loss ratio: 1.0, lr 0.021, 658 pseu out of 2405 are correct, 0 correct by model, 0 correct by ema before train, 897 by model during train, total 3684
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0044169763533511396, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1472 are correct, 0 correct by model, 0 correct by ema before train, 60 by model during train, total 2083
Comm round 79 meta round 5 chosen client: [11, 1, 4, 6, 12]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0033044428873836296, unsupervised loss ratio: 1.0, lr 0.021, 1908 pseu out of 2817 are correct, 0 correct by model, 0 correct by ema before train, 2092 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0043515285942703485, unsupervised loss ratio: 1.0, lr 0.021, 655 pseu out of 1767 are correct, 0 correct by model, 0 correct by ema before train, 838 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0032725871604357267, unsupervised loss ratio: 1.0, lr 0.021, 714 pseu out of 2902 are correct, 0 correct by model, 0 correct by ema before train, 952 by model during train, total 3987
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0038929157822892285, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 3047 are correct, 0 correct by model, 0 correct by ema before train, 1378 by model during train, total 4383
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.004165497754648742, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 4561 are correct, 0 correct by model, 0 correct by ema before train, 164 by model during train, total 5750
************ Loss Avg 0.030666950806243105, LR 0.03, Round 79 ends ************  

TEST Student: Epoch: 79

TEST AUROC: 0.758605, TEST Accus: 0.305355, TEST Pre: 0.200995, TEST Recall: 0.240166
Comm round 80 meta round 0 chosen client: [2, 18, 13, 14, 5]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003000764835936328, unsupervised loss ratio: 1.0, lr 0.021, 348 pseu out of 1753 are correct, 0 correct by model, 0 correct by ema before train, 556 by model during train, total 2665
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028154559743901095, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 1361 are correct, 0 correct by model, 0 correct by ema before train, 656 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006640874746184544, unsupervised loss ratio: 1.0, lr 0.021, 2149 pseu out of 3554 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0028248648159205914, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1466 are correct, 0 correct by model, 0 correct by ema before train, 58 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0030844480593184955, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2681 are correct, 0 correct by model, 0 correct by ema before train, 350 by model during train, total 3866
Comm round 80 meta round 1 chosen client: [2, 1, 18, 10, 6]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029302353726788645, unsupervised loss ratio: 1.0, lr 0.021, 334 pseu out of 1717 are correct, 0 correct by model, 0 correct by ema before train, 590 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0029495507620683893, unsupervised loss ratio: 1.0, lr 0.021, 665 pseu out of 1721 are correct, 0 correct by model, 0 correct by ema before train, 837 by model during train, total 2621
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002931385398066292, unsupervised loss ratio: 1.0, lr 0.021, 543 pseu out of 1369 are correct, 0 correct by model, 0 correct by ema before train, 659 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0028311108230966433, unsupervised loss ratio: 1.0, lr 0.021, 652 pseu out of 2358 are correct, 0 correct by model, 0 correct by ema before train, 930 by model during train, total 3684
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0025826410274021327, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 2995 are correct, 0 correct by model, 0 correct by ema before train, 1379 by model during train, total 4383
Comm round 80 meta round 2 chosen client: [9, 7, 17, 14, 4]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0031044011767436233, unsupervised loss ratio: 1.0, lr 0.021, 50 pseu out of 1051 are correct, 0 correct by model, 0 correct by ema before train, 84 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003278655835646742, unsupervised loss ratio: 1.0, lr 0.021, 495 pseu out of 2303 are correct, 0 correct by model, 0 correct by ema before train, 572 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021653084376098953, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4316 are correct, 0 correct by model, 0 correct by ema before train, 1097 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0028415055148247065, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1441 are correct, 0 correct by model, 0 correct by ema before train, 63 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002285442108081447, unsupervised loss ratio: 1.0, lr 0.021, 718 pseu out of 2855 are correct, 0 correct by model, 0 correct by ema before train, 971 by model during train, total 3987
Comm round 80 meta round 3 chosen client: [1, 18, 10, 4, 7]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0029068304021365758, unsupervised loss ratio: 1.0, lr 0.021, 667 pseu out of 1727 are correct, 0 correct by model, 0 correct by ema before train, 849 by model during train, total 2621
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028936346352566034, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 1406 are correct, 0 correct by model, 0 correct by ema before train, 652 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0029015170655149066, unsupervised loss ratio: 1.0, lr 0.021, 664 pseu out of 2371 are correct, 0 correct by model, 0 correct by ema before train, 918 by model during train, total 3684
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0024561139381682824, unsupervised loss ratio: 1.0, lr 0.021, 719 pseu out of 2860 are correct, 0 correct by model, 0 correct by ema before train, 955 by model during train, total 3987
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003177642809952466, unsupervised loss ratio: 1.0, lr 0.021, 499 pseu out of 2339 are correct, 0 correct by model, 0 correct by ema before train, 574 by model during train, total 3280
Comm round 80 meta round 4 chosen client: [14, 10, 9, 7, 17]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002973337878233217, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1452 are correct, 0 correct by model, 0 correct by ema before train, 57 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0029506412041694695, unsupervised loss ratio: 1.0, lr 0.021, 666 pseu out of 2374 are correct, 0 correct by model, 0 correct by ema before train, 937 by model during train, total 3684
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0029966756291859957, unsupervised loss ratio: 1.0, lr 0.021, 51 pseu out of 1024 are correct, 0 correct by model, 0 correct by ema before train, 94 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003168939717467695, unsupervised loss ratio: 1.0, lr 0.021, 498 pseu out of 2274 are correct, 0 correct by model, 0 correct by ema before train, 577 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0022079203152044237, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4224 are correct, 0 correct by model, 0 correct by ema before train, 1096 by model during train, total 5558
Comm round 80 meta round 5 chosen client: [8, 3, 1, 14, 13]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015750102552090084, unsupervised loss ratio: 1.0, lr 0.021, 2299 pseu out of 3021 are correct, 0 correct by model, 0 correct by ema before train, 2340 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0037268767544966458, unsupervised loss ratio: 1.0, lr 0.021, 136 pseu out of 1984 are correct, 0 correct by model, 0 correct by ema before train, 333 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0030388748613981212, unsupervised loss ratio: 1.0, lr 0.021, 668 pseu out of 1740 are correct, 0 correct by model, 0 correct by ema before train, 854 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0028135997920551085, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 1457 are correct, 0 correct by model, 0 correct by ema before train, 67 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000669119902294508, unsupervised loss ratio: 1.0, lr 0.021, 2152 pseu out of 3561 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
************ Loss Avg 0.0026915530925715244, LR 0.03, Round 80 ends ************  

TEST Student: Epoch: 80

TEST AUROC: 0.737224, TEST Accus: 0.266633, TEST Pre: 0.220399, TEST Recall: 0.189374
Comm round 81 meta round 0 chosen client: [0, 18, 1, 2, 10]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.864684730159993 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002058077804071622, unsupervised loss ratio: 1.0, lr 0.021, 542 pseu out of 1365 are correct, 0 correct by model, 0 correct by ema before train, 655 by model during train, total 2298
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0019841170188312123, unsupervised loss ratio: 1.0, lr 0.021, 662 pseu out of 1703 are correct, 0 correct by model, 0 correct by ema before train, 855 by model during train, total 2621
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002164543783735661, unsupervised loss ratio: 1.0, lr 0.021, 353 pseu out of 1741 are correct, 0 correct by model, 0 correct by ema before train, 573 by model during train, total 2665
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0023292163838552118, unsupervised loss ratio: 1.0, lr 0.021, 677 pseu out of 2392 are correct, 0 correct by model, 0 correct by ema before train, 922 by model during train, total 3684
Comm round 81 meta round 1 chosen client: [11, 12, 0, 13, 10]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0018129316758859204, unsupervised loss ratio: 1.0, lr 0.021, 1940 pseu out of 2800 are correct, 0 correct by model, 0 correct by ema before train, 2109 by model during train, total 4088
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0017726271115760836, unsupervised loss ratio: 1.0, lr 0.021, 26 pseu out of 4582 are correct, 0 correct by model, 0 correct by ema before train, 187 by model during train, total 5750
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8356619008949825 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003494674583326757, unsupervised loss ratio: 1.0, lr 0.021, 2157 pseu out of 3568 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0022387089416513154, unsupervised loss ratio: 1.0, lr 0.021, 668 pseu out of 2389 are correct, 0 correct by model, 0 correct by ema before train, 933 by model during train, total 3684
Comm round 81 meta round 2 chosen client: [9, 5, 17, 12, 14]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001750888479431591, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 1031 are correct, 0 correct by model, 0 correct by ema before train, 86 by model during train, total 1677
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002082135167629382, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2676 are correct, 0 correct by model, 0 correct by ema before train, 354 by model during train, total 3866
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015318426986000147, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4305 are correct, 0 correct by model, 0 correct by ema before train, 1099 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0017733994075873245, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 4585 are correct, 0 correct by model, 0 correct by ema before train, 151 by model during train, total 5750
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001567668636033142, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1443 are correct, 0 correct by model, 0 correct by ema before train, 83 by model during train, total 2083
Comm round 81 meta round 3 chosen client: [14, 13, 1, 5, 4]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0016170297273096037, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1448 are correct, 0 correct by model, 0 correct by ema before train, 64 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004082013706388583, unsupervised loss ratio: 1.0, lr 0.021, 2158 pseu out of 3568 are correct, 0 correct by model, 0 correct by ema before train, 2185 by model during train, total 3739
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0019413863064539506, unsupervised loss ratio: 1.0, lr 0.021, 662 pseu out of 1704 are correct, 0 correct by model, 0 correct by ema before train, 868 by model during train, total 2621
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0020450885821759824, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 2674 are correct, 0 correct by model, 0 correct by ema before train, 350 by model during train, total 3866
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0017186162114653381, unsupervised loss ratio: 1.0, lr 0.021, 717 pseu out of 2898 are correct, 0 correct by model, 0 correct by ema before train, 956 by model during train, total 3987
Comm round 81 meta round 4 chosen client: [2, 1, 11, 17, 16]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0021369370813426073, unsupervised loss ratio: 1.0, lr 0.021, 348 pseu out of 1744 are correct, 0 correct by model, 0 correct by ema before train, 584 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0021149010919943086, unsupervised loss ratio: 1.0, lr 0.021, 659 pseu out of 1727 are correct, 0 correct by model, 0 correct by ema before train, 851 by model during train, total 2621
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001838922917158925, unsupervised loss ratio: 1.0, lr 0.021, 1927 pseu out of 2831 are correct, 0 correct by model, 0 correct by ema before train, 2099 by model during train, total 4088
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015201110709940307, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4318 are correct, 0 correct by model, 0 correct by ema before train, 1096 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002472891929353297, unsupervised loss ratio: 1.0, lr 0.021, 430 pseu out of 2247 are correct, 0 correct by model, 0 correct by ema before train, 619 by model during train, total 3883
Comm round 81 meta round 5 chosen client: [4, 19, 15, 3, 12]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001833656562551383, unsupervised loss ratio: 1.0, lr 0.021, 721 pseu out of 2897 are correct, 0 correct by model, 0 correct by ema before train, 960 by model during train, total 3987
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00245822696104789, unsupervised loss ratio: 1.0, lr 0.021, 294 pseu out of 3194 are correct, 0 correct by model, 0 correct by ema before train, 763 by model during train, total 4949
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00205282298333119, unsupervised loss ratio: 1.0, lr 0.021, 16 pseu out of 2868 are correct, 0 correct by model, 0 correct by ema before train, 196 by model during train, total 4099
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0028316389872478404, unsupervised loss ratio: 1.0, lr 0.021, 144 pseu out of 2009 are correct, 0 correct by model, 0 correct by ema before train, 346 by model during train, total 3526
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0018410097794710762, unsupervised loss ratio: 1.0, lr 0.021, 26 pseu out of 4526 are correct, 0 correct by model, 0 correct by ema before train, 180 by model during train, total 5750
************ Loss Avg 0.058419789906157746, LR 0.03, Round 81 ends ************  

TEST Student: Epoch: 81

TEST AUROC: 0.758871, TEST Accus: 0.303511, TEST Pre: 0.190370, TEST Recall: 0.238715
Comm round 82 meta round 0 chosen client: [9, 2, 1, 0, 3]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0031919694501320243, unsupervised loss ratio: 1.0, lr 0.021, 53 pseu out of 1065 are correct, 0 correct by model, 0 correct by ema before train, 84 by model during train, total 1677
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00290553678669745, unsupervised loss ratio: 1.0, lr 0.021, 347 pseu out of 1713 are correct, 0 correct by model, 0 correct by ema before train, 577 by model during train, total 2665
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0030116487674914844, unsupervised loss ratio: 1.0, lr 0.021, 674 pseu out of 1721 are correct, 0 correct by model, 0 correct by ema before train, 851 by model during train, total 2621
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8318802434570935 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003743125863755787, unsupervised loss ratio: 1.0, lr 0.021, 145 pseu out of 1978 are correct, 0 correct by model, 0 correct by ema before train, 345 by model during train, total 3526
Comm round 82 meta round 1 chosen client: [0, 10, 16, 8, 3]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8137976028481309 lr : 0.03
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002921676038411157, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 2387 are correct, 0 correct by model, 0 correct by ema before train, 952 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0036039280831111505, unsupervised loss ratio: 1.0, lr 0.021, 428 pseu out of 2267 are correct, 0 correct by model, 0 correct by ema before train, 626 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015790442954539685, unsupervised loss ratio: 1.0, lr 0.021, 2298 pseu out of 3024 are correct, 0 correct by model, 0 correct by ema before train, 2341 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003594687064963052, unsupervised loss ratio: 1.0, lr 0.021, 152 pseu out of 1970 are correct, 0 correct by model, 0 correct by ema before train, 338 by model during train, total 3526
Comm round 82 meta round 2 chosen client: [11, 7, 8, 17, 4]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002449718218485941, unsupervised loss ratio: 1.0, lr 0.021, 1918 pseu out of 2842 are correct, 0 correct by model, 0 correct by ema before train, 2101 by model during train, total 4088
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0029742283032436925, unsupervised loss ratio: 1.0, lr 0.021, 497 pseu out of 2282 are correct, 0 correct by model, 0 correct by ema before train, 577 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016146932579330642, unsupervised loss ratio: 1.0, lr 0.021, 2292 pseu out of 2989 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002121852706828765, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4319 are correct, 0 correct by model, 0 correct by ema before train, 1099 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0024767275354529304, unsupervised loss ratio: 1.0, lr 0.021, 716 pseu out of 2896 are correct, 0 correct by model, 0 correct by ema before train, 959 by model during train, total 3987
Comm round 82 meta round 3 chosen client: [2, 14, 9, 10, 12]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0028423313356359444, unsupervised loss ratio: 1.0, lr 0.021, 351 pseu out of 1748 are correct, 0 correct by model, 0 correct by ema before train, 578 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0027404467674028692, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1446 are correct, 0 correct by model, 0 correct by ema before train, 67 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.002912426643349506, unsupervised loss ratio: 1.0, lr 0.021, 50 pseu out of 1032 are correct, 0 correct by model, 0 correct by ema before train, 98 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027997522526581227, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 2366 are correct, 0 correct by model, 0 correct by ema before train, 964 by model during train, total 3684
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0026766002980164356, unsupervised loss ratio: 1.0, lr 0.021, 28 pseu out of 4524 are correct, 0 correct by model, 0 correct by ema before train, 201 by model during train, total 5750
Comm round 82 meta round 4 chosen client: [8, 17, 9, 0, 15]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016169592609003303, unsupervised loss ratio: 1.0, lr 0.021, 2302 pseu out of 3038 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021603374284338847, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4314 are correct, 0 correct by model, 0 correct by ema before train, 1106 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0029582068996710908, unsupervised loss ratio: 1.0, lr 0.021, 48 pseu out of 1042 are correct, 0 correct by model, 0 correct by ema before train, 84 by model during train, total 1677
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8286627750007474 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00296091790122983, unsupervised loss ratio: 1.0, lr 0.021, 14 pseu out of 2879 are correct, 0 correct by model, 0 correct by ema before train, 227 by model during train, total 4099
Comm round 82 meta round 5 chosen client: [6, 11, 0, 13, 2]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0026699794064937296, unsupervised loss ratio: 1.0, lr 0.021, 1229 pseu out of 2949 are correct, 0 correct by model, 0 correct by ema before train, 1399 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0024428380183962872, unsupervised loss ratio: 1.0, lr 0.021, 1932 pseu out of 2839 are correct, 0 correct by model, 0 correct by ema before train, 2110 by model during train, total 4088
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8138970148806669 lr : 0.03
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0006386411035437358, unsupervised loss ratio: 1.0, lr 0.021, 2157 pseu out of 3567 are correct, 0 correct by model, 0 correct by ema before train, 2188 by model during train, total 3739
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029071428219876474, unsupervised loss ratio: 1.0, lr 0.021, 350 pseu out of 1745 are correct, 0 correct by model, 0 correct by ema before train, 567 by model during train, total 2665
************ Loss Avg 0.11189176842321062, LR 0.03, Round 82 ends ************  

TEST Student: Epoch: 82

TEST AUROC: 0.794101, TEST Accus: 0.369046, TEST Pre: 0.190556, TEST Recall: 0.323835
Comm round 83 meta round 0 chosen client: [4, 19, 15, 9, 12]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.00449434624493329, unsupervised loss ratio: 1.0, lr 0.021, 723 pseu out of 2876 are correct, 0 correct by model, 0 correct by ema before train, 972 by model during train, total 3987
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.006037422763303113, unsupervised loss ratio: 1.0, lr 0.021, 326 pseu out of 3164 are correct, 0 correct by model, 0 correct by ema before train, 775 by model during train, total 4949
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.005351867300655263, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 2842 are correct, 0 correct by model, 0 correct by ema before train, 208 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00714031966506607, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 1048 are correct, 0 correct by model, 0 correct by ema before train, 90 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0056876470826359255, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 4443 are correct, 0 correct by model, 0 correct by ema before train, 226 by model during train, total 5750
Comm round 83 meta round 1 chosen client: [12, 0, 19, 14, 13]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.005406361774334477, unsupervised loss ratio: 1.0, lr 0.021, 39 pseu out of 4342 are correct, 0 correct by model, 0 correct by ema before train, 267 by model during train, total 5750
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7457557034735777 lr : 0.03
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005670544265273911, unsupervised loss ratio: 1.0, lr 0.021, 321 pseu out of 3079 are correct, 0 correct by model, 0 correct by ema before train, 842 by model during train, total 4949
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0063209779574676895, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1425 are correct, 0 correct by model, 0 correct by ema before train, 75 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0017255826431950081, unsupervised loss ratio: 1.0, lr 0.021, 2150 pseu out of 3544 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Comm round 83 meta round 2 chosen client: [2, 5, 19, 11, 4]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005663665710017085, unsupervised loss ratio: 1.0, lr 0.021, 364 pseu out of 1740 are correct, 0 correct by model, 0 correct by ema before train, 590 by model during train, total 2665
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0062162325732776375, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2654 are correct, 0 correct by model, 0 correct by ema before train, 362 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005626563514875344, unsupervised loss ratio: 1.0, lr 0.021, 374 pseu out of 3017 are correct, 0 correct by model, 0 correct by ema before train, 897 by model during train, total 4949
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00401662253352697, unsupervised loss ratio: 1.0, lr 0.021, 1933 pseu out of 2797 are correct, 0 correct by model, 0 correct by ema before train, 2113 by model during train, total 4088
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.004366903596313759, unsupervised loss ratio: 1.0, lr 0.021, 719 pseu out of 2828 are correct, 0 correct by model, 0 correct by ema before train, 978 by model during train, total 3987
Comm round 83 meta round 3 chosen client: [1, 9, 19, 5, 14]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.006066175438917991, unsupervised loss ratio: 1.0, lr 0.021, 672 pseu out of 1723 are correct, 0 correct by model, 0 correct by ema before train, 871 by model during train, total 2621
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.006587211654900953, unsupervised loss ratio: 1.0, lr 0.021, 59 pseu out of 1028 are correct, 0 correct by model, 0 correct by ema before train, 100 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.005362458752456288, unsupervised loss ratio: 1.0, lr 0.021, 391 pseu out of 2924 are correct, 0 correct by model, 0 correct by ema before train, 938 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.005709559441025018, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2520 are correct, 0 correct by model, 0 correct by ema before train, 367 by model during train, total 3866
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00595040749194044, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1422 are correct, 0 correct by model, 0 correct by ema before train, 76 by model during train, total 2083
Comm round 83 meta round 4 chosen client: [3, 8, 14, 12, 16]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.006950636879212523, unsupervised loss ratio: 1.0, lr 0.021, 160 pseu out of 1918 are correct, 0 correct by model, 0 correct by ema before train, 355 by model during train, total 3526
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0027460317362510978, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 2986 are correct, 0 correct by model, 0 correct by ema before train, 2335 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.006112239478776853, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1425 are correct, 0 correct by model, 0 correct by ema before train, 69 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0052707873246011635, unsupervised loss ratio: 1.0, lr 0.021, 38 pseu out of 4234 are correct, 0 correct by model, 0 correct by ema before train, 275 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.006296977937053584, unsupervised loss ratio: 1.0, lr 0.021, 458 pseu out of 2207 are correct, 0 correct by model, 0 correct by ema before train, 649 by model during train, total 3883
Comm round 83 meta round 5 chosen client: [2, 8, 3, 15, 12]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.005244376403944833, unsupervised loss ratio: 1.0, lr 0.021, 372 pseu out of 1729 are correct, 0 correct by model, 0 correct by ema before train, 597 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0026549348167463904, unsupervised loss ratio: 1.0, lr 0.021, 2292 pseu out of 2982 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0062510284312468556, unsupervised loss ratio: 1.0, lr 0.021, 170 pseu out of 1872 are correct, 0 correct by model, 0 correct by ema before train, 386 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00513176116935658, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 2735 are correct, 0 correct by model, 0 correct by ema before train, 225 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0052434786326355405, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 4096 are correct, 0 correct by model, 0 correct by ema before train, 326 by model during train, total 5750
************ Loss Avg 0.030035294222917303, LR 0.03, Round 83 ends ************  

TEST Student: Epoch: 83

TEST AUROC: 0.767594, TEST Accus: 0.319607, TEST Pre: 0.197557, TEST Recall: 0.259831
Comm round 84 meta round 0 chosen client: [17, 16, 3, 18, 2]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021589522941798055, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4285 are correct, 0 correct by model, 0 correct by ema before train, 1102 by model during train, total 5558
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0036294185079359374, unsupervised loss ratio: 1.0, lr 0.021, 473 pseu out of 2213 are correct, 0 correct by model, 0 correct by ema before train, 657 by model during train, total 3883
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0038278362286031813, unsupervised loss ratio: 1.0, lr 0.021, 179 pseu out of 1833 are correct, 0 correct by model, 0 correct by ema before train, 378 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003119083929858688, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 1372 are correct, 0 correct by model, 0 correct by ema before train, 665 by model during train, total 2298
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002933639229186589, unsupervised loss ratio: 1.0, lr 0.021, 360 pseu out of 1672 are correct, 0 correct by model, 0 correct by ema before train, 618 by model during train, total 2665
Comm round 84 meta round 1 chosen client: [15, 19, 16, 8, 1]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002971439217799343, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 2750 are correct, 0 correct by model, 0 correct by ema before train, 248 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003408288351821307, unsupervised loss ratio: 1.0, lr 0.021, 414 pseu out of 2895 are correct, 0 correct by model, 0 correct by ema before train, 970 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003715754862584662, unsupervised loss ratio: 1.0, lr 0.021, 464 pseu out of 2187 are correct, 0 correct by model, 0 correct by ema before train, 674 by model during train, total 3883
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016195825562590471, unsupervised loss ratio: 1.0, lr 0.021, 2285 pseu out of 2963 are correct, 0 correct by model, 0 correct by ema before train, 2331 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003035863918229574, unsupervised loss ratio: 1.0, lr 0.021, 675 pseu out of 1670 are correct, 0 correct by model, 0 correct by ema before train, 891 by model during train, total 2621
Comm round 84 meta round 2 chosen client: [3, 4, 13, 12, 1]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003935211090980114, unsupervised loss ratio: 1.0, lr 0.021, 178 pseu out of 1878 are correct, 0 correct by model, 0 correct by ema before train, 373 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0024249172401762317, unsupervised loss ratio: 1.0, lr 0.021, 726 pseu out of 2763 are correct, 0 correct by model, 0 correct by ema before train, 1017 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005997700830803142, unsupervised loss ratio: 1.0, lr 0.021, 2148 pseu out of 3555 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002874930574196494, unsupervised loss ratio: 1.0, lr 0.021, 67 pseu out of 4097 are correct, 0 correct by model, 0 correct by ema before train, 353 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003217788239963716, unsupervised loss ratio: 1.0, lr 0.021, 675 pseu out of 1693 are correct, 0 correct by model, 0 correct by ema before train, 870 by model during train, total 2621
Comm round 84 meta round 3 chosen client: [2, 15, 11, 17, 12]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029916955612688547, unsupervised loss ratio: 1.0, lr 0.021, 374 pseu out of 1703 are correct, 0 correct by model, 0 correct by ema before train, 612 by model during train, total 2665
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002988529707867061, unsupervised loss ratio: 1.0, lr 0.021, 26 pseu out of 2735 are correct, 0 correct by model, 0 correct by ema before train, 284 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002566510647739051, unsupervised loss ratio: 1.0, lr 0.021, 1953 pseu out of 2797 are correct, 0 correct by model, 0 correct by ema before train, 2137 by model during train, total 4088
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0021944090124519392, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4312 are correct, 0 correct by model, 0 correct by ema before train, 1106 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002948350531773435, unsupervised loss ratio: 1.0, lr 0.021, 69 pseu out of 4098 are correct, 0 correct by model, 0 correct by ema before train, 372 by model during train, total 5750
Comm round 84 meta round 4 chosen client: [4, 5, 6, 1, 18]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002533666431046431, unsupervised loss ratio: 1.0, lr 0.021, 722 pseu out of 2811 are correct, 0 correct by model, 0 correct by ema before train, 996 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0029842197145030025, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2545 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0029425674389737346, unsupervised loss ratio: 1.0, lr 0.021, 1226 pseu out of 2941 are correct, 0 correct by model, 0 correct by ema before train, 1399 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003129099396330009, unsupervised loss ratio: 1.0, lr 0.021, 683 pseu out of 1673 are correct, 0 correct by model, 0 correct by ema before train, 885 by model during train, total 2621
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003053463122341782, unsupervised loss ratio: 1.0, lr 0.021, 543 pseu out of 1360 are correct, 0 correct by model, 0 correct by ema before train, 670 by model during train, total 2298
Comm round 84 meta round 5 chosen client: [14, 8, 19, 2, 6]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0027612322592176497, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1387 are correct, 0 correct by model, 0 correct by ema before train, 75 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016967883091183467, unsupervised loss ratio: 1.0, lr 0.021, 2284 pseu out of 2963 are correct, 0 correct by model, 0 correct by ema before train, 2334 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003559356390420968, unsupervised loss ratio: 1.0, lr 0.021, 413 pseu out of 2914 are correct, 0 correct by model, 0 correct by ema before train, 1004 by model during train, total 4949
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0031214194910024248, unsupervised loss ratio: 1.0, lr 0.021, 393 pseu out of 1732 are correct, 0 correct by model, 0 correct by ema before train, 639 by model during train, total 2665
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0029667488339802494, unsupervised loss ratio: 1.0, lr 0.021, 1224 pseu out of 2947 are correct, 0 correct by model, 0 correct by ema before train, 1384 by model during train, total 4383
************ Loss Avg 0.002863684439096332, LR 0.03, Round 84 ends ************  

TEST Student: Epoch: 84

TEST AUROC: 0.740715, TEST Accus: 0.274624, TEST Pre: 0.237615, TEST Recall: 0.199794
Comm round 85 meta round 0 chosen client: [2, 8, 12, 11, 13]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002338938035314814, unsupervised loss ratio: 1.0, lr 0.021, 395 pseu out of 1691 are correct, 0 correct by model, 0 correct by ema before train, 623 by model during train, total 2665
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001393204841519946, unsupervised loss ratio: 1.0, lr 0.021, 2299 pseu out of 3016 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00210258665934412, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 4133 are correct, 0 correct by model, 0 correct by ema before train, 364 by model during train, total 5750
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0019080674755969085, unsupervised loss ratio: 1.0, lr 0.021, 1944 pseu out of 2777 are correct, 0 correct by model, 0 correct by ema before train, 2146 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003418273501388208, unsupervised loss ratio: 1.0, lr 0.021, 2139 pseu out of 3539 are correct, 0 correct by model, 0 correct by ema before train, 2183 by model during train, total 3739
Comm round 85 meta round 1 chosen client: [8, 4, 5, 13, 15]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0014495613240796956, unsupervised loss ratio: 1.0, lr 0.021, 2282 pseu out of 2997 are correct, 0 correct by model, 0 correct by ema before train, 2333 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001826783595976257, unsupervised loss ratio: 1.0, lr 0.021, 726 pseu out of 2793 are correct, 0 correct by model, 0 correct by ema before train, 987 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002176635470203139, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2534 are correct, 0 correct by model, 0 correct by ema before train, 358 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003251582911308121, unsupervised loss ratio: 1.0, lr 0.021, 2151 pseu out of 3563 are correct, 0 correct by model, 0 correct by ema before train, 2182 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0022113051187121666, unsupervised loss ratio: 1.0, lr 0.021, 21 pseu out of 2733 are correct, 0 correct by model, 0 correct by ema before train, 278 by model during train, total 4099
Comm round 85 meta round 2 chosen client: [17, 0, 3, 2, 16]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0015064566991634496, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4327 are correct, 0 correct by model, 0 correct by ema before train, 1103 by model during train, total 5558
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8303572219245288 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0029861917241110598, unsupervised loss ratio: 1.0, lr 0.021, 167 pseu out of 1863 are correct, 0 correct by model, 0 correct by ema before train, 375 by model during train, total 3526
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002339914443880497, unsupervised loss ratio: 1.0, lr 0.021, 384 pseu out of 1717 are correct, 0 correct by model, 0 correct by ema before train, 628 by model during train, total 2665
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0026413108294707586, unsupervised loss ratio: 1.0, lr 0.021, 475 pseu out of 2231 are correct, 0 correct by model, 0 correct by ema before train, 674 by model during train, total 3883
Comm round 85 meta round 3 chosen client: [9, 7, 18, 10, 16]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001650472081059383, unsupervised loss ratio: 1.0, lr 0.021, 58 pseu out of 1029 are correct, 0 correct by model, 0 correct by ema before train, 108 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0018903906972040064, unsupervised loss ratio: 1.0, lr 0.021, 497 pseu out of 2272 are correct, 0 correct by model, 0 correct by ema before train, 592 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002164774991494293, unsupervised loss ratio: 1.0, lr 0.021, 546 pseu out of 1361 are correct, 0 correct by model, 0 correct by ema before train, 677 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002206180212569648, unsupervised loss ratio: 1.0, lr 0.021, 674 pseu out of 2426 are correct, 0 correct by model, 0 correct by ema before train, 963 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0027885225727451875, unsupervised loss ratio: 1.0, lr 0.021, 487 pseu out of 2217 are correct, 0 correct by model, 0 correct by ema before train, 687 by model during train, total 3883
Comm round 85 meta round 4 chosen client: [17, 5, 1, 6, 11]
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0014410999786890187, unsupervised loss ratio: 1.0, lr 0.021, 1054 pseu out of 4364 are correct, 0 correct by model, 0 correct by ema before train, 1100 by model during train, total 5558
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002159699963665277, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2533 are correct, 0 correct by model, 0 correct by ema before train, 361 by model during train, total 3866
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0020746449377705774, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 1688 are correct, 0 correct by model, 0 correct by ema before train, 896 by model during train, total 2621
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0021010825758044057, unsupervised loss ratio: 1.0, lr 0.021, 1225 pseu out of 2936 are correct, 0 correct by model, 0 correct by ema before train, 1398 by model during train, total 4383
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001947279743035324, unsupervised loss ratio: 1.0, lr 0.021, 1938 pseu out of 2775 are correct, 0 correct by model, 0 correct by ema before train, 2131 by model during train, total 4088
Comm round 85 meta round 5 chosen client: [14, 1, 3, 7, 11]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015425076778752334, unsupervised loss ratio: 1.0, lr 0.021, 17 pseu out of 1405 are correct, 0 correct by model, 0 correct by ema before train, 79 by model during train, total 2083
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0021753687803383642, unsupervised loss ratio: 1.0, lr 0.021, 681 pseu out of 1697 are correct, 0 correct by model, 0 correct by ema before train, 872 by model during train, total 2621
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002972558079688627, unsupervised loss ratio: 1.0, lr 0.021, 174 pseu out of 1881 are correct, 0 correct by model, 0 correct by ema before train, 395 by model during train, total 3526
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0019654662946077925, unsupervised loss ratio: 1.0, lr 0.021, 498 pseu out of 2287 are correct, 0 correct by model, 0 correct by ema before train, 593 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0020022284788865363, unsupervised loss ratio: 1.0, lr 0.021, 1949 pseu out of 2823 are correct, 0 correct by model, 0 correct by ema before train, 2133 by model during train, total 4088
************ Loss Avg 0.02956624802828683, LR 0.03, Round 85 ends ************  

TEST Student: Epoch: 85

TEST AUROC: 0.746047, TEST Accus: 0.285994, TEST Pre: 0.217847, TEST Recall: 0.214275
Comm round 86 meta round 0 chosen client: [4, 15, 18, 17, 14]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020053586802474916, unsupervised loss ratio: 1.0, lr 0.021, 728 pseu out of 2806 are correct, 0 correct by model, 0 correct by ema before train, 1004 by model during train, total 3987
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0023007117253235686, unsupervised loss ratio: 1.0, lr 0.021, 25 pseu out of 2772 are correct, 0 correct by model, 0 correct by ema before train, 269 by model during train, total 4099
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0024376319537016875, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 1370 are correct, 0 correct by model, 0 correct by ema before train, 668 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0016695546011718783, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4373 are correct, 0 correct by model, 0 correct by ema before train, 1114 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001954020787679562, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 1439 are correct, 0 correct by model, 0 correct by ema before train, 83 by model during train, total 2083
Comm round 86 meta round 1 chosen client: [4, 3, 19, 5, 7]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0019856193906716293, unsupervised loss ratio: 1.0, lr 0.021, 723 pseu out of 2844 are correct, 0 correct by model, 0 correct by ema before train, 974 by model during train, total 3987
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003211297454202265, unsupervised loss ratio: 1.0, lr 0.021, 174 pseu out of 1891 are correct, 0 correct by model, 0 correct by ema before train, 401 by model during train, total 3526
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0030150261859839354, unsupervised loss ratio: 1.0, lr 0.021, 440 pseu out of 2911 are correct, 0 correct by model, 0 correct by ema before train, 982 by model during train, total 4949
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00223944708609526, unsupervised loss ratio: 1.0, lr 0.021, 298 pseu out of 2541 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002267707787373533, unsupervised loss ratio: 1.0, lr 0.021, 498 pseu out of 2301 are correct, 0 correct by model, 0 correct by ema before train, 596 by model during train, total 3280
Comm round 86 meta round 2 chosen client: [5, 7, 4, 11, 9]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0023826137519075124, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2585 are correct, 0 correct by model, 0 correct by ema before train, 367 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0022989947297341693, unsupervised loss ratio: 1.0, lr 0.021, 496 pseu out of 2310 are correct, 0 correct by model, 0 correct by ema before train, 594 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020223007447803245, unsupervised loss ratio: 1.0, lr 0.021, 724 pseu out of 2831 are correct, 0 correct by model, 0 correct by ema before train, 983 by model during train, total 3987
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0020433197223610478, unsupervised loss ratio: 1.0, lr 0.021, 1950 pseu out of 2821 are correct, 0 correct by model, 0 correct by ema before train, 2164 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0020894852900204975, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 1021 are correct, 0 correct by model, 0 correct by ema before train, 104 by model during train, total 1677
Comm round 86 meta round 3 chosen client: [11, 9, 6, 13, 19]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002082855304252007, unsupervised loss ratio: 1.0, lr 0.021, 1955 pseu out of 2810 are correct, 0 correct by model, 0 correct by ema before train, 2127 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0020282731148418627, unsupervised loss ratio: 1.0, lr 0.021, 57 pseu out of 1058 are correct, 0 correct by model, 0 correct by ema before train, 108 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0021535230571053166, unsupervised loss ratio: 1.0, lr 0.021, 1229 pseu out of 2943 are correct, 0 correct by model, 0 correct by ema before train, 1395 by model during train, total 4383
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.000391960089041662, unsupervised loss ratio: 1.0, lr 0.021, 2142 pseu out of 3554 are correct, 0 correct by model, 0 correct by ema before train, 2183 by model during train, total 3739
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003020237152202007, unsupervised loss ratio: 1.0, lr 0.021, 434 pseu out of 2939 are correct, 0 correct by model, 0 correct by ema before train, 1039 by model during train, total 4949
Comm round 86 meta round 4 chosen client: [0, 1, 7, 15, 14]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8186345720777706 lr : 0.03
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002337239926862644, unsupervised loss ratio: 1.0, lr 0.021, 692 pseu out of 1734 are correct, 0 correct by model, 0 correct by ema before train, 891 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0022447669986062325, unsupervised loss ratio: 1.0, lr 0.021, 501 pseu out of 2300 are correct, 0 correct by model, 0 correct by ema before train, 605 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0022955328826076136, unsupervised loss ratio: 1.0, lr 0.021, 29 pseu out of 2785 are correct, 0 correct by model, 0 correct by ema before train, 247 by model during train, total 4099
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0018330536452898134, unsupervised loss ratio: 1.0, lr 0.021, 18 pseu out of 1420 are correct, 0 correct by model, 0 correct by ema before train, 93 by model during train, total 2083
Comm round 86 meta round 5 chosen client: [1, 13, 4, 9, 2]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0022853324502115934, unsupervised loss ratio: 1.0, lr 0.021, 683 pseu out of 1713 are correct, 0 correct by model, 0 correct by ema before train, 907 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003799854330590263, unsupervised loss ratio: 1.0, lr 0.021, 2152 pseu out of 3572 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001980848114250139, unsupervised loss ratio: 1.0, lr 0.021, 724 pseu out of 2871 are correct, 0 correct by model, 0 correct by ema before train, 997 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018667642078879806, unsupervised loss ratio: 1.0, lr 0.021, 58 pseu out of 1072 are correct, 0 correct by model, 0 correct by ema before train, 104 by model during train, total 1677
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.00247447651677898, unsupervised loss ratio: 1.0, lr 0.021, 378 pseu out of 1748 are correct, 0 correct by model, 0 correct by ema before train, 614 by model during train, total 2665
************ Loss Avg 0.02933108369540073, LR 0.03, Round 86 ends ************  

TEST Student: Epoch: 86

TEST AUROC: 0.752761, TEST Accus: 0.298287, TEST Pre: 0.212969, TEST Recall: 0.229996
Comm round 87 meta round 0 chosen client: [5, 1, 9, 6, 16]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002504162161160627, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2622 are correct, 0 correct by model, 0 correct by ema before train, 370 by model during train, total 3866
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0025487316760984136, unsupervised loss ratio: 1.0, lr 0.021, 680 pseu out of 1701 are correct, 0 correct by model, 0 correct by ema before train, 889 by model during train, total 2621
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0020915790605445014, unsupervised loss ratio: 1.0, lr 0.021, 63 pseu out of 1040 are correct, 0 correct by model, 0 correct by ema before train, 111 by model during train, total 1677
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.00243833702246564, unsupervised loss ratio: 1.0, lr 0.021, 1232 pseu out of 2975 are correct, 0 correct by model, 0 correct by ema before train, 1402 by model during train, total 4383
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0030214909319078824, unsupervised loss ratio: 1.0, lr 0.021, 485 pseu out of 2200 are correct, 0 correct by model, 0 correct by ema before train, 688 by model during train, total 3883
Comm round 87 meta round 1 chosen client: [13, 15, 6, 12, 9]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004899472728770195, unsupervised loss ratio: 1.0, lr 0.021, 2163 pseu out of 3601 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0024569548818712626, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 2781 are correct, 0 correct by model, 0 correct by ema before train, 263 by model during train, total 4099
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0024011025949300306, unsupervised loss ratio: 1.0, lr 0.021, 1229 pseu out of 2982 are correct, 0 correct by model, 0 correct by ema before train, 1409 by model during train, total 4383
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002335072643149437, unsupervised loss ratio: 1.0, lr 0.021, 68 pseu out of 4118 are correct, 0 correct by model, 0 correct by ema before train, 354 by model during train, total 5750
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0023164137339874826, unsupervised loss ratio: 1.0, lr 0.021, 61 pseu out of 1057 are correct, 0 correct by model, 0 correct by ema before train, 121 by model during train, total 1677
Comm round 87 meta round 2 chosen client: [6, 0, 18, 8, 5]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0024125110746050873, unsupervised loss ratio: 1.0, lr 0.021, 1235 pseu out of 3008 are correct, 0 correct by model, 0 correct by ema before train, 1407 by model during train, total 4383
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.816943455107358 lr : 0.03
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0026039861259050667, unsupervised loss ratio: 1.0, lr 0.021, 544 pseu out of 1372 are correct, 0 correct by model, 0 correct by ema before train, 680 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015052736823690793, unsupervised loss ratio: 1.0, lr 0.021, 2291 pseu out of 3002 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002554042386959811, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2583 are correct, 0 correct by model, 0 correct by ema before train, 367 by model during train, total 3866
Comm round 87 meta round 3 chosen client: [13, 3, 16, 9, 12]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004904800705351251, unsupervised loss ratio: 1.0, lr 0.021, 2153 pseu out of 3583 are correct, 0 correct by model, 0 correct by ema before train, 2184 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003378657654528589, unsupervised loss ratio: 1.0, lr 0.021, 176 pseu out of 1883 are correct, 0 correct by model, 0 correct by ema before train, 392 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0030603975851516254, unsupervised loss ratio: 1.0, lr 0.021, 478 pseu out of 2259 are correct, 0 correct by model, 0 correct by ema before train, 667 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0022252491741070386, unsupervised loss ratio: 1.0, lr 0.021, 62 pseu out of 1056 are correct, 0 correct by model, 0 correct by ema before train, 119 by model during train, total 1677
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002295993487091942, unsupervised loss ratio: 1.0, lr 0.021, 73 pseu out of 4124 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 5750
Comm round 87 meta round 4 chosen client: [9, 17, 12, 1, 8]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0021650091016285674, unsupervised loss ratio: 1.0, lr 0.021, 57 pseu out of 1054 are correct, 0 correct by model, 0 correct by ema before train, 108 by model during train, total 1677
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017094426626478717, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4353 are correct, 0 correct by model, 0 correct by ema before train, 1105 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002295170499322315, unsupervised loss ratio: 1.0, lr 0.021, 72 pseu out of 4194 are correct, 0 correct by model, 0 correct by ema before train, 350 by model during train, total 5750
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0024037236779383044, unsupervised loss ratio: 1.0, lr 0.021, 699 pseu out of 1746 are correct, 0 correct by model, 0 correct by ema before train, 892 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015081244036991848, unsupervised loss ratio: 1.0, lr 0.021, 2291 pseu out of 3006 are correct, 0 correct by model, 0 correct by ema before train, 2330 by model during train, total 4036
Comm round 87 meta round 5 chosen client: [10, 7, 12, 0, 14]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002457362257449984, unsupervised loss ratio: 1.0, lr 0.021, 690 pseu out of 2370 are correct, 0 correct by model, 0 correct by ema before train, 975 by model during train, total 3684
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0025952510376765323, unsupervised loss ratio: 1.0, lr 0.021, 497 pseu out of 2330 are correct, 0 correct by model, 0 correct by ema before train, 603 by model during train, total 3280
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0023955688061606554, unsupervised loss ratio: 1.0, lr 0.021, 74 pseu out of 4210 are correct, 0 correct by model, 0 correct by ema before train, 366 by model during train, total 5750
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8125063971597322 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.00197186361765489, unsupervised loss ratio: 1.0, lr 0.021, 21 pseu out of 1431 are correct, 0 correct by model, 0 correct by ema before train, 92 by model during train, total 2083
************ Loss Avg 0.05640272505171713, LR 0.03, Round 87 ends ************  

TEST Student: Epoch: 87

TEST AUROC: 0.765402, TEST Accus: 0.315112, TEST Pre: 0.199676, TEST Recall: 0.253134
Comm round 88 meta round 0 chosen client: [1, 7, 6, 3, 4]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0030140425731632406, unsupervised loss ratio: 1.0, lr 0.021, 689 pseu out of 1748 are correct, 0 correct by model, 0 correct by ema before train, 884 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002938518550273819, unsupervised loss ratio: 1.0, lr 0.021, 501 pseu out of 2292 are correct, 0 correct by model, 0 correct by ema before train, 620 by model during train, total 3280
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002688248018376475, unsupervised loss ratio: 1.0, lr 0.021, 1230 pseu out of 2957 are correct, 0 correct by model, 0 correct by ema before train, 1399 by model during train, total 4383
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003579161734835777, unsupervised loss ratio: 1.0, lr 0.021, 196 pseu out of 1900 are correct, 0 correct by model, 0 correct by ema before train, 403 by model during train, total 3526
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0023138088632434135, unsupervised loss ratio: 1.0, lr 0.021, 729 pseu out of 2855 are correct, 0 correct by model, 0 correct by ema before train, 1008 by model during train, total 3987
Comm round 88 meta round 1 chosen client: [15, 2, 11, 9, 5]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002765180800410095, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 2728 are correct, 0 correct by model, 0 correct by ema before train, 257 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0029638508068663733, unsupervised loss ratio: 1.0, lr 0.021, 385 pseu out of 1736 are correct, 0 correct by model, 0 correct by ema before train, 628 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002472126237989869, unsupervised loss ratio: 1.0, lr 0.021, 1963 pseu out of 2830 are correct, 0 correct by model, 0 correct by ema before train, 2137 by model during train, total 4088
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0028621928412812174, unsupervised loss ratio: 1.0, lr 0.021, 60 pseu out of 1067 are correct, 0 correct by model, 0 correct by ema before train, 120 by model during train, total 1677
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.003009372958569925, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2602 are correct, 0 correct by model, 0 correct by ema before train, 371 by model during train, total 3866
Comm round 88 meta round 2 chosen client: [12, 7, 15, 19, 18]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0026452201871304875, unsupervised loss ratio: 1.0, lr 0.021, 70 pseu out of 4108 are correct, 0 correct by model, 0 correct by ema before train, 369 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0029021207894682167, unsupervised loss ratio: 1.0, lr 0.021, 509 pseu out of 2280 are correct, 0 correct by model, 0 correct by ema before train, 617 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002781668298121076, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 2758 are correct, 0 correct by model, 0 correct by ema before train, 274 by model during train, total 4099
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00331182331025887, unsupervised loss ratio: 1.0, lr 0.021, 409 pseu out of 2969 are correct, 0 correct by model, 0 correct by ema before train, 999 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0028054154083494926, unsupervised loss ratio: 1.0, lr 0.021, 544 pseu out of 1358 are correct, 0 correct by model, 0 correct by ema before train, 678 by model during train, total 2298
Comm round 88 meta round 3 chosen client: [2, 3, 16, 15, 9]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0027809874043755586, unsupervised loss ratio: 1.0, lr 0.021, 397 pseu out of 1765 are correct, 0 correct by model, 0 correct by ema before train, 640 by model during train, total 2665
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0036397102433381534, unsupervised loss ratio: 1.0, lr 0.021, 185 pseu out of 1909 are correct, 0 correct by model, 0 correct by ema before train, 406 by model during train, total 3526
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0034470837486938375, unsupervised loss ratio: 1.0, lr 0.021, 498 pseu out of 2242 are correct, 0 correct by model, 0 correct by ema before train, 667 by model during train, total 3883
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0027799893737000484, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 2770 are correct, 0 correct by model, 0 correct by ema before train, 276 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0029305252289675452, unsupervised loss ratio: 1.0, lr 0.021, 61 pseu out of 1072 are correct, 0 correct by model, 0 correct by ema before train, 112 by model during train, total 1677
Comm round 88 meta round 4 chosen client: [6, 1, 15, 8, 10]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002685147815087027, unsupervised loss ratio: 1.0, lr 0.021, 1227 pseu out of 2914 are correct, 0 correct by model, 0 correct by ema before train, 1409 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002836388646534122, unsupervised loss ratio: 1.0, lr 0.021, 695 pseu out of 1720 are correct, 0 correct by model, 0 correct by ema before train, 911 by model during train, total 2621
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0027549658621585245, unsupervised loss ratio: 1.0, lr 0.021, 37 pseu out of 2790 are correct, 0 correct by model, 0 correct by ema before train, 293 by model during train, total 4099
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016225366208004743, unsupervised loss ratio: 1.0, lr 0.021, 2302 pseu out of 3044 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002912661253378309, unsupervised loss ratio: 1.0, lr 0.021, 694 pseu out of 2395 are correct, 0 correct by model, 0 correct by ema before train, 969 by model during train, total 3684
Comm round 88 meta round 5 chosen client: [5, 19, 13, 8, 18]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0029188630163486376, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2604 are correct, 0 correct by model, 0 correct by ema before train, 365 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003346941441309471, unsupervised loss ratio: 1.0, lr 0.021, 444 pseu out of 2996 are correct, 0 correct by model, 0 correct by ema before train, 1008 by model during train, total 4949
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0005907399382075231, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3582 are correct, 0 correct by model, 0 correct by ema before train, 2185 by model during train, total 3739
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015487310192980885, unsupervised loss ratio: 1.0, lr 0.021, 2305 pseu out of 3044 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0029686908884387878, unsupervised loss ratio: 1.0, lr 0.021, 548 pseu out of 1355 are correct, 0 correct by model, 0 correct by ema before train, 682 by model during train, total 2298
************ Loss Avg 0.0027605571292991485, LR 0.03, Round 88 ends ************  

TEST Student: Epoch: 88

TEST AUROC: 0.740714, TEST Accus: 0.274585, TEST Pre: 0.236733, TEST Recall: 0.199211
Comm round 89 meta round 0 chosen client: [13, 14, 12, 6, 0]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00029109879996197426, unsupervised loss ratio: 1.0, lr 0.021, 2154 pseu out of 3583 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001575795848938552, unsupervised loss ratio: 1.0, lr 0.021, 20 pseu out of 1431 are correct, 0 correct by model, 0 correct by ema before train, 91 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.001919541693577129, unsupervised loss ratio: 1.0, lr 0.021, 79 pseu out of 4215 are correct, 0 correct by model, 0 correct by ema before train, 363 by model during train, total 5750
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002121086358902571, unsupervised loss ratio: 1.0, lr 0.021, 1235 pseu out of 2927 are correct, 0 correct by model, 0 correct by ema before train, 1410 by model during train, total 4383
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8426971034127839 lr : 0.03
Comm round 89 meta round 1 chosen client: [11, 8, 16, 17, 10]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0019033712869713781, unsupervised loss ratio: 1.0, lr 0.021, 1956 pseu out of 2795 are correct, 0 correct by model, 0 correct by ema before train, 2161 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.001401904545787147, unsupervised loss ratio: 1.0, lr 0.021, 2294 pseu out of 3035 are correct, 0 correct by model, 0 correct by ema before train, 2333 by model during train, total 4036
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0027191341705772964, unsupervised loss ratio: 1.0, lr 0.021, 493 pseu out of 2215 are correct, 0 correct by model, 0 correct by ema before train, 695 by model during train, total 3883
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.00144330756377493, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4411 are correct, 0 correct by model, 0 correct by ema before train, 1104 by model during train, total 5558
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002237722226458698, unsupervised loss ratio: 1.0, lr 0.021, 697 pseu out of 2419 are correct, 0 correct by model, 0 correct by ema before train, 995 by model during train, total 3684
Comm round 89 meta round 2 chosen client: [13, 14, 5, 16, 3]
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00032671777912814137, unsupervised loss ratio: 1.0, lr 0.021, 2149 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0015049655798286426, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 1410 are correct, 0 correct by model, 0 correct by ema before train, 81 by model during train, total 2083
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0021047692509276457, unsupervised loss ratio: 1.0, lr 0.021, 291 pseu out of 2634 are correct, 0 correct by model, 0 correct by ema before train, 353 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0027767106314327142, unsupervised loss ratio: 1.0, lr 0.021, 504 pseu out of 2253 are correct, 0 correct by model, 0 correct by ema before train, 687 by model during train, total 3883
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.002959493289641354, unsupervised loss ratio: 1.0, lr 0.021, 196 pseu out of 1908 are correct, 0 correct by model, 0 correct by ema before train, 422 by model during train, total 3526
Comm round 89 meta round 3 chosen client: [5, 19, 12, 4, 18]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.00210778808915896, unsupervised loss ratio: 1.0, lr 0.021, 298 pseu out of 2617 are correct, 0 correct by model, 0 correct by ema before train, 368 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0028693623578128144, unsupervised loss ratio: 1.0, lr 0.021, 455 pseu out of 3018 are correct, 0 correct by model, 0 correct by ema before train, 1020 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0019523969540993372, unsupervised loss ratio: 1.0, lr 0.021, 76 pseu out of 4300 are correct, 0 correct by model, 0 correct by ema before train, 354 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.001892558675968931, unsupervised loss ratio: 1.0, lr 0.021, 729 pseu out of 2847 are correct, 0 correct by model, 0 correct by ema before train, 1003 by model during train, total 3987
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002135244993648181, unsupervised loss ratio: 1.0, lr 0.021, 546 pseu out of 1399 are correct, 0 correct by model, 0 correct by ema before train, 676 by model during train, total 2298
Comm round 89 meta round 4 chosen client: [12, 5, 0, 7, 11]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0019212750776205212, unsupervised loss ratio: 1.0, lr 0.021, 70 pseu out of 4268 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002089718653492202, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2652 are correct, 0 correct by model, 0 correct by ema before train, 359 by model during train, total 3866
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8478501633721955 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.001902562446328095, unsupervised loss ratio: 1.0, lr 0.021, 506 pseu out of 2260 are correct, 0 correct by model, 0 correct by ema before train, 629 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.001969933202417451, unsupervised loss ratio: 1.0, lr 0.021, 1962 pseu out of 2848 are correct, 0 correct by model, 0 correct by ema before train, 2147 by model during train, total 4088
Comm round 89 meta round 5 chosen client: [0, 5, 11, 15, 9]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8765822004298774 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002088233183489227, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2673 are correct, 0 correct by model, 0 correct by ema before train, 373 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0018711171660470427, unsupervised loss ratio: 1.0, lr 0.021, 1979 pseu out of 2875 are correct, 0 correct by model, 0 correct by ema before train, 2149 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002216192850923667, unsupervised loss ratio: 1.0, lr 0.021, 31 pseu out of 2787 are correct, 0 correct by model, 0 correct by ema before train, 283 by model during train, total 4099
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0016698502198172112, unsupervised loss ratio: 1.0, lr 0.021, 65 pseu out of 1072 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 1677
************ Loss Avg 0.08730337733705294, LR 0.03, Round 89 ends ************  

TEST Student: Epoch: 89

TEST AUROC: 0.786706, TEST Accus: 0.347956, TEST Pre: 0.398447, TEST Recall: 0.295635
Comm round 90 meta round 0 chosen client: [15, 0, 3, 11, 13]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003970156012823841, unsupervised loss ratio: 1.0, lr 0.021, 32 pseu out of 2766 are correct, 0 correct by model, 0 correct by ema before train, 287 by model during train, total 4099
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7725855075583166 lr : 0.03
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004997924201493983, unsupervised loss ratio: 1.0, lr 0.021, 192 pseu out of 1880 are correct, 0 correct by model, 0 correct by ema before train, 420 by model during train, total 3526
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003262225571234012, unsupervised loss ratio: 1.0, lr 0.021, 1964 pseu out of 2851 are correct, 0 correct by model, 0 correct by ema before train, 2155 by model during train, total 4088
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0011627877013209293, unsupervised loss ratio: 1.0, lr 0.021, 2145 pseu out of 3589 are correct, 0 correct by model, 0 correct by ema before train, 2183 by model during train, total 3739
Comm round 90 meta round 1 chosen client: [0, 7, 15, 11, 8]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7802824803761074 lr : 0.03
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.004646643496436389, unsupervised loss ratio: 1.0, lr 0.021, 507 pseu out of 2272 are correct, 0 correct by model, 0 correct by ema before train, 628 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003829579207096965, unsupervised loss ratio: 1.0, lr 0.021, 33 pseu out of 2778 are correct, 0 correct by model, 0 correct by ema before train, 293 by model during train, total 4099
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003068087484280113, unsupervised loss ratio: 1.0, lr 0.021, 1975 pseu out of 2845 are correct, 0 correct by model, 0 correct by ema before train, 2169 by model during train, total 4088
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0021923811365880397, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3055 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Comm round 90 meta round 2 chosen client: [1, 7, 17, 8, 9]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.004257695925444728, unsupervised loss ratio: 1.0, lr 0.021, 704 pseu out of 1730 are correct, 0 correct by model, 0 correct by ema before train, 903 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.004398096669599629, unsupervised loss ratio: 1.0, lr 0.021, 502 pseu out of 2235 are correct, 0 correct by model, 0 correct by ema before train, 622 by model during train, total 3280
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.003050002737115298, unsupervised loss ratio: 1.0, lr 0.021, 1059 pseu out of 4374 are correct, 0 correct by model, 0 correct by ema before train, 1104 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0021692487719313647, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 3045 are correct, 0 correct by model, 0 correct by ema before train, 2334 by model during train, total 4036
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00459879482406433, unsupervised loss ratio: 1.0, lr 0.021, 69 pseu out of 1070 are correct, 0 correct by model, 0 correct by ema before train, 121 by model during train, total 1677
Comm round 90 meta round 3 chosen client: [18, 10, 17, 12, 16]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.004185733569708343, unsupervised loss ratio: 1.0, lr 0.021, 550 pseu out of 1369 are correct, 0 correct by model, 0 correct by ema before train, 672 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004102708589173211, unsupervised loss ratio: 1.0, lr 0.021, 694 pseu out of 2358 are correct, 0 correct by model, 0 correct by ema before train, 982 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0029264228932302573, unsupervised loss ratio: 1.0, lr 0.021, 1056 pseu out of 4334 are correct, 0 correct by model, 0 correct by ema before train, 1102 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0037476053008706207, unsupervised loss ratio: 1.0, lr 0.021, 91 pseu out of 4233 are correct, 0 correct by model, 0 correct by ema before train, 400 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004881119307848151, unsupervised loss ratio: 1.0, lr 0.021, 502 pseu out of 2242 are correct, 0 correct by model, 0 correct by ema before train, 688 by model during train, total 3883
Comm round 90 meta round 4 chosen client: [10, 8, 4, 16, 0]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.003736084206672064, unsupervised loss ratio: 1.0, lr 0.021, 705 pseu out of 2362 are correct, 0 correct by model, 0 correct by ema before train, 1001 by model during train, total 3684
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0021126767774148902, unsupervised loss ratio: 1.0, lr 0.021, 2289 pseu out of 3008 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0032722020534695024, unsupervised loss ratio: 1.0, lr 0.021, 726 pseu out of 2860 are correct, 0 correct by model, 0 correct by ema before train, 1006 by model during train, total 3987
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004684970538574653, unsupervised loss ratio: 1.0, lr 0.021, 513 pseu out of 2246 are correct, 0 correct by model, 0 correct by ema before train, 715 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7727715008112849 lr : 0.03
Comm round 90 meta round 5 chosen client: [15, 5, 11, 2, 18]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003810745865205088, unsupervised loss ratio: 1.0, lr 0.021, 37 pseu out of 2701 are correct, 0 correct by model, 0 correct by ema before train, 281 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.004366618270993416, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2670 are correct, 0 correct by model, 0 correct by ema before train, 360 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003222360292056692, unsupervised loss ratio: 1.0, lr 0.021, 1979 pseu out of 2825 are correct, 0 correct by model, 0 correct by ema before train, 2154 by model during train, total 4088
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003824551210051314, unsupervised loss ratio: 1.0, lr 0.021, 397 pseu out of 1707 are correct, 0 correct by model, 0 correct by ema before train, 636 by model during train, total 2665
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.004033466218970716, unsupervised loss ratio: 1.0, lr 0.021, 548 pseu out of 1377 are correct, 0 correct by model, 0 correct by ema before train, 686 by model during train, total 2298
************ Loss Avg 0.08080501258597925, LR 0.03, Round 90 ends ************  

TEST Student: Epoch: 90

TEST AUROC: 0.796756, TEST Accus: 0.365512, TEST Pre: 0.368721, TEST Recall: 0.321308
Comm round 91 meta round 0 chosen client: [5, 15, 12, 2, 14]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.005061550046790575, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2591 are correct, 0 correct by model, 0 correct by ema before train, 370 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.004434830745203027, unsupervised loss ratio: 1.0, lr 0.021, 40 pseu out of 2691 are correct, 0 correct by model, 0 correct by ema before train, 290 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.004621789376768801, unsupervised loss ratio: 1.0, lr 0.021, 99 pseu out of 4200 are correct, 0 correct by model, 0 correct by ema before train, 421 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.004469694780363213, unsupervised loss ratio: 1.0, lr 0.021, 395 pseu out of 1707 are correct, 0 correct by model, 0 correct by ema before train, 645 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0054453619981579705, unsupervised loss ratio: 1.0, lr 0.021, 19 pseu out of 1436 are correct, 0 correct by model, 0 correct by ema before train, 81 by model during train, total 2083
Comm round 91 meta round 1 chosen client: [7, 13, 14, 8, 11]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0054220583697315305, unsupervised loss ratio: 1.0, lr 0.021, 507 pseu out of 2199 are correct, 0 correct by model, 0 correct by ema before train, 633 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0014325634939438205, unsupervised loss ratio: 1.0, lr 0.021, 2147 pseu out of 3561 are correct, 0 correct by model, 0 correct by ema before train, 2187 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.005077352764959814, unsupervised loss ratio: 1.0, lr 0.021, 21 pseu out of 1414 are correct, 0 correct by model, 0 correct by ema before train, 83 by model during train, total 2083
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0023464875491754356, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 2988 are correct, 0 correct by model, 0 correct by ema before train, 2334 by model during train, total 4036
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.003448721534368815, unsupervised loss ratio: 1.0, lr 0.021, 1986 pseu out of 2826 are correct, 0 correct by model, 0 correct by ema before train, 2160 by model during train, total 4088
Comm round 91 meta round 2 chosen client: [5, 7, 18, 10, 17]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.004729346000039798, unsupervised loss ratio: 1.0, lr 0.021, 299 pseu out of 2551 are correct, 0 correct by model, 0 correct by ema before train, 371 by model during train, total 3866
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.005286841409262986, unsupervised loss ratio: 1.0, lr 0.021, 507 pseu out of 2172 are correct, 0 correct by model, 0 correct by ema before train, 642 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.004583342886892044, unsupervised loss ratio: 1.0, lr 0.021, 547 pseu out of 1323 are correct, 0 correct by model, 0 correct by ema before train, 695 by model during train, total 2298
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004246917151813877, unsupervised loss ratio: 1.0, lr 0.021, 715 pseu out of 2388 are correct, 0 correct by model, 0 correct by ema before train, 1012 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.003422805640696623, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4253 are correct, 0 correct by model, 0 correct by ema before train, 1109 by model during train, total 5558
Comm round 91 meta round 3 chosen client: [4, 5, 11, 12, 16]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0037413518376914518, unsupervised loss ratio: 1.0, lr 0.021, 730 pseu out of 2813 are correct, 0 correct by model, 0 correct by ema before train, 1021 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0048420267660537215, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2462 are correct, 0 correct by model, 0 correct by ema before train, 385 by model during train, total 3866
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0032999865725287236, unsupervised loss ratio: 1.0, lr 0.021, 1988 pseu out of 2755 are correct, 0 correct by model, 0 correct by ema before train, 2191 by model during train, total 4088
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.00457495877182939, unsupervised loss ratio: 1.0, lr 0.021, 99 pseu out of 4163 are correct, 0 correct by model, 0 correct by ema before train, 429 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.005258588276834029, unsupervised loss ratio: 1.0, lr 0.021, 534 pseu out of 2193 are correct, 0 correct by model, 0 correct by ema before train, 736 by model during train, total 3883
Comm round 91 meta round 4 chosen client: [9, 14, 6, 1, 8]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0053456882144221, unsupervised loss ratio: 1.0, lr 0.021, 68 pseu out of 1063 are correct, 0 correct by model, 0 correct by ema before train, 120 by model during train, total 1677
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.005082491160878403, unsupervised loss ratio: 1.0, lr 0.021, 24 pseu out of 1401 are correct, 0 correct by model, 0 correct by ema before train, 97 by model during train, total 2083
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.004572369666108727, unsupervised loss ratio: 1.0, lr 0.021, 1230 pseu out of 2940 are correct, 0 correct by model, 0 correct by ema before train, 1410 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0049426510714267085, unsupervised loss ratio: 1.0, lr 0.021, 695 pseu out of 1688 are correct, 0 correct by model, 0 correct by ema before train, 906 by model during train, total 2621
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0024048999362094037, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 2996 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Comm round 91 meta round 5 chosen client: [2, 14, 11, 10, 0]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.004421906895004213, unsupervised loss ratio: 1.0, lr 0.021, 410 pseu out of 1696 are correct, 0 correct by model, 0 correct by ema before train, 657 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.005019387985212785, unsupervised loss ratio: 1.0, lr 0.021, 22 pseu out of 1399 are correct, 0 correct by model, 0 correct by ema before train, 100 by model during train, total 2083
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0032880114067666, unsupervised loss ratio: 1.0, lr 0.021, 2013 pseu out of 2755 are correct, 0 correct by model, 0 correct by ema before train, 2176 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.004318679223270637, unsupervised loss ratio: 1.0, lr 0.021, 722 pseu out of 2310 are correct, 0 correct by model, 0 correct by ema before train, 1035 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7483889144294116 lr : 0.03
************ Loss Avg 0.029117719198727226, LR 0.03, Round 91 ends ************  

TEST Student: Epoch: 91

TEST AUROC: 0.780183, TEST Accus: 0.334166, TEST Pre: 0.265544, TEST Recall: 0.279427
Comm round 92 meta round 0 chosen client: [8, 14, 6, 1, 7]
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0018074123597102698, unsupervised loss ratio: 1.0, lr 0.021, 2278 pseu out of 2978 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002880641216920181, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 1397 are correct, 0 correct by model, 0 correct by ema before train, 101 by model during train, total 2083
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.003039950844021919, unsupervised loss ratio: 1.0, lr 0.021, 1232 pseu out of 2936 are correct, 0 correct by model, 0 correct by ema before train, 1406 by model during train, total 4383
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003178890893894543, unsupervised loss ratio: 1.0, lr 0.021, 696 pseu out of 1687 are correct, 0 correct by model, 0 correct by ema before train, 906 by model during train, total 2621
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0034101216834432515, unsupervised loss ratio: 1.0, lr 0.021, 516 pseu out of 2120 are correct, 0 correct by model, 0 correct by ema before train, 646 by model during train, total 3280
Comm round 92 meta round 1 chosen client: [1, 16, 7, 15, 10]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0032044652190695447, unsupervised loss ratio: 1.0, lr 0.021, 699 pseu out of 1629 are correct, 0 correct by model, 0 correct by ema before train, 946 by model during train, total 2621
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0037886537802329315, unsupervised loss ratio: 1.0, lr 0.021, 542 pseu out of 2168 are correct, 0 correct by model, 0 correct by ema before train, 747 by model during train, total 3883
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003501285996417909, unsupervised loss ratio: 1.0, lr 0.021, 519 pseu out of 2173 are correct, 0 correct by model, 0 correct by ema before train, 666 by model during train, total 3280
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0031012974935247955, unsupervised loss ratio: 1.0, lr 0.021, 43 pseu out of 2632 are correct, 0 correct by model, 0 correct by ema before train, 305 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.003152437917567019, unsupervised loss ratio: 1.0, lr 0.021, 730 pseu out of 2303 are correct, 0 correct by model, 0 correct by ema before train, 1027 by model during train, total 3684
Comm round 92 meta round 2 chosen client: [1, 12, 15, 4, 10]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00328967048468568, unsupervised loss ratio: 1.0, lr 0.021, 709 pseu out of 1690 are correct, 0 correct by model, 0 correct by ema before train, 920 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0031194158299412164, unsupervised loss ratio: 1.0, lr 0.021, 114 pseu out of 4175 are correct, 0 correct by model, 0 correct by ema before train, 452 by model during train, total 5750
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0032554984938682396, unsupervised loss ratio: 1.0, lr 0.021, 44 pseu out of 2639 are correct, 0 correct by model, 0 correct by ema before train, 309 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0026561878612338906, unsupervised loss ratio: 1.0, lr 0.021, 746 pseu out of 2849 are correct, 0 correct by model, 0 correct by ema before train, 1029 by model during train, total 3987
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.00317201349314238, unsupervised loss ratio: 1.0, lr 0.021, 749 pseu out of 2343 are correct, 0 correct by model, 0 correct by ema before train, 1034 by model during train, total 3684
Comm round 92 meta round 3 chosen client: [11, 4, 18, 3, 15]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0026060172294819495, unsupervised loss ratio: 1.0, lr 0.021, 1992 pseu out of 2719 are correct, 0 correct by model, 0 correct by ema before train, 2215 by model during train, total 4088
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0027242945026724583, unsupervised loss ratio: 1.0, lr 0.021, 743 pseu out of 2815 are correct, 0 correct by model, 0 correct by ema before train, 1034 by model during train, total 3987
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0033448617711352804, unsupervised loss ratio: 1.0, lr 0.021, 552 pseu out of 1351 are correct, 0 correct by model, 0 correct by ema before train, 702 by model during train, total 2298
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004086106046348245, unsupervised loss ratio: 1.0, lr 0.021, 192 pseu out of 1917 are correct, 0 correct by model, 0 correct by ema before train, 407 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0031866342422290474, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 2628 are correct, 0 correct by model, 0 correct by ema before train, 313 by model during train, total 4099
Comm round 92 meta round 4 chosen client: [11, 6, 19, 9, 0]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002507755627448205, unsupervised loss ratio: 1.0, lr 0.021, 1997 pseu out of 2717 are correct, 0 correct by model, 0 correct by ema before train, 2204 by model during train, total 4088
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.003057043378551801, unsupervised loss ratio: 1.0, lr 0.021, 1244 pseu out of 2875 are correct, 0 correct by model, 0 correct by ema before train, 1429 by model during train, total 4383
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.003775160823118849, unsupervised loss ratio: 1.0, lr 0.021, 460 pseu out of 2991 are correct, 0 correct by model, 0 correct by ema before train, 1037 by model during train, total 4949
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.00359893011584602, unsupervised loss ratio: 1.0, lr 0.021, 67 pseu out of 1054 are correct, 0 correct by model, 0 correct by ema before train, 118 by model during train, total 1677
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.763089755359961 lr : 0.03
Comm round 92 meta round 5 chosen client: [6, 10, 8, 17, 19]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0030975657349884295, unsupervised loss ratio: 1.0, lr 0.021, 1234 pseu out of 2903 are correct, 0 correct by model, 0 correct by ema before train, 1441 by model during train, total 4383
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0032310569538445823, unsupervised loss ratio: 1.0, lr 0.021, 741 pseu out of 2265 are correct, 0 correct by model, 0 correct by ema before train, 1048 by model during train, total 3684
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0017969923255805043, unsupervised loss ratio: 1.0, lr 0.021, 2289 pseu out of 2984 are correct, 0 correct by model, 0 correct by ema before train, 2332 by model during train, total 4036
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002320451244454959, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4219 are correct, 0 correct by model, 0 correct by ema before train, 1108 by model during train, total 5558
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0037614382916870406, unsupervised loss ratio: 1.0, lr 0.021, 485 pseu out of 3011 are correct, 0 correct by model, 0 correct by ema before train, 1050 by model during train, total 4949
************ Loss Avg 0.028424733573834075, LR 0.03, Round 92 ends ************  

TEST Student: Epoch: 92

TEST AUROC: 0.767960, TEST Accus: 0.314267, TEST Pre: 0.249650, TEST Recall: 0.253413
Comm round 93 meta round 0 chosen client: [4, 8, 7, 18, 11]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0021898798720305047, unsupervised loss ratio: 1.0, lr 0.021, 740 pseu out of 2836 are correct, 0 correct by model, 0 correct by ema before train, 1032 by model during train, total 3987
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016127513122228265, unsupervised loss ratio: 1.0, lr 0.021, 2303 pseu out of 3002 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002786536619868667, unsupervised loss ratio: 1.0, lr 0.021, 522 pseu out of 2124 are correct, 0 correct by model, 0 correct by ema before train, 670 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0027348851597505724, unsupervised loss ratio: 1.0, lr 0.021, 549 pseu out of 1347 are correct, 0 correct by model, 0 correct by ema before train, 696 by model during train, total 2298
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002399120790869347, unsupervised loss ratio: 1.0, lr 0.021, 2001 pseu out of 2718 are correct, 0 correct by model, 0 correct by ema before train, 2211 by model during train, total 4088
Comm round 93 meta round 1 chosen client: [4, 19, 17, 12, 3]
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002299976144318602, unsupervised loss ratio: 1.0, lr 0.021, 738 pseu out of 2792 are correct, 0 correct by model, 0 correct by ema before train, 1041 by model during train, total 3987
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0034377765610443954, unsupervised loss ratio: 1.0, lr 0.021, 477 pseu out of 2999 are correct, 0 correct by model, 0 correct by ema before train, 1051 by model during train, total 4949
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0019203219750103936, unsupervised loss ratio: 1.0, lr 0.021, 1055 pseu out of 4244 are correct, 0 correct by model, 0 correct by ema before train, 1109 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0027424678827325504, unsupervised loss ratio: 1.0, lr 0.021, 129 pseu out of 4123 are correct, 0 correct by model, 0 correct by ema before train, 454 by model during train, total 5750
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003603193708970918, unsupervised loss ratio: 1.0, lr 0.021, 197 pseu out of 1895 are correct, 0 correct by model, 0 correct by ema before train, 423 by model during train, total 3526
Comm round 93 meta round 2 chosen client: [10, 16, 1, 12, 8]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027323397185557105, unsupervised loss ratio: 1.0, lr 0.021, 752 pseu out of 2351 are correct, 0 correct by model, 0 correct by ema before train, 1065 by model during train, total 3684
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0032841911077590995, unsupervised loss ratio: 1.0, lr 0.021, 535 pseu out of 2163 are correct, 0 correct by model, 0 correct by ema before train, 742 by model during train, total 3883
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002842233303321026, unsupervised loss ratio: 1.0, lr 0.021, 718 pseu out of 1713 are correct, 0 correct by model, 0 correct by ema before train, 935 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0026382276749548814, unsupervised loss ratio: 1.0, lr 0.021, 112 pseu out of 4124 are correct, 0 correct by model, 0 correct by ema before train, 465 by model during train, total 5750
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016317416227522585, unsupervised loss ratio: 1.0, lr 0.021, 2290 pseu out of 3007 are correct, 0 correct by model, 0 correct by ema before train, 2336 by model during train, total 4036
Comm round 93 meta round 3 chosen client: [14, 17, 8, 4, 19]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002280821946139137, unsupervised loss ratio: 1.0, lr 0.021, 25 pseu out of 1395 are correct, 0 correct by model, 0 correct by ema before train, 91 by model during train, total 2083
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0020111044648039185, unsupervised loss ratio: 1.0, lr 0.021, 1058 pseu out of 4242 are correct, 0 correct by model, 0 correct by ema before train, 1103 by model during train, total 5558
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015496492587772082, unsupervised loss ratio: 1.0, lr 0.021, 2304 pseu out of 3035 are correct, 0 correct by model, 0 correct by ema before train, 2337 by model during train, total 4036
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0023766260377929677, unsupervised loss ratio: 1.0, lr 0.021, 740 pseu out of 2826 are correct, 0 correct by model, 0 correct by ema before train, 1015 by model during train, total 3987
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.00321039754169014, unsupervised loss ratio: 1.0, lr 0.021, 512 pseu out of 3000 are correct, 0 correct by model, 0 correct by ema before train, 1129 by model during train, total 4949
Comm round 93 meta round 4 chosen client: [5, 6, 18, 12, 2]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0027738869873440413, unsupervised loss ratio: 1.0, lr 0.021, 297 pseu out of 2508 are correct, 0 correct by model, 0 correct by ema before train, 369 by model during train, total 3866
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0026518037083788195, unsupervised loss ratio: 1.0, lr 0.021, 1241 pseu out of 2950 are correct, 0 correct by model, 0 correct by ema before train, 1450 by model during train, total 4383
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002793080807249579, unsupervised loss ratio: 1.0, lr 0.021, 558 pseu out of 1356 are correct, 0 correct by model, 0 correct by ema before train, 694 by model during train, total 2298
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002685872585667918, unsupervised loss ratio: 1.0, lr 0.021, 135 pseu out of 4170 are correct, 0 correct by model, 0 correct by ema before train, 477 by model during train, total 5750
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002767686782005642, unsupervised loss ratio: 1.0, lr 0.021, 410 pseu out of 1707 are correct, 0 correct by model, 0 correct by ema before train, 667 by model during train, total 2665
Comm round 93 meta round 5 chosen client: [12, 17, 7, 13, 0]
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002677856035815138, unsupervised loss ratio: 1.0, lr 0.021, 142 pseu out of 4182 are correct, 0 correct by model, 0 correct by ema before train, 457 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0019959475250978923, unsupervised loss ratio: 1.0, lr 0.021, 1066 pseu out of 4239 are correct, 0 correct by model, 0 correct by ema before train, 1099 by model during train, total 5558
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.00281396972255047, unsupervised loss ratio: 1.0, lr 0.021, 512 pseu out of 2126 are correct, 0 correct by model, 0 correct by ema before train, 662 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004902750386124461, unsupervised loss ratio: 1.0, lr 0.021, 2156 pseu out of 3579 are correct, 0 correct by model, 0 correct by ema before train, 2188 by model during train, total 3739
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7746320008015146 lr : 0.03
************ Loss Avg 0.02821888742325339, LR 0.03, Round 93 ends ************  

TEST Student: Epoch: 93

TEST AUROC: 0.765097, TEST Accus: 0.309043, TEST Pre: 0.257310, TEST Recall: 0.245777
Comm round 94 meta round 0 chosen client: [2, 3, 5, 9, 10]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0027056525744098637, unsupervised loss ratio: 1.0, lr 0.021, 408 pseu out of 1716 are correct, 0 correct by model, 0 correct by ema before train, 647 by model during train, total 2665
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.003438153303120219, unsupervised loss ratio: 1.0, lr 0.021, 201 pseu out of 1918 are correct, 0 correct by model, 0 correct by ema before train, 420 by model during train, total 3526
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002601000011829873, unsupervised loss ratio: 1.0, lr 0.021, 300 pseu out of 2487 are correct, 0 correct by model, 0 correct by ema before train, 370 by model during train, total 3866
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0023978063782797783, unsupervised loss ratio: 1.0, lr 0.021, 69 pseu out of 1084 are correct, 0 correct by model, 0 correct by ema before train, 126 by model during train, total 1677
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027857064128981837, unsupervised loss ratio: 1.0, lr 0.021, 751 pseu out of 2314 are correct, 0 correct by model, 0 correct by ema before train, 1055 by model during train, total 3684
Comm round 94 meta round 1 chosen client: [2, 7, 8, 11, 10]
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002667684593082716, unsupervised loss ratio: 1.0, lr 0.021, 432 pseu out of 1734 are correct, 0 correct by model, 0 correct by ema before train, 669 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0025896714012980317, unsupervised loss ratio: 1.0, lr 0.021, 522 pseu out of 2135 are correct, 0 correct by model, 0 correct by ema before train, 675 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015627219464704467, unsupervised loss ratio: 1.0, lr 0.021, 2288 pseu out of 3014 are correct, 0 correct by model, 0 correct by ema before train, 2329 by model during train, total 4036
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0023759591167618055, unsupervised loss ratio: 1.0, lr 0.021, 2009 pseu out of 2739 are correct, 0 correct by model, 0 correct by ema before train, 2197 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027410949455927416, unsupervised loss ratio: 1.0, lr 0.021, 773 pseu out of 2359 are correct, 0 correct by model, 0 correct by ema before train, 1070 by model during train, total 3684
Comm round 94 meta round 2 chosen client: [14, 10, 17, 12, 15]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0021941471178169277, unsupervised loss ratio: 1.0, lr 0.021, 24 pseu out of 1360 are correct, 0 correct by model, 0 correct by ema before train, 105 by model during train, total 2083
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0028346913429137706, unsupervised loss ratio: 1.0, lr 0.021, 759 pseu out of 2367 are correct, 0 correct by model, 0 correct by ema before train, 1059 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0019747835835548996, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4268 are correct, 0 correct by model, 0 correct by ema before train, 1103 by model during train, total 5558
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002578497348844798, unsupervised loss ratio: 1.0, lr 0.021, 152 pseu out of 4200 are correct, 0 correct by model, 0 correct by ema before train, 480 by model during train, total 5750
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00267545878619925, unsupervised loss ratio: 1.0, lr 0.021, 47 pseu out of 2696 are correct, 0 correct by model, 0 correct by ema before train, 302 by model during train, total 4099
Comm round 94 meta round 3 chosen client: [6, 18, 8, 1, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002568790367703237, unsupervised loss ratio: 1.0, lr 0.021, 1240 pseu out of 2834 are correct, 0 correct by model, 0 correct by ema before train, 1430 by model during train, total 4383
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0025788256963197556, unsupervised loss ratio: 1.0, lr 0.021, 554 pseu out of 1347 are correct, 0 correct by model, 0 correct by ema before train, 688 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0016465947966253225, unsupervised loss ratio: 1.0, lr 0.021, 2297 pseu out of 3054 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.00270857572805409, unsupervised loss ratio: 1.0, lr 0.021, 719 pseu out of 1694 are correct, 0 correct by model, 0 correct by ema before train, 936 by model during train, total 2621
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0022333654656355815, unsupervised loss ratio: 1.0, lr 0.021, 745 pseu out of 2829 are correct, 0 correct by model, 0 correct by ema before train, 1034 by model during train, total 3987
Comm round 94 meta round 4 chosen client: [14, 13, 4, 9, 18]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0022353211269629273, unsupervised loss ratio: 1.0, lr 0.021, 23 pseu out of 1388 are correct, 0 correct by model, 0 correct by ema before train, 96 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004398114552575369, unsupervised loss ratio: 1.0, lr 0.021, 2151 pseu out of 3576 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0022843205674906216, unsupervised loss ratio: 1.0, lr 0.021, 734 pseu out of 2791 are correct, 0 correct by model, 0 correct by ema before train, 1008 by model during train, total 3987
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0023751220497716633, unsupervised loss ratio: 1.0, lr 0.021, 74 pseu out of 1075 are correct, 0 correct by model, 0 correct by ema before train, 122 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0026357016985356393, unsupervised loss ratio: 1.0, lr 0.021, 560 pseu out of 1356 are correct, 0 correct by model, 0 correct by ema before train, 699 by model during train, total 2298
Comm round 94 meta round 5 chosen client: [7, 5, 13, 15, 4]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002769268621565201, unsupervised loss ratio: 1.0, lr 0.021, 527 pseu out of 2161 are correct, 0 correct by model, 0 correct by ema before train, 676 by model during train, total 3280
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0026704440891483156, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2485 are correct, 0 correct by model, 0 correct by ema before train, 379 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004868789837928489, unsupervised loss ratio: 1.0, lr 0.021, 2146 pseu out of 3588 are correct, 0 correct by model, 0 correct by ema before train, 2176 by model during train, total 3739
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0026203190768753232, unsupervised loss ratio: 1.0, lr 0.021, 49 pseu out of 2667 are correct, 0 correct by model, 0 correct by ema before train, 313 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002292823602652384, unsupervised loss ratio: 1.0, lr 0.021, 744 pseu out of 2871 are correct, 0 correct by model, 0 correct by ema before train, 1042 by model during train, total 3987
************ Loss Avg 0.002355639739648792, LR 0.03, Round 94 ends ************  

TEST Student: Epoch: 94

TEST AUROC: 0.750334, TEST Accus: 0.284266, TEST Pre: 0.254109, TEST Recall: 0.212302
Comm round 95 meta round 0 chosen client: [3, 1, 12, 16, 10]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0030693872335437584, unsupervised loss ratio: 1.0, lr 0.021, 217 pseu out of 1948 are correct, 0 correct by model, 0 correct by ema before train, 416 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.002342599631491594, unsupervised loss ratio: 1.0, lr 0.021, 705 pseu out of 1655 are correct, 0 correct by model, 0 correct by ema before train, 941 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002264793499165939, unsupervised loss ratio: 1.0, lr 0.021, 143 pseu out of 4218 are correct, 0 correct by model, 0 correct by ema before train, 479 by model during train, total 5750
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.0030574555619482377, unsupervised loss ratio: 1.0, lr 0.021, 545 pseu out of 2174 are correct, 0 correct by model, 0 correct by ema before train, 747 by model during train, total 3883
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002588638668510549, unsupervised loss ratio: 1.0, lr 0.021, 776 pseu out of 2362 are correct, 0 correct by model, 0 correct by ema before train, 1054 by model during train, total 3684
Comm round 95 meta round 1 chosen client: [18, 8, 10, 5, 15]
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002294347459812545, unsupervised loss ratio: 1.0, lr 0.021, 555 pseu out of 1375 are correct, 0 correct by model, 0 correct by ema before train, 713 by model during train, total 2298
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015205918754190861, unsupervised loss ratio: 1.0, lr 0.021, 2296 pseu out of 3054 are correct, 0 correct by model, 0 correct by ema before train, 2333 by model during train, total 4036
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0026842302397889054, unsupervised loss ratio: 1.0, lr 0.021, 764 pseu out of 2402 are correct, 0 correct by model, 0 correct by ema before train, 1073 by model during train, total 3684
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002348951542116396, unsupervised loss ratio: 1.0, lr 0.021, 295 pseu out of 2467 are correct, 0 correct by model, 0 correct by ema before train, 383 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002465610418697067, unsupervised loss ratio: 1.0, lr 0.021, 45 pseu out of 2659 are correct, 0 correct by model, 0 correct by ema before train, 309 by model during train, total 4099
Comm round 95 meta round 2 chosen client: [5, 8, 19, 12, 4]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0022633903899390373, unsupervised loss ratio: 1.0, lr 0.021, 303 pseu out of 2593 are correct, 0 correct by model, 0 correct by ema before train, 377 by model during train, total 3866
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015111362087054658, unsupervised loss ratio: 1.0, lr 0.021, 2295 pseu out of 3075 are correct, 0 correct by model, 0 correct by ema before train, 2334 by model during train, total 4036
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.002858024150228653, unsupervised loss ratio: 1.0, lr 0.021, 526 pseu out of 3054 are correct, 0 correct by model, 0 correct by ema before train, 1060 by model during train, total 4949
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0020815141266211866, unsupervised loss ratio: 1.0, lr 0.021, 161 pseu out of 4315 are correct, 0 correct by model, 0 correct by ema before train, 463 by model during train, total 5750
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020133994869880436, unsupervised loss ratio: 1.0, lr 0.021, 751 pseu out of 2896 are correct, 0 correct by model, 0 correct by ema before train, 1039 by model during train, total 3987
Comm round 95 meta round 3 chosen client: [0, 15, 12, 7, 13]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8144613492245577 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0023775733193850523, unsupervised loss ratio: 1.0, lr 0.021, 42 pseu out of 2725 are correct, 0 correct by model, 0 correct by ema before train, 308 by model during train, total 4099
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0021176960015307283, unsupervised loss ratio: 1.0, lr 0.021, 152 pseu out of 4337 are correct, 0 correct by model, 0 correct by ema before train, 470 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002311506679129357, unsupervised loss ratio: 1.0, lr 0.021, 526 pseu out of 2148 are correct, 0 correct by model, 0 correct by ema before train, 675 by model during train, total 3280
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003412668158520226, unsupervised loss ratio: 1.0, lr 0.021, 2153 pseu out of 3593 are correct, 0 correct by model, 0 correct by ema before train, 2184 by model during train, total 3739
Comm round 95 meta round 4 chosen client: [14, 12, 5, 16, 4]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0017353851281134694, unsupervised loss ratio: 1.0, lr 0.021, 25 pseu out of 1390 are correct, 0 correct by model, 0 correct by ema before train, 100 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002125844365865406, unsupervised loss ratio: 1.0, lr 0.021, 158 pseu out of 4360 are correct, 0 correct by model, 0 correct by ema before train, 456 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0022981502053701914, unsupervised loss ratio: 1.0, lr 0.021, 305 pseu out of 2626 are correct, 0 correct by model, 0 correct by ema before train, 376 by model during train, total 3866
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.002935250576005363, unsupervised loss ratio: 1.0, lr 0.021, 553 pseu out of 2205 are correct, 0 correct by model, 0 correct by ema before train, 762 by model during train, total 3883
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020919348249980618, unsupervised loss ratio: 1.0, lr 0.021, 744 pseu out of 2862 are correct, 0 correct by model, 0 correct by ema before train, 1020 by model during train, total 3987
Comm round 95 meta round 5 chosen client: [15, 4, 14, 9, 19]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002383317942859811, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 2721 are correct, 0 correct by model, 0 correct by ema before train, 320 by model during train, total 4099
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020474900606103122, unsupervised loss ratio: 1.0, lr 0.021, 746 pseu out of 2886 are correct, 0 correct by model, 0 correct by ema before train, 1049 by model during train, total 3987
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001734119633593681, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 1423 are correct, 0 correct by model, 0 correct by ema before train, 100 by model during train, total 2083
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018630040080838458, unsupervised loss ratio: 1.0, lr 0.021, 78 pseu out of 1075 are correct, 0 correct by model, 0 correct by ema before train, 131 by model during train, total 1677
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0030502357955974266, unsupervised loss ratio: 1.0, lr 0.021, 505 pseu out of 3109 are correct, 0 correct by model, 0 correct by ema before train, 1087 by model during train, total 4949
************ Loss Avg 0.029307939835817632, LR 0.03, Round 95 ends ************  

TEST Student: Epoch: 95

TEST AUROC: 0.760684, TEST Accus: 0.297480, TEST Pre: 0.255717, TEST Recall: 0.228940
Comm round 96 meta round 0 chosen client: [14, 7, 8, 13, 16]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.001810914081888217, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 1429 are correct, 0 correct by model, 0 correct by ema before train, 107 by model during train, total 2083
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002482534326890555, unsupervised loss ratio: 1.0, lr 0.021, 524 pseu out of 2183 are correct, 0 correct by model, 0 correct by ema before train, 685 by model during train, total 3280
Unlabeled client 8 begin unsupervised training
Unlabeled client 8 sample num: 4036 Training loss: 0.0015352402617736516, unsupervised loss ratio: 1.0, lr 0.021, 2298 pseu out of 3081 are correct, 0 correct by model, 0 correct by ema before train, 2338 by model during train, total 4036
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0003959588402876299, unsupervised loss ratio: 1.0, lr 0.021, 2160 pseu out of 3595 are correct, 0 correct by model, 0 correct by ema before train, 2188 by model during train, total 3739
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003107553015875279, unsupervised loss ratio: 1.0, lr 0.021, 552 pseu out of 2228 are correct, 0 correct by model, 0 correct by ema before train, 747 by model during train, total 3883
Comm round 96 meta round 1 chosen client: [5, 15, 2, 4, 13]
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0023742783432979075, unsupervised loss ratio: 1.0, lr 0.021, 293 pseu out of 2557 are correct, 0 correct by model, 0 correct by ema before train, 379 by model during train, total 3866
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0024795824887965303, unsupervised loss ratio: 1.0, lr 0.021, 44 pseu out of 2772 are correct, 0 correct by model, 0 correct by ema before train, 286 by model during train, total 4099
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002580610625002356, unsupervised loss ratio: 1.0, lr 0.021, 414 pseu out of 1720 are correct, 0 correct by model, 0 correct by ema before train, 644 by model during train, total 2665
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002093829862710591, unsupervised loss ratio: 1.0, lr 0.021, 751 pseu out of 2936 are correct, 0 correct by model, 0 correct by ema before train, 1002 by model during train, total 3987
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0004256922260599637, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3585 are correct, 0 correct by model, 0 correct by ema before train, 2183 by model during train, total 3739
Comm round 96 meta round 2 chosen client: [0, 5, 19, 18, 13]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.8005194785643597 lr : 0.03
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0023675427378964473, unsupervised loss ratio: 1.0, lr 0.021, 301 pseu out of 2631 are correct, 0 correct by model, 0 correct by ema before train, 364 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0031254529596294444, unsupervised loss ratio: 1.0, lr 0.021, 500 pseu out of 3076 are correct, 0 correct by model, 0 correct by ema before train, 1066 by model during train, total 4949
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002636293421447691, unsupervised loss ratio: 1.0, lr 0.021, 549 pseu out of 1388 are correct, 0 correct by model, 0 correct by ema before train, 697 by model during train, total 2298
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00036479331877564035, unsupervised loss ratio: 1.0, lr 0.021, 2158 pseu out of 3600 are correct, 0 correct by model, 0 correct by ema before train, 2188 by model during train, total 3739
Comm round 96 meta round 3 chosen client: [15, 10, 0, 17, 9]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0024463646414985235, unsupervised loss ratio: 1.0, lr 0.021, 49 pseu out of 2787 are correct, 0 correct by model, 0 correct by ema before train, 306 by model during train, total 4099
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0027521015445958696, unsupervised loss ratio: 1.0, lr 0.021, 772 pseu out of 2406 are correct, 0 correct by model, 0 correct by ema before train, 1081 by model during train, total 3684
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7464392014912197 lr : 0.03
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017758632371812288, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4320 are correct, 0 correct by model, 0 correct by ema before train, 1111 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.001994810897115342, unsupervised loss ratio: 1.0, lr 0.021, 70 pseu out of 1083 are correct, 0 correct by model, 0 correct by ema before train, 128 by model during train, total 1677
Comm round 96 meta round 4 chosen client: [11, 10, 17, 4, 1]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.00219772484524583, unsupervised loss ratio: 1.0, lr 0.021, 2024 pseu out of 2765 are correct, 0 correct by model, 0 correct by ema before train, 2206 by model during train, total 4088
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.002667413986336183, unsupervised loss ratio: 1.0, lr 0.021, 767 pseu out of 2400 are correct, 0 correct by model, 0 correct by ema before train, 1053 by model during train, total 3684
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0017388681452935454, unsupervised loss ratio: 1.0, lr 0.021, 1064 pseu out of 4333 are correct, 0 correct by model, 0 correct by ema before train, 1111 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002045670353312282, unsupervised loss ratio: 1.0, lr 0.021, 748 pseu out of 2915 are correct, 0 correct by model, 0 correct by ema before train, 1039 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0024151216635889395, unsupervised loss ratio: 1.0, lr 0.021, 711 pseu out of 1686 are correct, 0 correct by model, 0 correct by ema before train, 948 by model during train, total 2621
Comm round 96 meta round 5 chosen client: [1, 9, 7, 11, 15]
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0025131456616402765, unsupervised loss ratio: 1.0, lr 0.021, 715 pseu out of 1706 are correct, 0 correct by model, 0 correct by ema before train, 941 by model during train, total 2621
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0021450393523318105, unsupervised loss ratio: 1.0, lr 0.021, 71 pseu out of 1084 are correct, 0 correct by model, 0 correct by ema before train, 128 by model during train, total 1677
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0023812845734377894, unsupervised loss ratio: 1.0, lr 0.021, 530 pseu out of 2202 are correct, 0 correct by model, 0 correct by ema before train, 667 by model during train, total 3280
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0021880485674046213, unsupervised loss ratio: 1.0, lr 0.021, 2021 pseu out of 2766 are correct, 0 correct by model, 0 correct by ema before train, 2216 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0025354274009049944, unsupervised loss ratio: 1.0, lr 0.021, 58 pseu out of 2814 are correct, 0 correct by model, 0 correct by ema before train, 308 by model during train, total 4099
************ Loss Avg 0.053551194714526615, LR 0.03, Round 96 ends ************  

TEST Student: Epoch: 96

TEST AUROC: 0.784562, TEST Accus: 0.343347, TEST Pre: 0.311734, TEST Recall: 0.286409
Comm round 97 meta round 0 chosen client: [16, 4, 15, 13, 3]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003921687629715097, unsupervised loss ratio: 1.0, lr 0.021, 553 pseu out of 2219 are correct, 0 correct by model, 0 correct by ema before train, 762 by model during train, total 3883
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028269171815491208, unsupervised loss ratio: 1.0, lr 0.021, 748 pseu out of 2911 are correct, 0 correct by model, 0 correct by ema before train, 1009 by model during train, total 3987
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003356896830910745, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 2786 are correct, 0 correct by model, 0 correct by ema before train, 289 by model during train, total 4099
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0008179977278706571, unsupervised loss ratio: 1.0, lr 0.021, 2161 pseu out of 3593 are correct, 0 correct by model, 0 correct by ema before train, 2186 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0042572291443190935, unsupervised loss ratio: 1.0, lr 0.021, 220 pseu out of 1945 are correct, 0 correct by model, 0 correct by ema before train, 455 by model during train, total 3526
Comm round 97 meta round 1 chosen client: [11, 1, 14, 17, 4]
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0026249387356074294, unsupervised loss ratio: 1.0, lr 0.021, 2026 pseu out of 2768 are correct, 0 correct by model, 0 correct by ema before train, 2214 by model during train, total 4088
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0034321804371912307, unsupervised loss ratio: 1.0, lr 0.021, 722 pseu out of 1688 are correct, 0 correct by model, 0 correct by ema before train, 935 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0034134581007740712, unsupervised loss ratio: 1.0, lr 0.021, 33 pseu out of 1459 are correct, 0 correct by model, 0 correct by ema before train, 108 by model during train, total 2083
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0025059596472152175, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4279 are correct, 0 correct by model, 0 correct by ema before train, 1103 by model during train, total 5558
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028748226297524064, unsupervised loss ratio: 1.0, lr 0.021, 748 pseu out of 2895 are correct, 0 correct by model, 0 correct by ema before train, 1056 by model during train, total 3987
Comm round 97 meta round 2 chosen client: [19, 4, 5, 17, 9]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0037411440302653667, unsupervised loss ratio: 1.0, lr 0.021, 521 pseu out of 3055 are correct, 0 correct by model, 0 correct by ema before train, 1100 by model during train, total 4949
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0028954208070885333, unsupervised loss ratio: 1.0, lr 0.021, 746 pseu out of 2879 are correct, 0 correct by model, 0 correct by ema before train, 1039 by model during train, total 3987
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0034816519864911185, unsupervised loss ratio: 1.0, lr 0.021, 299 pseu out of 2583 are correct, 0 correct by model, 0 correct by ema before train, 384 by model during train, total 3866
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002513211979209606, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4268 are correct, 0 correct by model, 0 correct by ema before train, 1114 by model during train, total 5558
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.003641434056960322, unsupervised loss ratio: 1.0, lr 0.021, 81 pseu out of 1109 are correct, 0 correct by model, 0 correct by ema before train, 141 by model during train, total 1677
Comm round 97 meta round 3 chosen client: [16, 9, 18, 2, 7]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003912219930379117, unsupervised loss ratio: 1.0, lr 0.021, 552 pseu out of 2188 are correct, 0 correct by model, 0 correct by ema before train, 764 by model during train, total 3883
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0033687507632378213, unsupervised loss ratio: 1.0, lr 0.021, 79 pseu out of 1083 are correct, 0 correct by model, 0 correct by ema before train, 141 by model during train, total 1677
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.003628797162996812, unsupervised loss ratio: 1.0, lr 0.021, 562 pseu out of 1377 are correct, 0 correct by model, 0 correct by ema before train, 698 by model during train, total 2298
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.0031961766875437682, unsupervised loss ratio: 1.0, lr 0.021, 414 pseu out of 1710 are correct, 0 correct by model, 0 correct by ema before train, 684 by model during train, total 2665
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0036873788048978895, unsupervised loss ratio: 1.0, lr 0.021, 525 pseu out of 2183 are correct, 0 correct by model, 0 correct by ema before train, 681 by model during train, total 3280
Comm round 97 meta round 4 chosen client: [15, 3, 18, 17, 14]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003422814161771944, unsupervised loss ratio: 1.0, lr 0.021, 52 pseu out of 2788 are correct, 0 correct by model, 0 correct by ema before train, 299 by model during train, total 4099
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004205267804666489, unsupervised loss ratio: 1.0, lr 0.021, 209 pseu out of 1913 are correct, 0 correct by model, 0 correct by ema before train, 419 by model during train, total 3526
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.0035935475413377085, unsupervised loss ratio: 1.0, lr 0.021, 559 pseu out of 1376 are correct, 0 correct by model, 0 correct by ema before train, 717 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002508356472766348, unsupervised loss ratio: 1.0, lr 0.021, 1063 pseu out of 4278 are correct, 0 correct by model, 0 correct by ema before train, 1118 by model during train, total 5558
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.003164508803324266, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 1425 are correct, 0 correct by model, 0 correct by ema before train, 111 by model during train, total 2083
Comm round 97 meta round 5 chosen client: [14, 4, 1, 12, 7]
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.003288030158728361, unsupervised loss ratio: 1.0, lr 0.021, 27 pseu out of 1410 are correct, 0 correct by model, 0 correct by ema before train, 107 by model during train, total 2083
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.002776533864172442, unsupervised loss ratio: 1.0, lr 0.021, 756 pseu out of 2874 are correct, 0 correct by model, 0 correct by ema before train, 1037 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.003307404252132628, unsupervised loss ratio: 1.0, lr 0.021, 719 pseu out of 1701 are correct, 0 correct by model, 0 correct by ema before train, 955 by model during train, total 2621
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0033610736498505705, unsupervised loss ratio: 1.0, lr 0.021, 144 pseu out of 4326 are correct, 0 correct by model, 0 correct by ema before train, 453 by model during train, total 5750
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.003502678567131695, unsupervised loss ratio: 1.0, lr 0.021, 531 pseu out of 2186 are correct, 0 correct by model, 0 correct by ema before train, 693 by model during train, total 3280
************ Loss Avg 0.0032409496516619288, LR 0.03, Round 97 ends ************  

TEST Student: Epoch: 97

TEST AUROC: 0.756819, TEST Accus: 0.290834, TEST Pre: 0.256176, TEST Recall: 0.219535
Comm round 98 meta round 0 chosen client: [7, 18, 5, 13, 14]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002460048572034933, unsupervised loss ratio: 1.0, lr 0.021, 539 pseu out of 2141 are correct, 0 correct by model, 0 correct by ema before train, 694 by model during train, total 3280
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.002332445217891493, unsupervised loss ratio: 1.0, lr 0.021, 557 pseu out of 1337 are correct, 0 correct by model, 0 correct by ema before train, 709 by model during train, total 2298
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002289469924480578, unsupervised loss ratio: 1.0, lr 0.021, 296 pseu out of 2598 are correct, 0 correct by model, 0 correct by ema before train, 372 by model during train, total 3866
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.00034212494371123456, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3598 are correct, 0 correct by model, 0 correct by ema before train, 2189 by model during train, total 3739
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0017624645684422417, unsupervised loss ratio: 1.0, lr 0.021, 28 pseu out of 1405 are correct, 0 correct by model, 0 correct by ema before train, 112 by model during train, total 2083
Comm round 98 meta round 1 chosen client: [9, 14, 7, 4, 1]
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.0018294219259621092, unsupervised loss ratio: 1.0, lr 0.021, 84 pseu out of 1097 are correct, 0 correct by model, 0 correct by ema before train, 142 by model during train, total 1677
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0017815677794825399, unsupervised loss ratio: 1.0, lr 0.021, 32 pseu out of 1437 are correct, 0 correct by model, 0 correct by ema before train, 112 by model during train, total 2083
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.002362789656707229, unsupervised loss ratio: 1.0, lr 0.021, 543 pseu out of 2207 are correct, 0 correct by model, 0 correct by ema before train, 681 by model during train, total 3280
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020774421420702268, unsupervised loss ratio: 1.0, lr 0.021, 771 pseu out of 2884 are correct, 0 correct by model, 0 correct by ema before train, 1049 by model during train, total 3987
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.0023819145848747434, unsupervised loss ratio: 1.0, lr 0.021, 722 pseu out of 1697 are correct, 0 correct by model, 0 correct by ema before train, 941 by model during train, total 2621
Comm round 98 meta round 2 chosen client: [0, 6, 12, 5, 19]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.749056796638333 lr : 0.03
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.002228149095637913, unsupervised loss ratio: 1.0, lr 0.021, 1238 pseu out of 2896 are correct, 0 correct by model, 0 correct by ema before train, 1415 by model during train, total 4383
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0022972820818217264, unsupervised loss ratio: 1.0, lr 0.021, 148 pseu out of 4347 are correct, 0 correct by model, 0 correct by ema before train, 475 by model during train, total 5750
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0022530370195335174, unsupervised loss ratio: 1.0, lr 0.021, 300 pseu out of 2585 are correct, 0 correct by model, 0 correct by ema before train, 372 by model during train, total 3866
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0029185936981752417, unsupervised loss ratio: 1.0, lr 0.021, 523 pseu out of 3107 are correct, 0 correct by model, 0 correct by ema before train, 1122 by model during train, total 4949
Comm round 98 meta round 3 chosen client: [6, 5, 14, 0, 4]
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0023371025757945104, unsupervised loss ratio: 1.0, lr 0.021, 1240 pseu out of 2909 are correct, 0 correct by model, 0 correct by ema before train, 1437 by model during train, total 4383
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0022790958784276345, unsupervised loss ratio: 1.0, lr 0.021, 304 pseu out of 2609 are correct, 0 correct by model, 0 correct by ema before train, 378 by model during train, total 3866
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.002007547136269171, unsupervised loss ratio: 1.0, lr 0.021, 35 pseu out of 1437 are correct, 0 correct by model, 0 correct by ema before train, 104 by model during train, total 2083
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.812512643179115 lr : 0.03
Unlabeled client 4 begin unsupervised training
Unlabeled client 4 sample num: 3987 Training loss: 0.0020858203485933325, unsupervised loss ratio: 1.0, lr 0.021, 760 pseu out of 2877 are correct, 0 correct by model, 0 correct by ema before train, 1040 by model during train, total 3987
Comm round 98 meta round 4 chosen client: [15, 5, 12, 17, 2]
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.002416027410967777, unsupervised loss ratio: 1.0, lr 0.021, 54 pseu out of 2798 are correct, 0 correct by model, 0 correct by ema before train, 325 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.002257548688651353, unsupervised loss ratio: 1.0, lr 0.021, 301 pseu out of 2599 are correct, 0 correct by model, 0 correct by ema before train, 381 by model during train, total 3866
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.002291306513102932, unsupervised loss ratio: 1.0, lr 0.021, 153 pseu out of 4322 are correct, 0 correct by model, 0 correct by ema before train, 464 by model during train, total 5750
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.0016963771696941092, unsupervised loss ratio: 1.0, lr 0.021, 1060 pseu out of 4304 are correct, 0 correct by model, 0 correct by ema before train, 1113 by model during train, total 5558
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.002360549456040774, unsupervised loss ratio: 1.0, lr 0.021, 409 pseu out of 1709 are correct, 0 correct by model, 0 correct by ema before train, 651 by model during train, total 2665
Comm round 98 meta round 5 chosen client: [19, 16, 0, 14, 12]
Unlabeled client 19 begin unsupervised training
Unlabeled client 19 sample num: 4949 Training loss: 0.0029496179120495724, unsupervised loss ratio: 1.0, lr 0.021, 533 pseu out of 3111 are correct, 0 correct by model, 0 correct by ema before train, 1071 by model during train, total 4949
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.003029863804303965, unsupervised loss ratio: 1.0, lr 0.021, 558 pseu out of 2212 are correct, 0 correct by model, 0 correct by ema before train, 758 by model during train, total 3883
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7795511180040787 lr : 0.03
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.0018467341521472642, unsupervised loss ratio: 1.0, lr 0.021, 32 pseu out of 1463 are correct, 0 correct by model, 0 correct by ema before train, 103 by model during train, total 2083
Unlabeled client 12 begin unsupervised training
Unlabeled client 12 sample num: 5750 Training loss: 0.0021689795177533395, unsupervised loss ratio: 1.0, lr 0.021, 155 pseu out of 4402 are correct, 0 correct by model, 0 correct by ema before train, 452 by model during train, total 5750
************ Loss Avg 0.08000546265320493, LR 0.03, Round 98 ends ************  

TEST Student: Epoch: 98

TEST AUROC: 0.797453, TEST Accus: 0.361670, TEST Pre: 0.389250, TEST Recall: 0.312577
Comm round 99 meta round 0 chosen client: [10, 6, 2, 11, 15]
Unlabeled client 10 begin unsupervised training
Unlabeled client 10 sample num: 3684 Training loss: 0.0037282742319050535, unsupervised loss ratio: 1.0, lr 0.021, 761 pseu out of 2400 are correct, 0 correct by model, 0 correct by ema before train, 1064 by model during train, total 3684
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.003990899157318948, unsupervised loss ratio: 1.0, lr 0.021, 1239 pseu out of 2909 are correct, 0 correct by model, 0 correct by ema before train, 1457 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003973417014570995, unsupervised loss ratio: 1.0, lr 0.021, 427 pseu out of 1743 are correct, 0 correct by model, 0 correct by ema before train, 681 by model during train, total 2665
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.0030524930898536695, unsupervised loss ratio: 1.0, lr 0.021, 2011 pseu out of 2743 are correct, 0 correct by model, 0 correct by ema before train, 2208 by model during train, total 4088
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003968100923912761, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 2769 are correct, 0 correct by model, 0 correct by ema before train, 323 by model during train, total 4099
Comm round 99 meta round 1 chosen client: [3, 15, 5, 18, 17]
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.0049744522093533305, unsupervised loss ratio: 1.0, lr 0.021, 210 pseu out of 1928 are correct, 0 correct by model, 0 correct by ema before train, 451 by model during train, total 3526
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.003783953045673955, unsupervised loss ratio: 1.0, lr 0.021, 55 pseu out of 2750 are correct, 0 correct by model, 0 correct by ema before train, 323 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.0045464910646961605, unsupervised loss ratio: 1.0, lr 0.021, 300 pseu out of 2636 are correct, 0 correct by model, 0 correct by ema before train, 381 by model during train, total 3866
Unlabeled client 18 begin unsupervised training
Unlabeled client 18 sample num: 2298 Training loss: 0.004215219232719392, unsupervised loss ratio: 1.0, lr 0.021, 555 pseu out of 1347 are correct, 0 correct by model, 0 correct by ema before train, 721 by model during train, total 2298
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.003077661747048641, unsupervised loss ratio: 1.0, lr 0.021, 1061 pseu out of 4295 are correct, 0 correct by model, 0 correct by ema before train, 1118 by model during train, total 5558
Comm round 99 meta round 2 chosen client: [7, 6, 2, 14, 13]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.0046582689963263245, unsupervised loss ratio: 1.0, lr 0.021, 541 pseu out of 2165 are correct, 0 correct by model, 0 correct by ema before train, 702 by model during train, total 3280
Unlabeled client 6 begin unsupervised training
Unlabeled client 6 sample num: 4383 Training loss: 0.0038086807370469296, unsupervised loss ratio: 1.0, lr 0.021, 1245 pseu out of 2894 are correct, 0 correct by model, 0 correct by ema before train, 1444 by model during train, total 4383
Unlabeled client 2 begin unsupervised training
Unlabeled client 2 sample num: 2665 Training loss: 0.003735892241820693, unsupervised loss ratio: 1.0, lr 0.021, 435 pseu out of 1728 are correct, 0 correct by model, 0 correct by ema before train, 650 by model during train, total 2665
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.004487367985403222, unsupervised loss ratio: 1.0, lr 0.021, 30 pseu out of 1428 are correct, 0 correct by model, 0 correct by ema before train, 102 by model during train, total 2083
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.0011018091054057102, unsupervised loss ratio: 1.0, lr 0.021, 2153 pseu out of 3573 are correct, 0 correct by model, 0 correct by ema before train, 2184 by model during train, total 3739
Comm round 99 meta round 3 chosen client: [16, 3, 1, 14, 15]
Unlabeled client 16 begin unsupervised training
Unlabeled client 16 sample num: 3883 Training loss: 0.004836744063946068, unsupervised loss ratio: 1.0, lr 0.021, 573 pseu out of 2211 are correct, 0 correct by model, 0 correct by ema before train, 762 by model during train, total 3883
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004790526451480608, unsupervised loss ratio: 1.0, lr 0.021, 234 pseu out of 1888 are correct, 0 correct by model, 0 correct by ema before train, 449 by model during train, total 3526
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.004277864056525797, unsupervised loss ratio: 1.0, lr 0.021, 719 pseu out of 1677 are correct, 0 correct by model, 0 correct by ema before train, 947 by model during train, total 2621
Unlabeled client 14 begin unsupervised training
Unlabeled client 14 sample num: 2083 Training loss: 0.004137680569494312, unsupervised loss ratio: 1.0, lr 0.021, 33 pseu out of 1424 are correct, 0 correct by model, 0 correct by ema before train, 106 by model during train, total 2083
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.00387794296760918, unsupervised loss ratio: 1.0, lr 0.021, 59 pseu out of 2731 are correct, 0 correct by model, 0 correct by ema before train, 340 by model during train, total 4099
Comm round 99 meta round 4 chosen client: [0, 15, 5, 17, 11]
Begin supervised training
Labeled client 0 sample num: 3085 training loss : 0.7187527752652461 lr : 0.03
Unlabeled client 15 begin unsupervised training
Unlabeled client 15 sample num: 4099 Training loss: 0.0038859607474688138, unsupervised loss ratio: 1.0, lr 0.021, 68 pseu out of 2696 are correct, 0 correct by model, 0 correct by ema before train, 348 by model during train, total 4099
Unlabeled client 5 begin unsupervised training
Unlabeled client 5 sample num: 3866 Training loss: 0.004222648680118508, unsupervised loss ratio: 1.0, lr 0.021, 299 pseu out of 2596 are correct, 0 correct by model, 0 correct by ema before train, 363 by model during train, total 3866
Unlabeled client 17 begin unsupervised training
Unlabeled client 17 sample num: 5558 Training loss: 0.002996571852434855, unsupervised loss ratio: 1.0, lr 0.021, 1057 pseu out of 4209 are correct, 0 correct by model, 0 correct by ema before train, 1118 by model during train, total 5558
Unlabeled client 11 begin unsupervised training
Unlabeled client 11 sample num: 4088 Training loss: 0.002983894026328926, unsupervised loss ratio: 1.0, lr 0.021, 2028 pseu out of 2752 are correct, 0 correct by model, 0 correct by ema before train, 2223 by model during train, total 4088
Comm round 99 meta round 5 chosen client: [7, 9, 1, 13, 3]
Unlabeled client 7 begin unsupervised training
Unlabeled client 7 sample num: 3280 Training loss: 0.004427367528058732, unsupervised loss ratio: 1.0, lr 0.021, 538 pseu out of 2135 are correct, 0 correct by model, 0 correct by ema before train, 703 by model during train, total 3280
Unlabeled client 9 begin unsupervised training
Unlabeled client 9 sample num: 1677 Training loss: 0.004887605676668938, unsupervised loss ratio: 1.0, lr 0.021, 79 pseu out of 1090 are correct, 0 correct by model, 0 correct by ema before train, 138 by model during train, total 1677
Unlabeled client 1 begin unsupervised training
Unlabeled client 1 sample num: 2621 Training loss: 0.004183651720423524, unsupervised loss ratio: 1.0, lr 0.021, 725 pseu out of 1700 are correct, 0 correct by model, 0 correct by ema before train, 961 by model during train, total 2621
Unlabeled client 13 begin unsupervised training
Unlabeled client 13 sample num: 3739 Training loss: 0.001001327640921572, unsupervised loss ratio: 1.0, lr 0.021, 2155 pseu out of 3576 are correct, 0 correct by model, 0 correct by ema before train, 2188 by model during train, total 3739
Unlabeled client 3 begin unsupervised training
Unlabeled client 3 sample num: 3526 Training loss: 0.004800516385460339, unsupervised loss ratio: 1.0, lr 0.021, 234 pseu out of 1844 are correct, 0 correct by model, 0 correct by ema before train, 455 by model during train, total 3526
************ Loss Avg 0.027705535280508065, LR 0.03, Round 99 ends ************  

TEST Student: Epoch: 99

TEST AUROC: 0.783915, TEST Accus: 0.334934, TEST Pre: 0.310635, TEST Recall: 0.279427
